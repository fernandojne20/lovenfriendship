(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(t,e,n){t.exports=n("zUnb")},"6Joi":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=(r=n("wj3C"))&&"object"==typeof r&&"default"in r?r.default:r,o=n("q/0M"),s=n("mrSG"),a=n("zVF4"),l=n("x7I3"),u=i.SDK_VERSION,c=new o.Logger("@firebase/firestore"),h=function(t){return t[t.DEBUG=0]="DEBUG",t[t.ERROR=1]="ERROR",t[t.SILENT=2]="SILENT",t}({});function d(){return c.logLevel===o.LogLevel.DEBUG?h.DEBUG:c.logLevel===o.LogLevel.SILENT?h.SILENT:h.ERROR}function f(t){switch(t){case h.DEBUG:c.logLevel=o.LogLevel.DEBUG;break;case h.ERROR:c.logLevel=o.LogLevel.ERROR;break;case h.SILENT:c.logLevel=o.LogLevel.SILENT;break;default:c.error("Firestore ("+u+"): Invalid value passed to `setLogLevel`")}}function p(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(c.logLevel<=o.LogLevel.DEBUG){var i=n.map(g);c.debug.apply(c,["Firestore ("+u+") ["+t+"]: "+e].concat(i))}}function m(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(c.logLevel<=o.LogLevel.ERROR){var r=e.map(g);c.error.apply(c,["Firestore ("+u+"): "+t].concat(r))}}function g(t){if("string"==typeof t)return t;var e=_.getPlatform();try{return e.formatJSON(t)}catch(n){return t}}function y(t){var e="FIRESTORE ("+u+") INTERNAL ASSERTION FAILED: "+t;throw m(e),new Error(e)}function v(t,e){t||y(e)}var _=function(){function t(){}return t.setPlatform=function(e){t.platform&&y("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||y("Platform not set"),t.platform},t}();function b(){return _.getPlatform().emptyByteString}var w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},E=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return s.__extends(e,t),e}(Error);function S(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new E(w.INVALID_ARGUMENT,t)}for(var r in n.prototype=t.prototype,t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function C(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function T(t,e){return void 0!==t?t:e}function I(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function x(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function A(t){for(var e in v(null!=t&&"object"==typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function k(t,e){if(0!==e.length)throw new E(w.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+W(e.length,"argument")+".")}function D(t,e,n){if(e.length!==n)throw new E(w.INVALID_ARGUMENT,"Function "+t+"() requires "+W(n,"argument")+", but was called with "+W(e.length,"argument")+".")}function N(t,e,n){if(e.length<n)throw new E(w.INVALID_ARGUMENT,"Function "+t+"() requires at least "+W(n,"argument")+", but was called with "+W(e.length,"argument")+".")}function R(t,e,n,r){if(e.length<n||e.length>r)throw new E(w.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+W(e.length,"argument")+".")}function O(t,e,n,r){B(t,e,H(n)+" argument",r)}function P(t,e,n,r){void 0!==r&&O(t,e,n,r)}function M(t,e,n,r){B(t,e,n+" option",r)}function L(t,e,n,r){void 0!==r&&M(t,e,n,r)}function F(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],s=0,a=i;s<a.length;s++){var l=a[s];if(l===r)return;o.push(q(l))}var u=q(r);throw new E(w.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function V(t,e,n,r){if(!e.some(function(t){return t===r}))throw new E(w.INVALID_ARGUMENT,"Invalid value "+q(r)+" provided to function "+t+"() for its "+H(n)+" argument. Acceptable values: "+e.join(", "))}function B(t,e,n,r){if(!("object"===e?U(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=q(r);throw new E(w.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function U(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function q(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":y("Unknown wrong type: "+typeof t)}function j(t,e,n){if(void 0===n)throw new E(w.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+H(e)+" argument, but it was undefined.")}function z(t,e,n){x(e,function(e,r){if(n.indexOf(e)<0)throw new E(w.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function Q(t,e,n,r){var i=q(r);return new E(w.INVALID_ARGUMENT,"Function "+t+"() requires its "+H(n)+" argument to be a "+e+", but it was: "+i)}function H(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function W(t,e){return t+" "+e+(1===t?"":"s")}var G=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return v(20===e.length,"Invalid auto ID: "+e),e},t}();function K(t,e){return t<e?-1:t>e?1:0}function $(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function Y(t){return t+"\0"}function Z(){if("undefined"==typeof Uint8Array)throw new E(w.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function X(){if(!_.getPlatform().base64Available)throw new E(w.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var J=function(){function t(t){X(),this._binaryString=t}return t.fromBase64String=function(e){D("Blob.fromBase64String",arguments,1),O("Blob.fromBase64String","string",1,e),X();try{var n=_.getPlatform().atob(e);return new t(n)}catch(r){throw new E(w.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+r)}},t.fromUint8Array=function(e){if(D("Blob.fromUint8Array",arguments,1),Z(),!(e instanceof Uint8Array))throw Q("Blob.fromUint8Array","Uint8Array",1,e);var n=Array.prototype.map.call(e,function(t){return String.fromCharCode(t)}).join("");return new t(n)},t.prototype.toBase64=function(){return D("Blob.toBase64",arguments,0),X(),_.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){D("Blob.toUint8Array",arguments,0),Z();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._binaryString===t._binaryString},t.prototype._compareTo=function(t){return K(this._binaryString,t._binaryString)},t}(),tt=S(J,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),et=function(){return function(t,e,n,r,i){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}}(),nt="(default)",rt=function(){function t(t,e){this.projectId=t,this.database=e||nt}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===nt},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return K(this.projectId,t.projectId)||K(this.database,t.database)},t}(),it=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.setPreviousValue(t)},this.writeNewSequenceNumber=function(t){return e.writeSequenceNumber(t)})}return t.prototype.setPreviousValue=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t},t.INVALID=-1,t}(),ot=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&y("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&y("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return v(this.length>=(t=void 0===t?1:t),"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return v(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return v(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return v(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),st=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(t.indexOf("//")>=0)throw new E(w.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter(function(t){return t.length>0}))},e.EMPTY_PATH=new e([]),e}(ot),at=/^[_a-zA-Z][_a-zA-Z0-9]*$/,lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return at.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new E(w.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new E(w.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var l=t[i+1];if("\\"!==l&&"."!==l&&"`"!==l)throw new E(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=l,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new E(w.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(ot),ut=function(){function t(e){this.path=e,v(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===st.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return st.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new st(e.slice()))},t.fromPathString=function(e){return new t(st.fromString(e))},t.EMPTY=new t(new st([])),t}(),ct=function(){return function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}}(),ht=function(t){return t.All="all",t.ListenStreamIdle="listen_stream_idle",t.ListenStreamConnectionBackoff="listen_stream_connection_backoff",t.WriteStreamIdle="write_stream_idle",t.WriteStreamConnectionBackoff="write_stream_connection_backoff",t.OnlineStateTimeout="online_state_timeout",t.ClientMetadataRefresh="client_metadata_refresh",t.LruGarbageCollection="lru_garbage_collection",t.RetryTransaction="retry_transaction",t}({}),dt=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new ct,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new E(w.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}(),ft=function(){function t(){this.tail=Promise.resolve(),this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.timerIdsToSkip=[]}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._isShuttingDown},enumerable:!0,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenAfterShutdown=function(t){this.verifyNotFailed(),this.enqueueInternal(t)},t.prototype.enqueueEvenAfterShutdown=function(t){return this.verifyNotFailed(),this.enqueueInternal(t)},t.prototype.enqueueAndInitiateShutdown=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return this.verifyNotFailed(),this._isShuttingDown?[3,2]:(this._isShuttingDown=!0,[4,this.enqueueEvenAfterShutdown(t)]);case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.enqueue=function(t){return this.verifyNotFailed(),this._isShuttingDown?new Promise(function(t){}):this.enqueueInternal(t)},t.prototype.enqueueInternal=function(t){var e=this,n=this.tail.then(function(){return e.operationInProgress=!0,t().catch(function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw m("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw t},0),t}).then(function(t){return e.operationInProgress=!1,t})});return this.tail=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.verifyNotFailed(),v(e>=0,"Attempted to schedule an operation with a negative delay of "+e),this.timerIdsToSkip.indexOf(t)>-1&&(e=0);var i=dt.createAndSchedule(this,t,e,n,function(t){return r.removeDelayedOperation(t)});return this.delayedOperations.push(i),i},t.prototype.verifyNotFailed=function(){this.failure&&y("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},t.prototype.verifyOperationInProgress=function(){v(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(){return this.enqueueEvenAfterShutdown(function(){return Promise.resolve()})},t.prototype.containsDelayedOperation=function(t){for(var e=0,n=this.delayedOperations;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.runDelayedOperationsEarly=function(t){var e=this;return this.drain().then(function(){v(t===ht.All||e.containsDelayedOperation(t),"Attempted to drain to missing operation "+t),e.delayedOperations.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),t!==ht.All&&i.timerId===t)break}return e.drain()})},t.prototype.skipDelaysForTimerId=function(t){this.timerIdsToSkip.push(t)},t.prototype.removeDelayedOperation=function(t){var e=this.delayedOperations.indexOf(t);v(e>=0,"Delayed operation not found."),this.delayedOperations.splice(e,1)},t}(),pt="\x01",mt="\x01",gt="\x10",yt="\x11";function vt(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=bt(e)),e=_t(t.get(n),e);return bt(e)}function _t(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=pt+gt;break;case pt:n+=pt+yt;break;default:n+=o}}return n}function bt(t){return t+pt+mt}function wt(t){var e=t.length;if(v(e>=2,"Invalid path "+t),2===e)return v(t.charAt(0)===pt&&t.charAt(1)===mt,"Non-empty path "+t+" had length 2"),st.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf(pt,o);switch((s<0||s>n)&&y('Invalid encoded resource path: "'+t+'"'),t.charAt(s+1)){case mt:var a=t.substring(o,s),l=void 0;0===i.length?l=a:(l=i+=a,i=""),r.push(l);break;case gt:i+=t.substring(o,s),i+="\0";break;case yt:i+=t.substring(o,s+1);break;default:y('Invalid encoded resource path: "'+t+'"')}o=s+2}return new st(r)}var Et=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new E(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new E(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new E(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new E(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?K(this.nanoseconds,t.nanoseconds):K(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t}(),St=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6);return new t(new Et(n,e%1e6*1e3))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new Et(0,0)),t}(),Ct=function(){function t(t,e){this.comparator=t,this.root=e||It.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,It.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,It.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Tt(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Tt(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Tt(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Tt(this.root,t,this.comparator,!0)},t}(),Tt=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){v(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),It=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw y("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw y("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw y("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),xt=function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw y("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw y("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw y("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw y("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw y("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new It(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();It.EMPTY=new xt;var At=function(){function t(t){this.comparator=t,this.data=new Ct(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach(function(t){n=n.add(t)}),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new kt(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new kt(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),kt=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Dt=new Ct(ut.comparator);function Nt(){return Dt}function Rt(){return Nt()}var Ot=new Ct(ut.comparator);function Pt(){return Ot}var Mt=new Ct(ut.comparator);function Lt(){return Mt}var Ft=new At(ut.comparator);function Vt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ft,r=0,i=t;r<i.length;r++)n=n.add(i[r]);return n}var Bt=new At(K);function Ut(){return Bt}var qt=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r,v(r.length>0,"Cannot create an empty mutation batch")}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&v(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;v(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=o.applyToRemoteDocument(e,r[i]))}return e},t.prototype.applyToLocalView=function(t,e){e&&v(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=0,r=this.baseMutations;n<r.length;n++)(a=r[n]).key.isEqual(t)&&(e=a.applyToLocalView(e,e,this.localWriteTime));for(var i=e,o=0,s=this.mutations;o<s.length;o++){var a;(a=s[o]).key.isEqual(t)&&(e=a.applyToLocalView(e,i,this.localWriteTime))}return e},t.prototype.applyToLocalDocumentSet=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.applyToLocalView(r.key,t.get(r.key));i&&(n=n.insert(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Vt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&$(this.mutations,t.mutations)&&$(this.baseMutations,t.baseMutations)},t}(),jt=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){v(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=Lt(),s=e.mutations,a=0;a<s.length;a++)o=o.insert(s[a].key,r[a].version);return new t(e,n,r,i,o)},t}(),zt=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&y("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(r){return t.reject(r)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),Qt=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}return t.forUser=function(e,n,r,i){return v(""!==e.uid,"UserID must not be an empty string."),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Kt(t).iterate({index:ln.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.acknowledgeBatch=function(t,e,n){return this.getMutationQueueMetadata(t).next(function(e){return e.lastStreamToken=Gt(n),Yt(t).put(e)})},t.prototype.getLastStreamToken=function(t){return this.getMutationQueueMetadata(t).next(function(t){return t.lastStreamToken})},t.prototype.setLastStreamToken=function(t,e){return this.getMutationQueueMetadata(t).next(function(n){return n.lastStreamToken=Gt(e),Yt(t).put(n)})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=$t(t),s=Kt(t);return s.add({}).next(function(a){v("number"==typeof a,"Auto-generated key is not a number");var l=new qt(a,e,n,r),u=i.serializer.toDbMutationBatch(i.userId,l);i.documentKeysByBatchId[a]=l.keys();for(var c=[],h=0,d=r;h<d.length;h++){var f=d[h],p=un.key(i.userId,f.key.path,a);c.push(s.put(u)),c.push(o.put(p,un.PLACEHOLDER)),c.push(i.indexManager.addToCollectionParentIndex(t,f.key.path.popLast()))}return zt.waitFor(c).next(function(){return l})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Kt(t).get(e).next(function(t){return t?(v(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.fromDbMutationBatch(t)):null})},t.prototype.lookupMutationKeys=function(t,e){var n=this;return this.documentKeysByBatchId[e]?zt.resolve(this.documentKeysByBatchId[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.documentKeysByBatchId[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Kt(t).iterate({index:ln.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(v(e.batchId>=r,"Should have found mutation after "+r),o=n.serializer.fromDbMutationBatch(e)),i.done()}).next(function(){return o})},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Kt(t).iterate({index:ln.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Kt(t).loadAll(ln.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=un.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return $t(t).iterate({range:i},function(r,i,s){var a=r[0],l=r[2],u=wt(r[1]);if(a===n.userId&&e.path.isEqual(u))return Kt(t).get(l).next(function(t){if(!t)throw y("Dangling document-mutation reference found: "+r+" which points to "+l);v(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+l),o.push(n.serializer.fromDbMutationBatch(t))});s.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new At(K),i=[];return e.forEach(function(e){var o=un.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=$t(t).iterate({range:s},function(t,i,o){var s=t[0],a=t[2],l=wt(t[1]);s===n.userId&&e.path.isEqual(l)?r=r.add(a):o.done()});i.push(a)}),zt.waitFor(i).next(function(){return n.lookupMutationBatches(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;v(!e.isDocumentQuery(),"Document queries shouldn't go down this path"),v(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=e.path,i=r.length+1,o=un.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new At(K);return $t(t).iterate({range:s},function(t,e,o){var s=t[0],l=t[2],u=wt(t[1]);s===n.userId&&r.isPrefixOf(u)?u.length===i&&(a=a.add(l)):o.done()}).next(function(){return n.lookupMutationBatches(t,a)})},t.prototype.lookupMutationBatches=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Kt(t).get(e).next(function(t){if(null===t)throw y("Dangling document-mutation reference found, which points to "+e);v(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.fromDbMutationBatch(t))}))}),zt.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return Wt(t.simpleDbTransaction,this.userId,e).next(function(r){return n.removeCachedMutationKeys(e.batchId),zt.forEach(r,function(e){return n.referenceDelegate.removeMutationReference(t,e)})})},t.prototype.removeCachedMutationKeys=function(t){delete this.documentKeysByBatchId[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return zt.resolve();var r=IDBKeyRange.lowerBound(un.prefixForUser(e.userId)),i=[];return $t(t).iterate({range:r},function(t,n,r){if(t[0]===e.userId){var o=wt(t[1]);i.push(o)}else r.done()}).next(function(){v(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(t){return t.canonicalString()}))})})},t.prototype.containsKey=function(t,e){return Ht(t,this.userId,e)},t.prototype.getMutationQueueMetadata=function(t){var e=this;return Yt(t).get(this.userId).next(function(t){return t||new an(e.userId,-1,"")})},t}();function Ht(t,e,n){var r=un.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return $t(t).iterate({range:o,keysOnly:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function Wt(t,e,n){var r=t.store(ln.store),i=t.store(un.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,l=r.iterate({range:s},function(t,e,n){return a++,n.delete()});o.push(l.next(function(){v(1===a,"Dangling document-mutation reference found: Missing batch "+n.batchId)}));for(var u=[],c=0,h=n.mutations;c<h.length;c++){var d=h[c],f=un.key(e,d.key.path,n.batchId);o.push(i.delete(f)),u.push(d.key)}return zt.waitFor(o).next(function(){return u})}function Gt(t){return t instanceof Uint8Array?(v("YES"===process.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence."),t.toString()):t}function Kt(t){return Vn.getStore(t,ln.store)}function $t(t){return Vn.getStore(t,un.store)}function Yt(t){return Vn.getStore(t,an.store)}var Zt=1,Xt=function(t){return t[t.QueryCache=0]="QueryCache",t[t.SyncEngine=1]="SyncEngine",t}({}),Jt=function(){function t(t,e){this.generatorId=t,v((t&Zt)===t,"Generator ID "+t+" contains more than "+Zt+" reserved bits"),this.seek(void 0!==e?e:this.generatorId)}return t.prototype.next=function(){var t=this.nextId;return this.nextId+=1<<Zt,t},t.prototype.after=function(t){return this.seek(t+(1<<Zt)),this.next()},t.prototype.seek=function(t){v((t&Zt)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=t},t.forQueryCache=function(){return new t(Xt.QueryCache,2)},t.forSyncEngine=function(){return new t(Xt.SyncEngine)},t}(),te="SimpleDb",ee=function(){function t(e){this.db=e,12.2===t.getIOSVersion(a.getUA())&&m("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.openOrCreate=function(e,n,r){return v(t.isAvailable(),"IndexedDB not supported in current environment."),p(te,"Opening database:",e),new zt(function(i,o){var s=window.indexedDB.open(e,n);s.onsuccess=function(e){i(new t(e.target.result))},s.onblocked=function(){o(new E(w.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=function(t){var e=t.target.error;o("VersionError"===e.name?new E(w.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):e)},s.onupgradeneeded=function(t){p(te,'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result,i=new re(s.transaction);r.createOrUpgrade(n,i,t.oldVersion,nn).next(function(){p(te,"Database upgrade to version "+nn+" complete")})}}).toPromise()},t.delete=function(t){return p(te,"Removing database:",t),oe(window.indexedDB.deleteDatabase(t)).toPromise()},t.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(void 0===window.navigator)return"YES"===process.env.USE_MOCK_PERSISTENCE;var e=a.getUA(),n=t.getIOSVersion(e),r=0<n&&n<10,i=t.getAndroidVersion(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.getStore=function(t,e){return t.store(e)},t.getIOSVersion=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.getAndroidVersion=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.setVersionChangeListener=function(t){this.db.onversionchange=function(e){return t(e)}},t.prototype.runTransaction=function(t,e,n){var r=re.open(this.db,t,e),i=n(r).catch(function(t){return r.abort(t),zt.reject(t)}).toPromise();return i.catch(function(){}),r.completionPromise.then(function(){return i})},t.prototype.close=function(){this.db.close()},t}(),ne=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return oe(this.dbCursor.delete())},t}(),re=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.completionDeferred=new ct,this.transaction.oncomplete=function(){e.completionDeferred.resolve()},this.transaction.onabort=function(){t.error?e.completionDeferred.reject(t.error):e.completionDeferred.resolve()},this.transaction.onerror=function(t){var n=ae(t.target.error);e.completionDeferred.reject(n)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.completionDeferred.reject(t),this.aborted||(p(te,"Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return v(!!e,"Object store not part of transaction: "+t),new ie(e)},t}(),ie=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(p(te,"PUT",this.store.name,t,e),n=this.store.put(e,t)):(p(te,"PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),oe(n)},t.prototype.add=function(t){return p(te,"ADD",this.store.name,t,t),oe(this.store.add(t))},t.prototype.get=function(t){var e=this;return oe(this.store.get(t)).next(function(n){return void 0===n&&(n=null),p(te,"GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return p(te,"DELETE",this.store.name,t),oe(this.store.delete(t))},t.prototype.count=function(){return p(te,"COUNT",this.store.name),oe(this.store.count())},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.deleteAll=function(t,e){p(te,"DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(t,e,n){return n.delete()})},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateSerial=function(t){var e=this.cursor({});return new zt(function(n,r){e.onerror=function(t){var e=ae(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.iterateCursor=function(t,e){var n=[];return new zt(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ne(i),s=e(i.primaryKey,i.value,o);if(s instanceof zt){var a=s.catch(function(t){return o.done(),zt.reject(t)});n.push(a)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}}).next(function(){return zt.waitFor(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(v(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function oe(t){return new zt(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=ae(t.target.error);n(e)}})}var se=!1;function ae(t){var e=ee.getIOSVersion(a.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new E("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return se||(se=!0,setTimeout(function(){throw r},0)),r}}return t}var le=function(){function t(t,e){this.referenceDelegate=t,this.serializer=e,this.targetIdGenerator=Jt.forQueryCache()}return t.prototype.allocateTargetId=function(t){var e=this;return this.retrieveMetadata(t).next(function(n){return n.highestTargetId=e.targetIdGenerator.after(n.highestTargetId),e.saveMetadata(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.retrieveMetadata(t).next(function(t){return St.fromTimestamp(new Et(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return he(t.simpleDbTransaction)},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.retrieveMetadata(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.saveMetadata(t,i)})},t.prototype.addQueryData=function(t,e){var n=this;return this.saveQueryData(t,e).next(function(){return n.retrieveMetadata(t).next(function(r){return r.targetCount+=1,n.updateMetadataFromQueryData(e,r),n.saveMetadata(t,r)})})},t.prototype.updateQueryData=function(t,e){return this.saveQueryData(t,e)},t.prototype.removeQueryData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return ue(t).delete(e.targetId)}).next(function(){return n.retrieveMetadata(t)}).next(function(e){return v(e.targetCount>0,"Removing from an empty query cache"),e.targetCount-=1,n.saveMetadata(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return ue(t).iterate(function(s,a){var l=r.serializer.fromDbTarget(a);l.sequenceNumber<=e&&void 0===n[l.targetId]&&(i++,o.push(r.removeQueryData(t,l)))}).next(function(){return zt.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){var n=this;return ue(t).iterate(function(t,r){var i=n.serializer.fromDbTarget(r);e(i)})},t.prototype.retrieveMetadata=function(t){return ce(t.simpleDbTransaction)},t.prototype.saveMetadata=function(t,e){return(n=t,Vn.getStore(n,gn.store)).put(gn.key,e);var n},t.prototype.saveQueryData=function(t,e){return ue(t).put(this.serializer.toDbTarget(e))},t.prototype.updateMetadataFromQueryData=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getQueryCount=function(t){return this.retrieveMetadata(t).next(function(t){return t.targetCount})},t.prototype.getQueryData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return ue(t).iterate({range:i,index:pn.queryTargetsIndexName},function(t,r,i){var s=n.serializer.fromDbTarget(r);e.isEqual(s.query)&&(o=s,i.done())}).next(function(){return o})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=de(t);return e.forEach(function(e){var s=vt(e.path);i.push(o.put(new mn(n,s))),i.push(r.referenceDelegate.addReference(t,e))}),zt.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=de(t);return zt.forEach(e,function(e){var o=vt(e.path);return zt.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=de(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=de(t),i=Vt();return r.iterate({range:n,keysOnly:!0},function(t,e,n){var r=wt(t[1]),o=new ut(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=vt(e.path),r=IDBKeyRange.bound([n],[Y(n)],!1,!0),i=0;return de(t).iterate({index:mn.documentTargetsIndex,keysOnly:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.getQueryDataForTarget=function(t,e){var n=this;return ue(t).get(e).next(function(t){return t?n.serializer.fromDbTarget(t):null})},t}();function ue(t){return Vn.getStore(t,pn.store)}function ce(t){return ee.getStore(t,gn.store).get(gn.key).next(function(t){return v(null!==t,"Missing metadata row."),t})}function he(t){return ce(t).next(function(t){return t.highestListenSequenceNumber})}function de(t){return Vn.getStore(t,mn.store)}var fe=function(){function t(t){this.fields=t}return t.fromSet=function(e){return new t(e)},t.fromArray=function(e){var n=new At(lt.comparator);return e.forEach(function(t){return n=n.add(t)}),new t(n)},t.prototype.covers=function(t){var e=!1;return this.fields.forEach(function(n){n.isPrefixOf(t)&&(e=!0)}),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),pe=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),me=function(){return function(t,e){this.version=t,this.transformResults=e}}(),ge=function(t){return t[t.Set=0]="Set",t[t.Patch=1]="Patch",t[t.Transform=2]="Transform",t[t.Delete=3]="Delete",t}({}),ye=function(){function t(t,e){this.updateTime=t,this.exists=e,v(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof je&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof je:(v(this.isNone,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return n=t.updateTime,(null!=(e=this.updateTime)?!(!n||!e.isEqual(n)):e===n)&&this.exists===t.exists;var e,n},t.NONE=new t,t}(),ve=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&v(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof je?t.version:St.MIN},t}(),_e=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=ge.Set,i}return s.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),v(null==e.transformResults,"Transform results received by SetMutation."),new je(this.key,e.version,{hasCommittedMutations:!0},this.value)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=ve.getPostMutationVersion(t);return new je(this.key,r,{hasLocalMutations:!0},this.value)},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},e}(ve),be=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=ge.Patch,o}return s.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),v(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return new Qe(this.key,e.version);var n=this.patchDocument(t);return new je(this.key,e.version,{hasCommittedMutations:!0},n)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=ve.getPostMutationVersion(t),i=this.patchDocument(t);return new je(this.key,r,{hasLocalMutations:!0},i)},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof je?t.data():Be.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){var e=this;return this.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t=null!==r?t.set(n,r):t.delete(n)}}),t},e}(ve),we=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=ge.Transform,r.precondition=ye.exists(!0),r}return s.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),v(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(t))return new Qe(this.key,e.version);var n=this.requireDocument(t),r=this.serverTransformResults(t,e.transformResults),i=e.version,o=this.transformObject(n.data(),r);return new je(this.key,i,{hasCommittedMutations:!0},o)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,t,e),o=this.transformObject(r.data(),i);return new je(this.key,r.version,{hasLocalMutations:!0},o)},e.prototype.extractBaseValue=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof je?t.field(i.field):void 0,s=i.transform.computeBaseValue(o||null);null!=s&&(e=null==e?Be.EMPTY.set(i.field,s):e.set(i.field,s))}return e},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&$(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},e.prototype.requireDocument=function(t){v(t instanceof je,"Unknown MaybeDocument type "+t);var e=t;return v(e.key.isEqual(this.key),"Can only transform a document with the same key"),e},e.prototype.serverTransformResults=function(t,e){var n=[];v(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof je&&(s=t.field(i.field)),n.push(o.applyToRemoteDocument(s,e[r]))}return n},e.prototype.localTransformResults=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],a=s.transform,l=null;e instanceof je&&(l=e.field(s.field)),null===l&&n instanceof je&&(l=n.field(s.field)),r.push(a.applyToLocalView(l,t))}return r},e.prototype.transformObject=function(t,e){v(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++)t=t.set(this.fieldTransforms[n].field,e[n]);return t},e}(ve),Ee=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=ge.Delete,r}return s.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),v(null==e.transformResults,"Transform results received by DeleteMutation."),new ze(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&v(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new ze(this.key,St.forDeletedDoc())):t},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},e}(ve),Se=function(t){return t[t.NullValue=0]="NullValue",t[t.BooleanValue=1]="BooleanValue",t[t.NumberValue=2]="NumberValue",t[t.TimestampValue=3]="TimestampValue",t[t.StringValue=4]="StringValue",t[t.BlobValue=5]="BlobValue",t[t.RefValue=6]="RefValue",t[t.GeoPointValue=7]="GeoPointValue",t[t.ArrayValue=8]="ArrayValue",t[t.ObjectValue=9]="ObjectValue",t}({}),Ce=function(t){return t[t.Default=0]="Default",t[t.Estimate=1]="Estimate",t[t.Previous=2]="Previous",t}({}),Te=function(){function t(t,e){this.serverTimestampBehavior=t,this.timestampsInSnapshots=e}return t.fromSnapshotOptions=function(e,n){switch(e.serverTimestamps){case"estimate":return new t(Ce.Estimate,n);case"previous":return new t(Ce.Previous,n);case"none":case void 0:return new t(Ce.Default,n);default:return y("fromSnapshotOptions() called with invalid options.")}},t}(),Ie=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.defaultCompareTo=function(t){return v(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type."),K(this.typeOrder,t.typeOrder)},t}(),xe=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=Se.NullValue,e.internalValue=null,e}return s.__extends(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(Ie),Ae=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.BooleanValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?K(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(Ie),ke=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.NumberValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?(n=this.internalValue)<(r=t.internalValue)?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1:this.defaultCompareTo(t);var n,r},e}(Ie);function De(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}var Ne=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&De(this.internalValue,t.internalValue)},e}(ke),Re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&De(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(ke),Oe=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.StringValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?K(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(Ie),Pe=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.TimestampValue,n}return s.__extends(e,t),e.prototype.value=function(t){return!t||t.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):t instanceof Me?-1:this.defaultCompareTo(t)},e}(Ie),Me=function(t){function e(e,n){var r=t.call(this)||this;return r.localWriteTime=e,r.previousValue=n,r.typeOrder=Se.TimestampValue,r}return s.__extends(e,t),e.prototype.value=function(t){return t&&t.serverTimestampBehavior===Ce.Estimate?new Pe(this.localWriteTime).value(t):t&&t.serverTimestampBehavior===Ce.Previous&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.localWriteTime.isEqual(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime._compareTo(t.localWriteTime):t instanceof Pe?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},e}(Ie),Le=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.BlobValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Ie),Fe=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=Se.RefValue,r}return s.__extends(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId)},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:ut.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(Ie),Ve=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.GeoPointValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Ie),Be=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.ObjectValue,n}return s.__extends(e,t),e.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal(function(n,r){e[n]=r.value(t)}),e},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.isEqual=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),s=K(i.key,o.key)||i.value.compareTo(o.value);if(s)return s}return K(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(v(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(v(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return null!==this.field(t)},e.prototype.field=function(t){v(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach(function(t){n=n instanceof e?n.internalValue.get(t):null}),n},e.prototype.fieldMask=function(){var t=new At(lt.comparator);return this.internalValue.forEach(function(n,r){var i=new lt([n]);if(r instanceof e){var o=r.fieldMask().fields;o.isEmpty()?t=t.add(i):o.forEach(function(e){t=t.add(i.child(e))})}else t=t.add(i)}),fe.fromSet(t)},e.prototype.toString=function(){return this.internalValue.toString()},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new Ct(K)),e}(Ie),Ue=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.ArrayValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue.map(function(e){return e.value(t)})},e.prototype.contains=function(t){for(var e=0,n=this.internalValue;e<n.length;e++)if(n[e].isEqual(t))return!0;return!1},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return K(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){return"["+this.internalValue.map(function(t){return t.toString()}).join(",")+"]"},e}(Ie),qe=function(){function t(t,e){this.key=t,this.version=e}return t.compareByKey=function(t,e){return ut.comparator(t.key,e.key)},t}(),je=function(t){function e(e,n,r,i,o,s){var a=t.call(this,e,n)||this;return a.objectValue=i,a.proto=o,a.converter=s,v(void 0!==a.objectValue||void 0!==a.proto&&void 0!==a.converter,"If objectValue is not defined, proto and converter need to be set."),a.hasLocalMutations=!!r.hasLocalMutations,a.hasCommittedMutations=!!r.hasCommittedMutations,a}return s.__extends(e,t),e.prototype.field=function(t){if(this.objectValue)return this.objectValue.field(t);this.fieldValueCache||(this.fieldValueCache=new Map);var e=t.canonicalString(),n=this.fieldValueCache.get(e);if(void 0===n){var r=this.getProtoField(t);n=void 0===r?null:this.converter(r),this.fieldValueCache.set(e,n)}return n},e.prototype.data=function(){var t=this;if(!this.objectValue){var e=Be.EMPTY;x(this.proto.fields,function(n,r){e=e.set(new lt([n]),t.converter(r))}),this.objectValue=e,this.fieldValueCache=void 0}return this.objectValue},e.prototype.value=function(){return this.data().value()},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations&&this.data().isEqual(t.data())},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.getProtoField=function(t){v(void 0!==this.proto,"Can only call getProtoField() when proto is defined");for(var e=this.proto.fields[t.firstSegment()],n=1;n<t.length;++n){if(!e||!e.mapValue)return;e=e.mapValue.fields[t.get(n)]}return e},e.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?r.compareTo(i):y("Trying to compare documents on fields that don't exist")},e}(qe),ze=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return s.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(qe),Qe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(qe),He=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(o[0].isEqual(t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){x(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.isEmpty=function(){return A(this.inner)},t}(),We=function(){function t(){this.changes=new He(function(t){return t.toString()}),this.changesApplied=!1}return t.prototype.addEntry=function(t){this.assertNotApplied(),this.changes.set(t.key,t)},t.prototype.removeEntry=function(t){this.assertNotApplied(),this.changes.set(t,null)},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?zt.resolve(n):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){v(!this.changesApplied,"Changes have already been applied.")},t}(),Ge="The remote document changelog no longer contains all changes for all local query views. It may be necessary to rebuild these views.",Ke=function(){function t(t,e,n){this.serializer=t,this.indexManager=e,this.keepDocumentChangeLog=n,this._lastProcessedDocumentChangeId=0}return Object.defineProperty(t.prototype,"lastProcessedDocumentChangeId",{get:function(){return this._lastProcessedDocumentChangeId},enumerable:!0,configurable:!0}),t.prototype.start=function(t){var e=ee.getStore(t,_n.store);return this.synchronizeLastDocumentChangeId(e)},t.prototype.addEntry=function(t,e,n){var r=this;return Ye(t).put(Xe(e),n).next(function(){r.indexManager.addToCollectionParentIndex(t,e.path.popLast())})},t.prototype.removeEntry=function(t,e){var n=Ye(t),r=Xe(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e,n){var r=this;return this.getMetadata(t).next(function(i){return i.byteSize+=n,r.setMetadata(t,i).next(function(){if(r.keepDocumentChangeLog)return Ze(t).put({changes:r.serializer.toDbResourcePaths(e)})})})},t.prototype.getEntry=function(t,e){var n=this;return Ye(t).get(Xe(e)).next(function(t){return t?n.serializer.fromDbRemoteDocument(t):null})},t.prototype.getSizedEntry=function(t,e){var n=this;return Ye(t).get(Xe(e)).next(function(t){return t?{maybeDocument:n.serializer.fromDbRemoteDocument(t),size:Je(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Rt();return this.forEachDbEntry(t,e,function(t,e){r=r.insert(t,e?n.serializer.fromDbRemoteDocument(e):null)}).next(function(){return r})},t.prototype.getSizedEntries=function(t,e){var n=this,r=Rt(),i=new Ct(ut.comparator);return this.forEachDbEntry(t,e,function(t,e){e?(r=r.insert(t,n.serializer.fromDbRemoteDocument(e)),i=i.insert(t,Je(e))):(r=r.insert(t,null),i=i.insert(t,0))}).next(function(){return{maybeDocuments:r,sizeMap:i}})},t.prototype.forEachDbEntry=function(t,e,n){if(e.isEmpty())return zt.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Ye(t).iterate({range:r},function(t,e,r){for(var s=ut.fromSegments(t);o&&ut.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e){var n=this;v(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=Pt(),i=e.path.length+1,o=e.path.toArray(),s=IDBKeyRange.lowerBound(o);return Ye(t).iterate({range:s},function(t,o,s){if(t.length===i){var a=n.serializer.fromDbRemoteDocument(o);e.path.isPrefixOf(a.key.path)?a instanceof je&&e.matches(a)&&(r=r.insert(a.key,a)):s.done()}}).next(function(){return r})},t.prototype.getNewDocumentChanges=function(t){var e=this;v(this.keepDocumentChangeLog,"Can only call getNewDocumentChanges() when document change log is enabled");var n=Vt(),r=Nt(),i=IDBKeyRange.lowerBound(this._lastProcessedDocumentChangeId+1),o=!0,s=Ze(t);return s.iterate({range:i},function(t,r){if(o&&(o=!1,e._lastProcessedDocumentChangeId+1!==r.id))return e.synchronizeLastDocumentChangeId(s).next(function(){return zt.reject(new E(w.DATA_LOSS,Ge))});n=n.unionWith(e.serializer.fromDbResourcePaths(r.changes)),e._lastProcessedDocumentChangeId=r.id}).next(function(){var i=[];return n.forEach(function(n){i.push(e.getEntry(t,n).next(function(t){var e=t||new ze(n,St.forDeletedDoc());r=r.insert(n,e)}))}),zt.waitFor(i)}).next(function(){return r})},t.prototype.removeDocumentChangesThroughChangeId=function(t,e){var n=IDBKeyRange.upperBound(e);return Ze(t).delete(n)},t.prototype.synchronizeLastDocumentChangeId=function(t){var e=this;return this._lastProcessedDocumentChangeId=0,t.iterate({keysOnly:!0,reverse:!0},function(t,n,r){e._lastProcessedDocumentChangeId=t,r.done()})},t.prototype.newChangeBuffer=function(){return new t.RemoteDocumentChangeBuffer(this)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return $e(t).get(fn.key).next(function(t){return v(!!t,"Missing document cache metadata"),t})},t.prototype.setMetadata=function(t,e){return $e(t).put(fn.key,e)},t.RemoteDocumentChangeBuffer=function(t){function e(e){var n=t.call(this)||this;return n.documentCache=e,n.documentSizes=new He(function(t){return t.toString()}),n}return s.__extends(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=Vt();return this.changes.forEach(function(o,s){var a=e.documentSizes.get(o);if(v(void 0!==a,"Cannot modify a document that wasn't read (for "+o+")"),s){var l=e.documentCache.serializer.toDbRemoteDocument(s),u=Je(l);r+=u-a,n.push(e.documentCache.addEntry(t,o,l))}else r-=a,n.push(e.documentCache.removeEntry(t,o));i=i.add(o)}),n.push(this.documentCache.updateMetadata(t,i,r)),zt.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.documentCache.getSizedEntry(t,e).next(function(t){return null===t?(n.documentSizes.set(e,0),null):(n.documentSizes.set(e,t.size),t.maybeDocument)})},e.prototype.getAllFromCache=function(t,e){var n=this;return this.documentCache.getSizedEntries(t,e).next(function(t){var e=t.maybeDocuments;return t.sizeMap.forEach(function(t,e){n.documentSizes.set(t,e)}),e})},e}(We),t}();function $e(t){return Vn.getStore(t,fn.store)}function Ye(t){return Vn.getStore(t,dn.store)}function Ze(t){return Vn.getStore(t,_n.store)}function Xe(t){return t.path.toArray()}function Je(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw y("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}var tn=function(){function t(){this.collectionParentIndex=new en}return t.prototype.addToCollectionParentIndex=function(t,e){return this.collectionParentIndex.add(e),zt.resolve()},t.prototype.getCollectionParents=function(t,e){return zt.resolve(this.collectionParentIndex.getEntries(e))},t}(),en=function(){function t(){this.index={}}return t.prototype.add=function(t){v(t.length%2==1,"Expected a collection path.");var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new At(st.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.getEntries=function(t){return(this.index[t]||new At(st.comparator)).toArray()},t}(),nn=8,rn=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;v(n<r&&n>=0&&r<=nn,"Unexpected schema upgrade from v"+n+" to v{toVersion}."),n<1&&r>=1&&(function(t){t.createObjectStore(sn.store)}(t),function(t){t.createObjectStore(an.store,{keyPath:an.keyPath}),t.createObjectStore(ln.store,{keyPath:ln.keyPath,autoIncrement:!0}).createIndex(ln.userMutationsIndex,ln.userMutationsKeyPath,{unique:!0}),t.createObjectStore(un.store)}(t),vn(t),function(t){t.createObjectStore(dn.store)}(t));var o=zt.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(mn.store),t.deleteObjectStore(pn.store),t.deleteObjectStore(gn.store)}(t),vn(t)),o=o.next(function(){return function(t){var e=t.store(gn.store),n=new gn(0,0,St.MIN.toTimestamp(),0);return e.put(gn.key,n)}(e)})),n<4&&r>=4&&(0!==n&&(o=o.next(function(){return function(t,e){return e.store(ln.store).loadAll().next(function(n){t.deleteObjectStore(ln.store),t.createObjectStore(ln.store,{keyPath:ln.keyPath,autoIncrement:!0}).createIndex(ln.userMutationsIndex,ln.userMutationsKeyPath,{unique:!0});var r=e.store(ln.store),i=n.map(function(t){return r.put(t)});return zt.waitFor(i)})}(t,e)})),o=o.next(function(){!function(t){t.createObjectStore(bn.store,{keyPath:bn.keyPath})}(t),function(t){t.createObjectStore(_n.store,{keyPath:"id",autoIncrement:!0})}(t)})),n<5&&r>=5&&(o=o.next(function(){return i.removeAcknowledgedMutations(e)})),n<6&&r>=6&&(o=o.next(function(){return function(t){t.createObjectStore(fn.store)}(t),i.addDocumentGlobal(e)})),n<7&&r>=7&&(o=o.next(function(){return i.ensureSequenceNumbers(e)})),n<8&&r>=8&&(o=o.next(function(){return i.createCollectionParentIndex(t,e)})),o},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(dn.store).iterate(function(t,n){e+=Je(n)}).next(function(){var n=new fn(e);return t.store(fn.store).put(fn.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(an.store),r=t.store(ln.store);return n.loadAll().next(function(n){return zt.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(ln.userMutationsIndex,i).next(function(r){return zt.forEach(r,function(r){v(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=e.serializer.fromDbMutationBatch(r);return Wt(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(mn.store),n=t.store(dn.store);return he(t).next(function(t){var r=[];return n.iterate(function(n,i){var o=new st(n),s=function(t){return[0,vt(t)]}(o);r.push(e.get(s).next(function(n){return n?zt.resolve():function(n){return e.put(new mn(0,vt(n),t))}(o)}))}).next(function(){return zt.waitFor(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(yn.store,{keyPath:yn.keyPath});var n=e.store(yn.store),r=new en,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:vt(i)})}};return e.store(dn.store).iterate({keysOnly:!0},function(t,e){var n=new st(t);return i(n.popLast())}).next(function(){return e.store(un.store).iterate({keysOnly:!0},function(t,e){var n=wt(t[1]);return i(n.popLast())})})},t}(),on=function(){return function(t,e){this.seconds=t,this.nanoseconds=e}}(),sn=function(){function t(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}return t.store="owner",t.key="owner",t}(),an=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),ln=function(){function t(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}return t.store="mutations",t.keyPath="batchId",t.userMutationsIndex="userMutationsIndex",t.userMutationsKeyPath=["userId","batchId"],t}(),un=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,vt(e)]},t.key=function(t,e,n){return[t,vt(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}(),cn=function(){return function(t,e){this.path=t,this.readTime=e}}(),hn=function(){return function(t,e){this.path=t,this.version=e}}(),dn=function(){function t(t,e,n,r){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r}return t.store="remoteDocuments",t}(),fn=function(){function t(t){this.byteSize=t}return t.store="remoteDocumentGlobal",t.key="remoteDocumentGlobalKey",t}(),pn=function(){function t(t,e,n,r,i,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.query=o}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),mn=function(){function t(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n,v(0===t==(void 0!==n),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),gn=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),yn=function(){function t(t,e){this.collectionId=t,this.parent=e}return t.store="collectionParents",t.keyPath=["collectionId","parent"],t}();function vn(t){t.createObjectStore(mn.store,{keyPath:mn.keyPath}).createIndex(mn.documentTargetsIndex,mn.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(pn.store,{keyPath:pn.keyPath}).createIndex(pn.queryTargetsIndexName,pn.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(gn.store)}var _n=function(){function t(t){this.changes=t}return t.store="remoteDocumentChanges",t.keyPath="id",t}(),bn=function(){function t(t,e,n,r,i){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r,this.lastProcessedDocumentChangeId=i}return t.store="clientMetadata",t.keyPath="clientId",t}(),wn=[an.store,ln.store,un.store,dn.store,pn.store,sn.store,gn.store,mn.store].concat([bn.store,_n.store]).concat([fn.store]).concat([yn.store]),En=function(){function t(){this.collectionParentsCache=new en}return t.prototype.addToCollectionParentIndex=function(t,e){if(v(e.length%2==1,"Expected a collection path."),this.collectionParentsCache.add(e)){v(e.length>=1,"Invalid collection path.");var n=e.lastSegment(),r=e.popLast();return Sn(t).put({collectionId:n,parent:vt(r)})}return zt.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Y(e),""],!1,!0);return Sn(t).loadAll(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(wt(o.parent))}return n})},t}();function Sn(t){return Vn.getStore(t,yn.store)}var Cn=function(t){return t[t.Listen=0]="Listen",t[t.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",t[t.LimboResolution=2]="LimboResolution",t}({}),Tn=function(){function t(t,e,n,r,i,o){void 0===i&&(i=St.MIN),void 0===o&&(o=b()),this.query=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.resumeToken=o}return t.prototype.copy=function(e){return new t(this.query,this.targetId,this.purpose,void 0===e.sequenceNumber?this.sequenceNumber:e.sequenceNumber,void 0===e.snapshotVersion?this.snapshotVersion:e.snapshotVersion,void 0===e.resumeToken?this.resumeToken:e.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.sequenceNumber===t.sequenceNumber&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.resumeToken===t.resumeToken&&this.query.isEqual(t.query)},t}(),In=function(){function t(t){this.remoteSerializer=t}return t.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=ut.fromSegments(t.noDocument.path),n=this.fromDbTimestamp(t.noDocument.readTime);return new ze(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}return t.unknownDocument?(e=ut.fromSegments(t.unknownDocument.path),n=this.fromDbTimestamp(t.unknownDocument.version),new Qe(e,n)):y("Unexpected DbRemoteDocument")},t.prototype.toDbRemoteDocument=function(t){if(t instanceof je){var e=t.proto?t.proto:this.remoteSerializer.toDocument(t);return new dn(null,null,e,i=t.hasCommittedMutations)}if(t instanceof ze){var n=t.key.path.toArray(),r=this.toDbTimestamp(t.version),i=t.hasCommittedMutations;return new dn(null,new cn(n,r),null,i)}return t instanceof Qe?(n=t.key.path.toArray(),r=this.toDbTimestamp(t.version),new dn(new hn(n,r),null,null,!0)):y("Unexpected MaybeDocumment")},t.prototype.toDbTimestamp=function(t){var e=t.toTimestamp();return new on(e.seconds,e.nanoseconds)},t.prototype.fromDbTimestamp=function(t){var e=new Et(t.seconds,t.nanoseconds);return St.fromTimestamp(e)},t.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.baseMutations.map(function(t){return n.remoteSerializer.toMutation(t)}),i=e.mutations.map(function(t){return n.remoteSerializer.toMutation(t)});return new ln(t,e.batchId,e.localWriteTime.toMillis(),r,i)},t.prototype.fromDbMutationBatch=function(t){var e=this,n=(t.baseMutations||[]).map(function(t){return e.remoteSerializer.fromMutation(t)}),r=t.mutations.map(function(t){return e.remoteSerializer.fromMutation(t)}),i=Et.fromMillis(t.localWriteTimeMs);return new qt(t.batchId,i,n,r)},t.prototype.toDbResourcePaths=function(t){var e=[];return t.forEach(function(t){e.push(vt(t.path))}),e},t.prototype.fromDbResourcePaths=function(t){for(var e=Vt(),n=0,r=t;n<r.length;n++)e=e.add(new ut(wt(r[n])));return e},t.prototype.fromDbTarget=function(t){var e,n=this.fromDbTimestamp(t.readTime);return e=void 0!==t.query.documents?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new Tn(e,t.targetId,Cn.Listen,t.lastListenSequenceNumber,n,t.resumeToken)},t.prototype.toDbTarget=function(t){v(Cn.Listen===t.purpose,"Only queries with purpose "+Cn.Listen+" may be stored, got "+t.purpose);var e,n,r=this.toDbTimestamp(t.snapshotVersion);return e=t.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.query):this.remoteSerializer.toQueryTarget(t.query),t.resumeToken instanceof Uint8Array?(v("YES"===process.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence ."),n=t.resumeToken.toString()):n=t.resumeToken,new pn(t.targetId,t.query.canonicalId(),r,n,t.sequenceNumber,e)},t}();function xn(t,e){var n=t[1],r=e[1],i=K(t[0],e[0]);return 0===i?K(n,r):i}var An=function(){function t(t){this.maxElements=t,this.buffer=new At(xn),this.previousIndex=0}return t.prototype.nextIndex=function(){return++this.previousIndex},t.prototype.addElement=function(t){var e=[t,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();xn(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),kn={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Dn=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t.COLLECTION_DISABLED=-1,t.MINIMUM_CACHE_SIZE_BYTES=1048576,t.DEFAULT=new t(t.DEFAULT_CACHE_SIZE_BYTES=41943040,t.DEFAULT_COLLECTION_PERCENTILE=10,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3),t.DISABLED=new t(t.COLLECTION_DISABLED,0,0),t}(),Nn=function(){function t(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.hasRun=!1,this.gcTask=null}return t.prototype.start=function(){v(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==Dn.COLLECTION_DISABLED&&this.scheduleGC()},t.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),t.prototype.scheduleGC=function(){var t=this;v(null===this.gcTask,"Cannot schedule GC while a task is pending");var e=this.hasRun?3e5:6e4;p("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(ht.LruGarbageCollection,e,function(){return t.gcTask=null,t.hasRun=!0,t.localStore.collectGarbage(t.garbageCollector).then(function(){return t.scheduleGC()}).catch(Bn)})},t}(),Rn=function(){function t(t,e){this.delegate=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.delegate.getSequenceNumberCount(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return zt.resolve(it.INVALID);var r=new An(e);return this.delegate.forEachTarget(t,function(t){return r.addElement(t.sequenceNumber)}).next(function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(t,function(t){return r.addElement(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.delegate.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.delegate.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return this.params.cacheSizeCollectionThreshold===Dn.COLLECTION_DISABLED?(p("LruGarbageCollector","Garbage collection skipped; disabled"),zt.resolve(kn)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(p("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),kn):n.runGarbageCollection(t,e)})},t.prototype.getCacheSize=function(t){return this.delegate.getCacheSize(t)},t.prototype.runGarbageCollection=function(t,e){var n,r,i,o,s,a,l,u=this,c=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>u.params.maximumSequenceNumbersToCollect?(p("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+u.params.maximumSequenceNumbersToCollect+" from "+e),r=u.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),u.nthSequenceNumber(t,r)}).next(function(r){return n=r,s=Date.now(),u.removeTargets(t,n,e)}).next(function(e){return i=e,a=Date.now(),u.removeOrphanedDocuments(t,n)}).next(function(t){return l=Date.now(),d()<=h.DEBUG&&p("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-c)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(l-a)+"ms\nTotal Duration: "+(l-c)+"ms"),zt.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})})},t}(),On="IndexedDbPersistence",Pn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Mn="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",Ln="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",Fn=function(t){function e(e,n){var r=t.call(this)||this;return r.simpleDbTransaction=e,r.currentSequenceNumber=n,r}return s.__extends(e,t),e}(function(){return function(){}}()),Vn=function(){function t(e,n,r,i,o,s,a){if(this.persistenceKey=e,this.clientId=n,this.queue=i,this.multiClientParams=a,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(t){return Promise.resolve()},!t.isAvailable())throw new E(w.UNIMPLEMENTED,Ln);if(this.referenceDelegate=new jn(this,s),this.dbName=e+t.MAIN_DATABASE,this.serializer=new In(o),this.document=r.document,this.allowTabSynchronization=void 0!==a,this.queryCache=new le(this.referenceDelegate,this.serializer),this.indexManager=new En,this.remoteDocumentCache=new Ke(this.serializer,this.indexManager,this.allowTabSynchronization),!r.window||!r.window.localStorage)throw new E(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=r.window,this.webStorage=this.window.localStorage}return t.getStore=function(t,e){if(t instanceof Fn)return ee.getStore(t.simpleDbTransaction,e);throw y("IndexedDbPersistence must use instances of IndexedDbTransaction")},t.createIndexedDbPersistence=function(e,n,r,i,o,a){return s.__awaiter(this,void 0,void 0,function(){var l;return s.__generator(this,function(s){switch(s.label){case 0:return[4,(l=new t(e,n,r,i,o,a)).start()];case 1:return s.sent(),[2,l]}})})},t.createMultiClientIndexedDbPersistence=function(e,n,r,i,o,a,l){return s.__awaiter(this,void 0,void 0,function(){var u;return s.__generator(this,function(s){switch(s.label){case 0:return[4,(u=new t(e,n,r,i,o,a,l)).start()];case 1:return s.sent(),[2,u]}})})},t.prototype.start=function(){var t=this;return v(!this.started,"IndexedDbPersistence double-started!"),v(null!==this.window,"Expected 'window' to be defined"),ee.openOrCreate(this.dbName,nn,new rn(this.serializer)).then(function(e){return t.simpleDb=e,t.updateClientMetadataAndTryBecomePrimary()}).then(function(){return t.attachVisibilityHandler(),t.attachWindowUnloadHook(),t.scheduleClientMetadataAndPrimaryLeaseRefreshes(),t.startRemoteDocumentCache()}).then(function(){return t.simpleDb.runTransaction("readonly",[gn.store],function(e){return he(e).next(function(e){t.listenSequence=new it(e,t.multiClientParams?t.multiClientParams.sequenceNumberSyncer:void 0)})})}).then(function(){t._started=!0}).catch(function(e){return t.simpleDb&&t.simpleDb.close(),Promise.reject(e)})},t.prototype.startRemoteDocumentCache=function(){var t=this;return this.simpleDb.runTransaction("readonly",wn,function(e){return t.remoteDocumentCache.start(e)})},t.prototype.setPrimaryStateListener=function(t){var e=this;return this.primaryStateListener=function(n){return s.__awaiter(e,void 0,void 0,function(){return s.__generator(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.simpleDb.setVersionChangeListener(function(n){return s.__awaiter(e,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return null!==n.newVersion?[3,2]:[4,t()];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.queue.enqueueAndForget(function(){return s.__awaiter(e,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.updateClientMetadataAndTryBecomePrimary=function(){var t=this;return this.simpleDb.runTransaction("readwrite",wn,function(e){return qn(e).put(new bn(t.clientId,Date.now(),t.networkEnabled,t.inForeground,t.remoteDocumentCache.lastProcessedDocumentChangeId)).next(function(){if(t.isPrimary)return t.verifyPrimaryLease(e).next(function(e){e||(t.isPrimary=!1,t.queue.enqueueAndForget(function(){return t.primaryStateListener(!1)}))})}).next(function(){return t.canActAsPrimary(e)}).next(function(n){var r=t.isPrimary;return t.isPrimary=n,r!==t.isPrimary&&t.queue.enqueueAndForget(function(){return t.primaryStateListener(t.isPrimary)}),r&&!t.isPrimary?t.releasePrimaryLeaseIfHeld(e):t.isPrimary?t.acquireOrExtendPrimaryLease(e):void 0})})},t.prototype.verifyPrimaryLease=function(t){var e=this;return Un(t).get(sn.key).next(function(t){return zt.resolve(e.isLocalClient(t))})},t.prototype.removeClientMetadata=function(t){return qn(t).delete(this.clientId)},t.prototype.maybeGarbageCollectMultiClientState=function(){return s.__awaiter(this,void 0,void 0,function(){var e,n,r=this;return s.__generator(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),n=[],[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(i){var o=t.getStore(i,bn.store);return o.loadAll().next(function(t){e=r.filterActiveClients(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)})}).next(function(){return zt.forEach(n,function(t){return o.delete(t.clientId)})}).next(function(){if((e=e.filter(function(t){return t.clientId!==r.clientId})).length>0){var t=e.map(function(t){return t.lastProcessedDocumentChangeId||0}),n=Math.min.apply(Math,t);return r.remoteDocumentCache.removeDocumentChangesThroughChangeId(i,n)}})})]);case 1:i.sent(),n.forEach(function(t){r.window.localStorage.removeItem(r.zombiedClientLocalStorageKey(t.clientId))}),i.label=2;case 2:return[2]}})})},t.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var t=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(ht.ClientMetadataRefresh,4e3,function(){return t.updateClientMetadataAndTryBecomePrimary().then(function(){return t.maybeGarbageCollectMultiClientState()}).then(function(){return t.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},t.prototype.isLocalClient=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.canActAsPrimary=function(t){var e=this;return Un(t).get(sn.key).next(function(n){if(null!==n&&e.isWithinAge(n.leaseTimestampMs,5e3)&&!e.isClientZombied(n.ownerId)){if(e.isLocalClient(n)&&e.networkEnabled)return!0;if(!e.isLocalClient(n)){if(!n.allowTabSynchronization)throw new E(w.FAILED_PRECONDITION,Mn);return!1}}return!(!e.networkEnabled||!e.inForeground)||qn(t).loadAll().next(function(t){return void 0===e.filterActiveClients(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&p(On,"Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(){return s.__awaiter(this,void 0,void 0,function(){var t=this;return s.__generator(this,function(e){switch(e.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite",[sn.store,bn.store],function(e){return t.releasePrimaryLeaseIfHeld(e).next(function(){return t.removeClientMetadata(e)})})];case 1:return e.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}})})},t.prototype.filterActiveClients=function(t,e){var n=this;return t.filter(function(t){return n.isWithinAge(t.updateTimeMs,e)&&!n.isClientZombied(t.clientId)})},t.prototype.getActiveClients=function(){var t=this;return this.simpleDb.runTransaction("readonly",[bn.store],function(e){return qn(e).loadAll().next(function(e){return t.filterActiveClients(e,18e5).map(function(t){return t.clientId})})})},t.clearPersistence=function(e){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(n){switch(n.label){case 0:return t.isAvailable()?[4,ee.delete(e+t.MAIN_DATABASE)]:[2,Promise.resolve()];case 1:return n.sent(),[2]}})})},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getMutationQueue=function(t){return v(this.started,"Cannot initialize MutationQueue before persistence is started."),Qt.forUser(t,this.serializer,this.indexManager,this.referenceDelegate)},t.prototype.getQueryCache=function(){return v(this.started,"Cannot initialize QueryCache before persistence is started."),this.queryCache},t.prototype.getRemoteDocumentCache=function(){return v(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},t.prototype.getIndexManager=function(){return v(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},t.prototype.runTransaction=function(t,e,n){var r=this;return p(On,"Starting transaction:",t),this.simpleDb.runTransaction("readonly"===e?"readonly":"readwrite",wn,function(i){return"readwrite-primary"===e?r.verifyPrimaryLease(i).next(function(e){if(!e)throw m("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.queue.enqueueAndForget(function(){return r.primaryStateListener(!1)}),new E(w.FAILED_PRECONDITION,Pn);return n(new Fn(i,r.listenSequence.next()))}).next(function(t){return r.acquireOrExtendPrimaryLease(i).next(function(){return t})}):r.verifyAllowTabSynchronization(i).next(function(){return n(new Fn(i,r.listenSequence.next()))})})},t.prototype.verifyAllowTabSynchronization=function(t){var e=this;return Un(t).get(sn.key).next(function(t){if(null!==t&&e.isWithinAge(t.leaseTimestampMs,5e3)&&!e.isClientZombied(t.ownerId)&&!e.isLocalClient(t)&&!t.allowTabSynchronization)throw new E(w.FAILED_PRECONDITION,Mn)})},t.prototype.acquireOrExtendPrimaryLease=function(t){var e=new sn(this.clientId,this.allowTabSynchronization,Date.now());return Un(t).put(sn.key,e)},t.isAvailable=function(){return ee.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.releasePrimaryLeaseIfHeld=function(t){var e=this,n=Un(t);return n.get(sn.key).next(function(t){return e.isLocalClient(t)?(p(On,"Releasing primary lease."),n.delete(sn.key)):zt.resolve()})},t.prototype.isWithinAge=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(m("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.attachVisibilityHandler=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){t.queue.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},t.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(v(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){t.markClientZombied(),t.queue.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener("unload",this.windowUnloadHandler))},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(v("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.isClientZombied=function(t){try{var e=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(t));return p(On,"Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(n){return m(On,"Failed to get zombied client id.",n),!1}},t.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(t){m("Failed to set zombie client id.",t)}},t.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(t){}},t.prototype.zombiedClientLocalStorageKey=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t.MAIN_DATABASE="main",t}();function Bn(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){if(!function(t){return t.code===w.FAILED_PRECONDITION&&t.message===Pn}(t))throw t;return p(On,"Unexpectedly lost primary lease"),[2]})})}function Un(t){return t.store(sn.store)}function qn(t){return t.store(bn.store)}var jn=function(){function t(t,e){this.db=t,this.inMemoryPins=null,this.garbageCollector=new Rn(this,e)}return t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocmentCount(t);return this.db.getQueryCache().getQueryCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocmentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getQueryCache().forEachTarget(t,e)},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){return this.forEachOrphanedDocument(t,function(t,n){return e(n)})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return zn(t,e)},t.prototype.removeReference=function(t,e){return zn(t,e)},t.prototype.removeTargets=function(t,e,n){return this.db.getQueryCache().removeTargets(t,e,n)},t.prototype.removeMutationReference=function(t,e){return zn(t,e)},t.prototype.isPinned=function(t,e){return this.inMemoryPins.containsKey(e)?zt.resolve(!0):function(t,e){var n=!1;return Yt(t).iterateSerial(function(r){return Ht(t,r,e).next(function(t){return t&&(n=!0),zt.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.forEachOrphanedDocument(t,function(s,a){if(a<=e){var l=n.isPinned(t,s).next(function(e){if(!e)return o++,r.getEntry(t,s).next(function(){return r.removeEntry(s),de(t).delete([0,vt(s.path)])})});i.push(l)}}).next(function(){return zt.waitFor(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.copy({sequenceNumber:t.currentSequenceNumber});return this.db.getQueryCache().updateQueryData(t,n)},t.prototype.updateLimboDocument=function(t,e){return zn(t,e)},t.prototype.forEachOrphanedDocument=function(t,e){var n,r=de(t),i=it.INVALID;return r.iterate({index:mn.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==it.INVALID&&e(new ut(wt(n)),i),i=s,n=o):i=it.INVALID}).next(function(){i!==it.INVALID&&e(new ut(wt(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function zn(t,e){return de(t).put(function(t,e){return new mn(0,vt(t.path),e)}(e,t.currentSequenceNumber))}var Qn=function(){function t(t,e,n){this.remoteDocumentCache=t,this.mutationQueue=e,this.indexManager=n}return t.prototype.getDocument=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.getDocumentInternal(t,e,r)})},t.prototype.getDocumentInternal=function(t,e,n){return this.remoteDocumentCache.getEntry(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].applyToLocalView(e,t);return t})},t.prototype.applyLocalMutationsToDocuments=function(t,e,n){var r=Rt();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].applyToLocalView(t,e);r=r.insert(t,e)}),r},t.prototype.getDocuments=function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next(function(e){return n.getLocalViewOfDocuments(t,e)})},t.prototype.getLocalViewOfDocuments=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(r){var i=n.applyLocalMutationsToDocuments(t,e,r),o=Nt();return i.forEach(function(t,e){e||(e=new ze(t,St.forDeletedDoc())),o=o.insert(t,e)}),o})},t.prototype.getDocumentsMatchingQuery=function(t,e){return e.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(t,e.path):e.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(t,e):this.getDocumentsMatchingCollectionQuery(t,e)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new ut(e)).next(function(t){var e=Pt();return t instanceof je&&(e=e.insert(t.key,t)),e})},t.prototype.getDocumentsMatchingCollectionGroupQuery=function(t,e){var n=this;v(e.path.isEmpty(),"Currently we only support collection group queries at the root.");var r=e.collectionGroup,i=Pt();return this.indexManager.getCollectionParents(t,r).next(function(o){return zt.forEach(o,function(o){var s=e.asCollectionQueryAtPath(o.child(r));return n.getDocumentsMatchingCollectionQuery(t,s).next(function(t){t.forEach(function(t,e){i=i.insert(t,e)})})}).next(function(){return i})})},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e){var n,r,i=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e).next(function(r){return n=r,i.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){return i.addMissingBaseDocuments(t,r=e,n).next(function(t){n=t;for(var e=0,i=r;e<i.length;e++)for(var o=i[e],s=0,a=o.mutations;s<a.length;s++){var l=a[s],u=l.key,c=n.get(u),h=l.applyToLocalView(c,c,o.localWriteTime);n=h instanceof je?n.insert(u,h):n.remove(u)}})}).next(function(){return n.forEach(function(t,r){e.matches(r)||(n=n.remove(t))}),n})},t.prototype.addMissingBaseDocuments=function(t,e,n){for(var r=Vt(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var l=a[s];l instanceof be&&null===n.get(l.key)&&(r=r.add(l.key))}var u=n;return this.remoteDocumentCache.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof je&&(u=u.insert(t,e))}),u})},t}(),Hn=function(){function t(){this.refsByKey=new At(Wn.compareByKey),this.refsByTarget=new At(Wn.compareByTargetId)}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new Wn(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.removeRef(new Wn(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.removeReferencesForId=function(t){var e=this,n=ut.EMPTY,r=new Wn(n,t),i=new Wn(n,t+1),o=[];return this.refsByTarget.forEachInRange([r,i],function(t){e.removeRef(t),o.push(t.key)}),o},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t)},t.prototype.referencesForId=function(t){var e=ut.EMPTY,n=new Wn(e,t),r=new Wn(e,t+1),i=Vt();return this.refsByTarget.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new Wn(t,0),n=this.refsByKey.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Wn=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return ut.comparator(t.key,e.key)||K(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return K(t.targetOrBatchId,e.targetOrBatchId)||ut.comparator(t.key,e.key)},t}(),Gn=function(){function t(t,e){this.persistence=t,this.localViewReferences=new Hn,this.queryDataByTarget={},v(t.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=t.getMutationQueue(e),this.remoteDocuments=t.getRemoteDocumentCache(),this.queryCache=t.getQueryCache(),this.localDocuments=new Qn(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager())}return t.prototype.handleUserChange=function(t){var e=this;return this.persistence.runTransaction("Handle user change","readonly",function(n){var r;return e.mutationQueue.getAllMutationBatches(n).next(function(i){return r=i,e.mutationQueue=e.persistence.getMutationQueue(t),e.localDocuments=new Qn(e.remoteDocuments,e.mutationQueue,e.persistence.getIndexManager()),e.mutationQueue.getAllMutationBatches(n)}).next(function(t){for(var i=[],o=[],s=Vt(),a=0,l=r;a<l.length;a++){i.push((f=l[a]).batchId);for(var u=0,c=f.mutations;u<c.length;u++)s=s.add(c[u].key)}for(var h=0,d=t;h<d.length;h++){var f;o.push((f=d[h]).batchId);for(var p=0,m=f.mutations;p<m.length;p++)s=s.add(m[p].key)}return e.localDocuments.getDocuments(n,s).next(function(t){return{affectedDocuments:t,removedBatchIds:i,addedBatchIds:o}})})})},t.prototype.localWrite=function(t){var e=this,n=Et.now(),r=t.reduce(function(t,e){return t.add(e.key)},Vt());return this.persistence.runTransaction("Locally write mutations","readwrite",function(i){return e.localDocuments.getDocuments(i,r).next(function(r){for(var o=[],s=0,a=t;s<a.length;s++){var l=a[s],u=l.extractBaseValue(r.get(l.key));null!=u&&o.push(new be(l.key,u,u.fieldMask(),ye.exists(!0)))}return e.mutationQueue.addMutationBatch(i,n,o,t).next(function(t){var e=t.applyToLocalDocumentSet(r);return{batchId:t.batchId,changes:e}})})})},t.prototype.lookupMutationDocuments=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(n){return e.mutationQueue.lookupMutationKeys(n,t).next(function(t){return t?e.localDocuments.getDocuments(n,t):zt.resolve(null)})})},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(n){var r=t.batch.keys(),i=e.remoteDocuments.newChangeBuffer();return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next(function(){return e.applyWriteToRemoteDocuments(n,t,i)}).next(function(){return i.apply(n)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(n){var r;return e.mutationQueue.lookupMutationBatch(n,t).next(function(t){return v(null!==t,"Attempt to reject nonexistent batch!"),r=t.keys(),e.mutationQueue.removeMutationBatch(n,t)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.getHighestUnacknowledgedBatchId=function(){var t=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)})},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly",function(e){return t.mutationQueue.getLastStreamToken(e)})},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(n){return e.mutationQueue.setLastStreamToken(n,t)})},t.prototype.getLastRemoteSnapshotVersion=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.queryCache.getLastRemoteSnapshotVersion(e)})},t.prototype.applyRemoteEvent=function(e){var n=this,r=this.remoteDocuments.newChangeBuffer(),i=e.snapshotVersion;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var s=[];I(e.targetChanges,function(e,r){var a=n.queryDataByTarget[e];if(a){s.push(n.queryCache.removeMatchingKeys(o,r.removedDocuments,e).next(function(){return n.queryCache.addMatchingKeys(o,r.addedDocuments,e)}));var l=r.resumeToken;if(l.length>0){var u=a.copy({resumeToken:l,snapshotVersion:i});n.queryDataByTarget[e]=u,t.shouldPersistQueryData(a,u,r)&&s.push(n.queryCache.updateQueryData(o,u))}}});var a=Nt(),l=Vt();if(e.documentUpdates.forEach(function(t,e){l=l.add(t)}),s.push(r.getEntries(o,l).next(function(t){e.documentUpdates.forEach(function(i,l){var u=t.get(i);null==u||l.version.compareTo(u.version)>0||0===l.version.compareTo(u.version)&&u.hasPendingWrites?(r.addEntry(l),a=a.insert(i,l)):l instanceof ze&&l.version.isEqual(St.MIN)?(r.removeEntry(i),a=a.insert(i,l)):p("LocalStore","Ignoring outdated watch update for ",i,". Current version:",u.version," Watch version:",l.version),e.resolvedLimboDocuments.has(i)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(o,i))})})),!i.isEqual(St.MIN)){var u=n.queryCache.getLastRemoteSnapshotVersion(o).next(function(t){return v(i.compareTo(t)>=0,"Watch stream reverted to previous snapshot?? "+i+" < "+t),n.queryCache.setTargetsMetadata(o,o.currentSequenceNumber,i)});s.push(u)}return zt.waitFor(s).next(function(){return r.apply(o)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(o,a)})})},t.shouldPersistQueryData=function(t,e,n){return v(e.resumeToken.length>0,"Attempted to persist query data with no resume token"),0===t.resumeToken.length||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0},t.prototype.notifyLocalViewChanges=function(t){var e=this;return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return zt.forEach(t,function(t){return e.localViewReferences.addReferences(t.addedKeys,t.targetId),e.localViewReferences.removeReferences(t.removedKeys,t.targetId),zt.forEach(t.removedKeys,function(t){return e.persistence.referenceDelegate.removeReference(n,t)})})})},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(n){return void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)})},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document","readonly",function(n){return e.localDocuments.getDocument(n,t)})},t.prototype.allocateQuery=function(t){var e=this;return this.persistence.runTransaction("Allocate query","readwrite",function(n){var r;return e.queryCache.getQueryData(n,t).next(function(i){return i?(r=i,zt.resolve()):e.queryCache.allocateTargetId(n).next(function(i){return r=new Tn(t,i,Cn.Listen,n.currentSequenceNumber),e.queryCache.addQueryData(n,r)})}).next(function(){return v(!e.queryDataByTarget[r.targetId],"Tried to allocate an already allocated query: "+t),e.queryDataByTarget[r.targetId]=r,r})})},t.prototype.releaseQuery=function(t,e){var n=this;return this.persistence.runTransaction("Release query",e?"readwrite":"readwrite-primary",function(r){return n.queryCache.getQueryData(r,t).next(function(i){v(null!=i,"Tried to release nonexistent query: "+t);var o=i.targetId,s=n.queryDataByTarget[o],a=n.localViewReferences.removeReferencesForId(o);return delete n.queryDataByTarget[o],e?zt.resolve():zt.forEach(a,function(t){return n.persistence.referenceDelegate.removeReference(r,t)}).next(function(){return n.persistence.referenceDelegate.removeTarget(r,s)})})})},t.prototype.executeQuery=function(t){var e=this;return this.persistence.runTransaction("Execute query","readonly",function(n){return e.localDocuments.getDocumentsMatchingQuery(n,t)})},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly",function(n){return e.queryCache.getMatchingKeysForTargetId(n,t)})},t.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},t.prototype.removeCachedMutationBatchMetadata=function(t){this.mutationQueue.removeCachedMutationKeys(t)},t.prototype.setNetworkEnabled=function(t){this.persistence.setNetworkEnabled(t)},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=this,i=e.batch,o=i.keys(),s=zt.resolve();return o.forEach(function(r){s=s.next(function(){return n.getEntry(t,r)}).next(function(t){var o=t,s=e.docVersions.get(r);v(null!==s,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(s)<0)&&((o=i.applyToRemoteDocument(r,o,e))?n.addEntry(o):v(!t,"Mutation batch "+i+" applied to document "+t+" resulted in null"))})}),s.next(function(){return r.mutationQueue.removeMutationBatch(t,i)})},t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.queryDataByTarget)})},t.prototype.getQueryForTarget=function(t){var e=this;return this.queryDataByTarget[t]?Promise.resolve(this.queryDataByTarget[t].query):this.persistence.runTransaction("Get query data","readonly",function(n){return e.queryCache.getQueryDataForTarget(n,t).next(function(t){return t?t.query:null})})},t.prototype.getNewDocumentChanges=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly",function(e){return t.remoteDocuments.getNewDocumentChanges(e)})},t.RESUME_TOKEN_MAX_AGE_MICROS=3e8,t}(),Kn=function(){function t(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=b(),this.batchesByDocumentKey=new At(Wn.compareByKey)}return t.prototype.checkEmpty=function(t){return zt.resolve(0===this.mutationQueue.length)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId,i=this.indexOfExistingBatchId(r,"acknowledged");v(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return v(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,zt.resolve()},t.prototype.getLastStreamToken=function(t){return zt.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,zt.resolve()},t.prototype.addMutationBatch=function(t,e,n,r){v(0!==r.length,"Mutation batches should not be empty");var i=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&v(this.mutationQueue[this.mutationQueue.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");var o=new qt(i,e,n,r);this.mutationQueue.push(o);for(var s=0,a=r;s<a.length;s++){var l=a[s];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Wn(l.key,i)),this.indexManager.addToCollectionParentIndex(t,l.key.path.popLast())}return zt.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return zt.resolve(this.findMutationBatch(e))},t.prototype.lookupMutationKeys=function(t,e){var n=this.findMutationBatch(e);return v(null!=n,"Failed to find local mutation batch."),zt.resolve(n.keys())},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.indexOfBatchId(e+1),r=n<0?0:n;return zt.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return zt.resolve(0===this.mutationQueue.length?-1:this.nextBatchId-1)},t.prototype.getAllMutationBatches=function(t){return zt.resolve(this.mutationQueue.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Wn(e,0),i=new Wn(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(t){v(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);v(null!==r,"Batches in the index must exist in the main table"),o.push(r)}),zt.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new At(K);return e.forEach(function(t){var e=new Wn(t,0),i=new Wn(t,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([e,i],function(e){v(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),r=r.add(e.targetOrBatchId)})}),zt.resolve(this.findMutationBatches(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){v(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=e.path,r=n.length+1,i=n;ut.isDocumentKey(i)||(i=i.child(""));var o=new Wn(new ut(i),0),s=new At(K);return this.batchesByDocumentKey.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.targetOrBatchId)),!0)},o),zt.resolve(this.findMutationBatches(s))},t.prototype.findMutationBatches=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.findMutationBatch(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;v(0===this.indexOfExistingBatchId(e.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return zt.forEach(e.mutations,function(i){var o=new Wn(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.removeMutationReference(t,i.key)}).next(function(){n.batchesByDocumentKey=r})},t.prototype.removeCachedMutationKeys=function(t){},t.prototype.containsKey=function(t,e){var n=new Wn(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return zt.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&v(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),zt.resolve()},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return v(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return v(n.batchId===t,"If found batch must match"),n},t}(),$n=function(){function t(t){this.persistence=t,this.queries=new He(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=St.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Hn,this.targetCount=0,this.targetIdGenerator=Jt.forQueryCache()}return t.prototype.getTargetCount=function(t){return zt.resolve(this.targetCount)},t.prototype.forEachTarget=function(t,e){return this.queries.forEach(function(t,n){return e(n)}),zt.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return zt.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return zt.resolve(this.highestSequenceNumber)},t.prototype.allocateTargetId=function(t){var e=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=e,zt.resolve(e)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.highestSequenceNumber&&(this.highestSequenceNumber=e),zt.resolve()},t.prototype.saveQueryData=function(t){this.queries.set(t.query,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=t.sequenceNumber)},t.prototype.addQueryData=function(t,e){return v(!this.queries.has(e.query),"Adding a query that already exists"),this.saveQueryData(e),this.targetCount+=1,zt.resolve()},t.prototype.updateQueryData=function(t,e){return v(this.queries.has(e.query),"Updating a non-existent query"),this.saveQueryData(e),zt.resolve()},t.prototype.removeQueryData=function(t,e){return v(this.targetCount>0,"Removing a target from an empty cache"),v(this.queries.has(e.query),"Removing a non-existent target from the cache"),this.queries.delete(e.query),this.references.removeReferencesForId(e.targetId),this.targetCount-=1,zt.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.queries.forEach(function(s,a){a.sequenceNumber<=e&&!n[a.targetId]&&(r.queries.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),zt.waitFor(o).next(function(){return i})},t.prototype.getQueryCount=function(t){return zt.resolve(this.targetCount)},t.prototype.getQueryData=function(t,e){var n=this.queries.get(e)||null;return zt.resolve(n)},t.prototype.getQueryDataForTarget=function(t,e){return y("Not yet implemented.")},t.prototype.addMatchingKeys=function(t,e,n){this.references.addReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.addReference(t,e))}),zt.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){this.references.removeReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.removeReference(t,e))}),zt.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),zt.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return zt.resolve(n)},t.prototype.containsKey=function(t,e){return zt.resolve(this.references.containsKey(e))},t}(),Yn=function(){function t(t,e){this.indexManager=t,this.sizer=e,this.docs=new Ct(ut.comparator),this.newDocumentChanges=Vt(),this.size=0}return t.prototype.addEntry=function(t,e){var n=e.key,r=this.docs.get(n),i=r?r.size:0,o=this.sizer(e);return this.docs=this.docs.insert(n,{maybeDocument:e,size:o}),this.newDocumentChanges=this.newDocumentChanges.add(n),this.size+=o-i,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return zt.resolve(n?n.maybeDocument:null)},t.prototype.getEntries=function(t,e){var n=this,r=Rt();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null)}),zt.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e){v(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var n=Pt(),r=new ut(e.path.child("")),i=this.docs.getIteratorFrom(r);i.hasNext();){var o=i.getNext(),s=o.value.maybeDocument;if(!e.path.isPrefixOf(o.key.path))break;s instanceof je&&e.matches(s)&&(n=n.insert(s.key,s))}return zt.resolve(n)},t.prototype.forEachDocumentKey=function(t,e){return zt.forEach(this.docs,function(t){return e(t)})},t.prototype.getNewDocumentChanges=function(t){var e=this,n=Nt();return this.newDocumentChanges.forEach(function(t){var r=e.docs.get(t),i=r?r.maybeDocument:new ze(t,St.forDeletedDoc());n=n.insert(t,i)}),this.newDocumentChanges=Vt(),zt.resolve(n)},t.prototype.newChangeBuffer=function(){return new t.RemoteDocumentChangeBuffer(this)},t.prototype.getSize=function(t){return zt.resolve(this.size)},t.RemoteDocumentChangeBuffer=function(t){function e(e){var n=t.call(this)||this;return n.documentCache=e,n}return s.__extends(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach(function(r,i){i?n.push(e.documentCache.addEntry(t,i)):e.documentCache.removeEntry(r)}),zt.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.documentCache.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getEntries(t,e)},e}(We),t}(),Zn=function(){function t(t,e){var n=this;this.clientId=t,this.mutationQueues={},this.listenSequence=new it(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.queryCache=new $n(this),this.indexManager=new tn,this.remoteDocumentCache=new Yn(this.indexManager,function(t){return n.referenceDelegate.documentSize(t)})}return t.createLruPersistence=function(e,n,r){return new t(e,function(t){return new tr(t,new In(n),r)})},t.createEagerPersistence=function(e){return new t(e,function(t){return new Jn(t)})},t.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getActiveClients=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){return[2,[this.clientId]]})})},t.prototype.setPrimaryStateListener=function(t){return t(!0)},t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(t){},t.prototype.getIndexManager=function(){return this.indexManager},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new Kn(this.indexManager,this.referenceDelegate),this.mutationQueues[t.toKey()]=e),e},t.prototype.getQueryCache=function(){return this.queryCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e,n){var r=this;p("MemoryPersistence","Starting transaction:",t);var i=new Xn(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next(function(t){return r.referenceDelegate.onTransactionCommitted(i).next(function(){return t})}).toPromise()},t.prototype.mutationQueuesContainKey=function(t,e){return zt.or((n=this.mutationQueues,r=[],x(n,function(t,e){return r.push(e)}),r).map(function(n){return function(){return n.containsKey(t,e)}}));var n,r},t}(),Xn=function(){return function(t){this.currentSequenceNumber=t}}(),Jn=function(){function t(t){this.persistence=t,this.inMemoryPins=null,this._orphanedDocuments=null}return Object.defineProperty(t.prototype,"orphanedDocuments",{get:function(){if(this._orphanedDocuments)return this._orphanedDocuments;throw y("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return this.orphanedDocuments.delete(e),zt.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedDocuments.add(e),zt.resolve()},t.prototype.removeMutationReference=function(t,e){return this.orphanedDocuments.add(e),zt.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.getQueryCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.orphanedDocuments.add(t)})}).next(function(){return r.removeQueryData(t,e)})},t.prototype.onTransactionStarted=function(){this._orphanedDocuments=new Set},t.prototype.onTransactionCommitted=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return zt.forEach(this.orphanedDocuments,function(r){return e.isReferenced(t,r).next(function(t){t||n.removeEntry(r)})}).next(function(){return e._orphanedDocuments=null,n.apply(t)})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.isReferenced(t,e).next(function(t){t?n.orphanedDocuments.delete(e):n.orphanedDocuments.add(e)})},t.prototype.documentSize=function(t){return 0},t.prototype.isReferenced=function(t,e){var n=this;return zt.or([function(){return n.persistence.getQueryCache().containsKey(t,e)},function(){return n.persistence.mutationQueuesContainKey(t,e)},function(){return zt.resolve(n.inMemoryPins.containsKey(e))}])},t}(),tr=function(){function t(t,e,n){this.persistence=t,this.serializer=e,this.inMemoryPins=null,this.orphanedSequenceNumbers=new He(function(t){return vt(t.path)}),this.garbageCollector=new Rn(this,n)}return t.prototype.onTransactionStarted=function(){},t.prototype.onTransactionCommitted=function(t){return zt.resolve()},t.prototype.forEachTarget=function(t,e){return this.persistence.getQueryCache().forEachTarget(t,e)},t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocumentCount(t);return this.persistence.getQueryCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocumentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){var n=this;return zt.forEach(this.orphanedSequenceNumbers,function(r,i){return n.isPinned(t,r,i).next(function(t){return t?zt.resolve():e(i)})})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.removeTargets=function(t,e,n){return this.persistence.getQueryCache().removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.forEachDocumentKey(t,function(i){return n.isPinned(t,i,e).next(function(t){t||(r++,o.removeEntry(i))})}).next(function(){return o.apply(t)}).next(function(){return r})},t.prototype.removeMutationReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),zt.resolve()},t.prototype.removeTarget=function(t,e){var n=e.copy({sequenceNumber:t.currentSequenceNumber});return this.persistence.getQueryCache().updateQueryData(t,n)},t.prototype.addReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),zt.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),zt.resolve()},t.prototype.updateLimboDocument=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),zt.resolve()},t.prototype.documentSize=function(t){var e,n=this.serializer.toDbRemoteDocument(t);if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw y("Unknown remote document type");e=n.noDocument}return JSON.stringify(e).length},t.prototype.isPinned=function(t,e,n){var r=this;return zt.or([function(){return r.persistence.mutationQueuesContainKey(t,e)},function(){return zt.resolve(r.inMemoryPins.containsKey(e))},function(){return r.persistence.getQueryCache().containsKey(t,e)},function(){var t=r.orphanedSequenceNumbers.get(e);return zt.resolve(void 0!==t&&t>n)}])},t.prototype.getCacheSize=function(t){return this.persistence.getRemoteDocumentCache().getSize(t)},t}(),er=Number,nr=er.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),rr=er.MAX_SAFE_INTEGER||Math.pow(2,53)-1,ir=er.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t};function or(t){return null==t}function sr(t){return ir(t)&&t<=rr&&t>=nr}var ar=1e3,lr=1.5,ur=6e4,cr=function(){function t(t,e,n,r,i){void 0===n&&(n=ar),void 0===r&&(r=lr),void 0===i&&(i=ur),this.queue=t,this.timerId=e,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndRun=function(t){var e=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);this.currentBaseMs>0&&p("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,function(){return e.lastAttemptTime=Date.now(),t()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},t.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}(),hr=function(t){return t[t.Initial=0]="Initial",t[t.Starting=1]="Starting",t[t.Open=2]="Open",t[t.Error=3]="Error",t[t.Backoff=4]="Backoff",t}({}),dr=function(){function t(t,e,n,r,i,o){this.queue=t,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=hr.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new cr(t,e)}return t.prototype.isStarted=function(){return this.state===hr.Starting||this.state===hr.Open||this.state===hr.Backoff},t.prototype.isOpen=function(){return this.state===hr.Open},t.prototype.start=function(){this.state!==hr.Error?(v(this.state===hr.Initial,"Already started"),this.auth()):this.performBackoff()},t.prototype.stop=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.isStarted()?[4,this.close(hr.Initial)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.inhibitBackoff=function(){v(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=hr.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,function(){return t.handleIdleCloseTimer()}))},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){return this.isOpen()?[2,this.close(hr.Initial)]:[2]})})},t.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},t.prototype.close=function(t,e){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(n){switch(n.label){case 0:return v(this.isStarted(),"Only started streams should be closed."),v(t===hr.Error||or(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,t!==hr.Error?this.backoff.reset():e&&e.code===w.RESOURCE_EXHAUSTED?(m(e.toString()),m("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):e&&e.code===w.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.onClose(e)];case 1:return n.sent(),[2]}})})},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;v(this.state===hr.Initial,"Must be in initial state to auth"),this.state=hr.Starting;var e=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then(function(e){t.closeCount===n&&t.startStream(e)},function(n){e(function(){var e=new E(w.UNKNOWN,"Fetching auth token failed: "+n.message);return t.handleStreamClose(e)})})},t.prototype.startStream=function(t){var e=this;v(this.state===hr.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(t),this.stream.onOpen(function(){n(function(){return v(e.state===hr.Starting,"Expected stream to be in state Starting, but was "+e.state),e.state=hr.Open,e.listener.onOpen()})}),this.stream.onClose(function(t){n(function(){return e.handleStreamClose(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.performBackoff=function(){var t=this;v(this.state===hr.Error,"Should only perform backoff when in Error state"),this.state=hr.Backoff,this.backoff.backoffAndRun(function(){return s.__awaiter(t,void 0,void 0,function(){return s.__generator(this,function(t){return v(this.state===hr.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=hr.Initial,this.start(),v(this.isStarted(),"PersistentStream should have started"),[2]})})})},t.prototype.handleStreamClose=function(t){return v(this.isStarted(),"Can't handle server close on non-started stream"),p("PersistentStream","close with error: "+t),this.stream=null,this.close(hr.Error,t)},t.prototype.getCloseGuardedDispatcher=function(t){var e=this;return function(n){e.queue.enqueueAndForget(function(){return e.closeCount===t?n():(p("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),fr=function(t){function e(e,n,r,i,o){var s=t.call(this,e,ht.ListenStreamConnectionBackoff,ht.ListenStreamIdle,n,r,o)||this;return s.serializer=i,s}return s.__extends(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(dr),pr=function(t){function e(e,n,r,i,o){var s=t.call(this,e,ht.WriteStreamConnectionBackoff,ht.WriteStreamIdle,n,r,o)||this;return s.serializer=i,s.handshakeComplete_=!1,s.lastStreamToken=b(),s}return s.__extends(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.handshakeComplete_=!1,t.prototype.start.call(this)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(v(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return v(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){v(this.isOpen(),"Writing handshake requires an opened stream"),v(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;v(this.isOpen(),"Writing mutations requires an opened stream"),v(this.handshakeComplete_,"Handshake must be complete before writing mutations"),v(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map(function(t){return e.serializer.toMutation(t)})};this.sendRequest(n)},e}(dr),mr=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.newPersistentWriteStream=function(t){return new pr(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.newPersistentWatchStream=function(t){return new fr(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map(function(t){return e.serializer.toMutation(t)})};return this.invokeRPC("Commit",n).then(function(t){return e.serializer.fromWriteResults(t.writeResults,t.commitTime)})},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map(function(t){return e.serializer.toName(t)})};return this.invokeStreamingRPC("BatchGetDocuments",n).then(function(n){var r=Nt();n.forEach(function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);v(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeRPC(t,e,r)}).catch(function(t){throw t.code===w.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeStreamingRPC(t,e,r)}).catch(function(t){throw t.code===w.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t}(),gr=function(){function t(t){this.datastore=t,this.readVersions=Lt(),this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n=this;return s.__generator(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new E(w.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.datastore.lookup(t)];case 1:return(e=r.sent()).forEach(function(t){t instanceof ze||t instanceof je?n.recordVersion(t):y("Document in a transaction was a "+t.constructor.name)}),[2,e]}})})},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t))),this.writtenDocs.add(t)},t.prototype.update=function(t,e){try{this.write(e.toMutations(t,this.preconditionForUpdate(t)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(t)},t.prototype.delete=function(t){this.write([new Ee(t,this.precondition(t))]),this.writtenDocs.add(t)},t.prototype.commit=function(){return s.__awaiter(this,void 0,void 0,function(){var t;return s.__generator(this,function(e){switch(e.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;if(t=this.readVersions,this.mutations.forEach(function(e){t=t.remove(e.key)}),!t.isEmpty())throw new E(w.INVALID_ARGUMENT,"Every document read in a transaction must also be written.");return[4,this.datastore.commit(this.mutations)];case 1:return e.sent(),this.committed=!0,[2]}})})},t.prototype.recordVersion=function(t){var e;if(t instanceof je)e=t.version;else{if(!(t instanceof ze))throw y("Document in a transaction was a "+t.constructor.name);e=St.forDeletedDoc()}var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new E(w.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return!this.writtenDocs.has(t)&&e?ye.updateTime(e):ye.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(!this.writtenDocs.has(t)&&e){if(e.isEqual(St.forDeletedDoc()))throw new E(w.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ye.updateTime(e)}return ye.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(t)},t.prototype.ensureCommitNotCalled=function(){v(!this.committed,"A transaction object cannot be used after its update callback has been invoked.")},t}(),yr=function(t){return t[t.Unknown=0]="Unknown",t[t.Online=1]="Online",t[t.Offline=2]="Offline",t}({}),vr=function(t){return t[t.RemoteStore=0]="RemoteStore",t[t.SharedClientState=1]="SharedClientState",t}({}),_r=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=yr.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return t.prototype.handleWatchStreamStart=function(){var t=this;0===this.watchStreamFailures&&(this.setAndBroadcast(yr.Unknown),v(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(ht.OnlineStateTimeout,1e4,function(){return t.onlineStateTimer=null,v(t.state===yr.Unknown,"Timer should be canceled if we transitioned to a different state."),t.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),t.setAndBroadcast(yr.Offline),Promise.resolve()}))},t.prototype.handleWatchStreamFailure=function(t){this.state===yr.Online?(this.setAndBroadcast(yr.Unknown),v(0===this.watchStreamFailures,"watchStreamFailures must be 0"),v(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,this.watchStreamFailures>=1&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+t.toString()),this.setAndBroadcast(yr.Offline)))},t.prototype.set=function(t){this.clearOnlineStateTimer(),this.watchStreamFailures=0,t===yr.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(t)},t.prototype.setAndBroadcast=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.logClientOfflineWarningIfNecessary=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(m(e),this.shouldWarnClientIsOffline=!1):p("OnlineStateTracker",e)},t.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},t}(),br=function(t){return t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS",t}({});function wr(t){switch(t){case w.OK:return y("Treated status OK as error");case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0;default:return y("Unknown status code: "+t)}}function Er(t){if(void 0===t)return m("GRPC error has no .code"),w.UNKNOWN;switch(t){case br.OK:return w.OK;case br.CANCELLED:return w.CANCELLED;case br.UNKNOWN:return w.UNKNOWN;case br.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case br.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case br.INTERNAL:return w.INTERNAL;case br.UNAVAILABLE:return w.UNAVAILABLE;case br.UNAUTHENTICATED:return w.UNAUTHENTICATED;case br.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case br.NOT_FOUND:return w.NOT_FOUND;case br.ALREADY_EXISTS:return w.ALREADY_EXISTS;case br.PERMISSION_DENIED:return w.PERMISSION_DENIED;case br.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case br.ABORTED:return w.ABORTED;case br.OUT_OF_RANGE:return w.OUT_OF_RANGE;case br.UNIMPLEMENTED:return w.UNIMPLEMENTED;case br.DATA_LOSS:return w.DATA_LOSS;default:return y("Unknown status code: "+t)}}function Sr(t){if(void 0===t)return br.OK;switch(t){case w.OK:return br.OK;case w.CANCELLED:return br.CANCELLED;case w.UNKNOWN:return br.UNKNOWN;case w.DEADLINE_EXCEEDED:return br.DEADLINE_EXCEEDED;case w.RESOURCE_EXHAUSTED:return br.RESOURCE_EXHAUSTED;case w.INTERNAL:return br.INTERNAL;case w.UNAVAILABLE:return br.UNAVAILABLE;case w.UNAUTHENTICATED:return br.UNAUTHENTICATED;case w.INVALID_ARGUMENT:return br.INVALID_ARGUMENT;case w.NOT_FOUND:return br.NOT_FOUND;case w.ALREADY_EXISTS:return br.ALREADY_EXISTS;case w.PERMISSION_DENIED:return br.PERMISSION_DENIED;case w.FAILED_PRECONDITION:return br.FAILED_PRECONDITION;case w.ABORTED:return br.ABORTED;case w.OUT_OF_RANGE:return br.OUT_OF_RANGE;case w.UNIMPLEMENTED:return br.UNIMPLEMENTED;case w.DATA_LOSS:return br.DATA_LOSS;default:return y("Unknown status code: "+t)}}var Cr=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||ut.comparator(e.key,n.key)}:function(t,e){return ut.comparator(t.key,e.key)},this.keyedMap=Pt(),this.sortedSet=new Ct(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Tr=function(t){return t[t.Added=0]="Added",t[t.Removed=1]="Removed",t[t.Modified=2]="Modified",t[t.Metadata=3]="Metadata",t}({}),Ir=function(t){return t[t.Local=0]="Local",t[t.Synced=1]="Synced",t}({}),xr=function(){function t(){this.changeMap=new Ct(ut.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);n?t.type!==Tr.Added&&n.type===Tr.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===Tr.Metadata&&n.type!==Tr.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===Tr.Modified&&n.type===Tr.Modified?this.changeMap=this.changeMap.insert(e,{type:Tr.Modified,doc:t.doc}):t.type===Tr.Modified&&n.type===Tr.Added?this.changeMap=this.changeMap.insert(e,{type:Tr.Added,doc:t.doc}):t.type===Tr.Removed&&n.type===Tr.Added?this.changeMap=this.changeMap.remove(e):t.type===Tr.Removed&&n.type===Tr.Modified?this.changeMap=this.changeMap.insert(e,{type:Tr.Removed,doc:n.doc}):t.type===Tr.Added&&n.type===Tr.Removed?this.changeMap=this.changeMap.insert(e,{type:Tr.Modified,doc:t.doc}):y("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(e,t)},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal(function(e,n){t.push(n)}),t},t}(),Ar=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:Tr.Added,doc:t})}),new t(e,n,Cr.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),kr=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r,i=((r={})[e]=Dr.createSynthesizedTargetChangeForCurrentChange(e,n),r);return new t(St.MIN,i,Ut(),Nt(),Vt())},t}(),Dr=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(b(),n,Vt(),Vt(),Vt())},t}(),Nr=function(){return function(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r}}(),Rr=function(){return function(t,e){this.targetId=t,this.existenceFilter=e}}(),Or=function(t){return t[t.NoChange=0]="NoChange",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Current=3]="Current",t[t.Reset=4]="Reset",t}({}),Pr=function(){return function(t,e,n,r){void 0===n&&(n=b()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}}(),Mr=function(){function t(){this.pendingResponses=0,this.documentChanges=Vr(),this._resumeToken=b(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),t.prototype.updateResumeToken=function(t){t.length>0&&(this._hasPendingChanges=!0,this._resumeToken=t)},t.prototype.toTargetChange=function(){var t=Vt(),e=Vt(),n=Vt();return this.documentChanges.forEach(function(r,i){switch(i){case Tr.Added:t=t.add(r);break;case Tr.Modified:e=e.add(r);break;case Tr.Removed:n=n.add(r);break;default:y("Encountered invalid change type: "+i)}}),new Dr(this._resumeToken,this._current,t,e,n)},t.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=Vr()},t.prototype.addDocumentChange=function(t,e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(t,e)},t.prototype.removeDocumentChange=function(t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(t)},t.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},t.prototype.recordTargetResponse=function(){this.pendingResponses-=1},t.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},t}(),Lr=function(){function t(t){this.metadataProvider=t,this.targetStates={},this.pendingDocumentUpdates=Nt(),this.pendingDocumentTargetMapping=Fr(),this.pendingTargetResets=new At(K)}return t.prototype.handleDocumentChange=function(t){for(var e=0,n=t.updatedTargetIds;e<n.length;e++){var r=n[e];t.newDoc instanceof je?this.addDocumentToTarget(r,t.newDoc):t.newDoc instanceof ze&&this.removeDocumentFromTarget(r,t.key,t.newDoc)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.removeDocumentFromTarget(r=o[i],t.key,t.newDoc)},t.prototype.handleTargetChange=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.ensureTargetState(n);switch(t.state){case Or.NoChange:e.isActiveTarget(n)&&r.updateResumeToken(t.resumeToken);break;case Or.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(t.resumeToken);break;case Or.Removed:r.recordTargetResponse(),r.isPending||e.removeTarget(n),v(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case Or.Current:e.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(t.resumeToken));break;case Or.Reset:e.isActiveTarget(n)&&(e.resetTarget(n),r.updateResumeToken(t.resumeToken));break;default:y("Unknown target watch change state: "+t.state)}})},t.prototype.forEachTarget=function(t,e){t.targetIds.length>0?t.targetIds.forEach(e):I(this.targetStates,e)},t.prototype.handleExistenceFilter=function(t){var e=t.targetId,n=t.existenceFilter.count,r=this.queryDataForActiveTarget(e);if(r){var i=r.query;if(i.isDocumentQuery())if(0===n){var o=new ut(i.path);this.removeDocumentFromTarget(e,o,new ze(o,St.forDeletedDoc()))}else v(1===n,"Single document existence filter with count: "+n);else this.getCurrentDocumentCountForTarget(e)!==n&&(this.resetTarget(e),this.pendingTargetResets=this.pendingTargetResets.add(e))}},t.prototype.createRemoteEvent=function(t){var e=this,n={};I(this.targetStates,function(r,i){var o=e.queryDataForActiveTarget(r);if(o){if(i.current&&o.query.isDocumentQuery()){var s=new ut(o.query.path);null!==e.pendingDocumentUpdates.get(s)||e.targetContainsDocument(r,s)||e.removeDocumentFromTarget(r,s,new ze(s,t))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}});var r=Vt();this.pendingDocumentTargetMapping.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.queryDataForActiveTarget(t);return!n||n.purpose===Cn.LimboResolution||(i=!1,!1)}),i&&(r=r.add(t))});var i=new kr(t,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=Nt(),this.pendingDocumentTargetMapping=Fr(),this.pendingTargetResets=new At(K),i},t.prototype.addDocumentToTarget=function(t,e){if(this.isActiveTarget(t)){var n=this.targetContainsDocument(t,e.key)?Tr.Modified:Tr.Added;this.ensureTargetState(t).addDocumentChange(e.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e.key,e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e.key,this.ensureDocumentTargetMapping(e.key).add(t))}},t.prototype.removeDocumentFromTarget=function(t,e,n){if(this.isActiveTarget(t)){var r=this.ensureTargetState(t);this.targetContainsDocument(t,e)?r.addDocumentChange(e,Tr.Removed):r.removeDocumentChange(e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,this.ensureDocumentTargetMapping(e).delete(t)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e,n))}},t.prototype.removeTarget=function(t){delete this.targetStates[t]},t.prototype.getCurrentDocumentCountForTarget=function(t){var e=this.ensureTargetState(t).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.recordPendingTargetRequest=function(t){this.ensureTargetState(t).recordPendingTargetRequest()},t.prototype.ensureTargetState=function(t){return this.targetStates[t]||(this.targetStates[t]=new Mr),this.targetStates[t]},t.prototype.ensureDocumentTargetMapping=function(t){var e=this.pendingDocumentTargetMapping.get(t);return e||(e=new At(K),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,e)),e},t.prototype.isActiveTarget=function(t){var e=null!==this.queryDataForActiveTarget(t);return e||p("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.queryDataForActiveTarget=function(t){var e=this.targetStates[t];return e&&e.isPending?null:this.metadataProvider.getQueryDataForTarget(t)},t.prototype.resetTarget=function(t){var e=this;v(!this.targetStates[t].isPending,"Should only reset active targets"),this.targetStates[t]=new Mr,this.metadataProvider.getRemoteKeysForTarget(t).forEach(function(n){e.removeDocumentFromTarget(t,n,null)})},t.prototype.targetContainsDocument=function(t,e){return this.metadataProvider.getRemoteKeysForTarget(t).has(e)},t}();function Fr(){return new Ct(ut.comparator)}function Vr(){return new Ct(ut.comparator)}var Br="RemoteStore",Ur=function(){function t(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=i,this.connectivityMonitor.addCallback(function(t){n.enqueueAndForget(function(){return s.__awaiter(o,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.canUseNetwork()?(p(Br,"Restarting streams for network reachability change."),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.onlineStateTracker=new _r(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return s.__awaiter(this,void 0,void 0,function(){var t;return s.__generator(this,function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(t=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(yr.Unknown),[4,this.fillWritePipeline()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.disableNetwork=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(yr.Offline),[2]}})})},t.prototype.disableNetworkInternal=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return[4,this.writeStream.stop()];case 1:return t.sent(),[4,this.watchStream.stop()];case 2:return t.sent(),this.writePipeline.length>0&&(p(Br,"Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}})})},t.prototype.shutdown=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return p(Br,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(yr.Unknown),[2]}})})},t.prototype.listen=function(t){v(!C(this.listenTargets,t.targetId),"listen called with duplicate targetId!"),this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(t)},t.prototype.unlisten=function(t){v(C(this.listenTargets,t),"unlisten called without assigned target ID!"),delete this.listenTargets[t],this.watchStream.isOpen()&&this.sendUnwatchRequest(t),A(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(yr.Unknown))},t.prototype.getQueryDataForTarget=function(t){return this.listenTargets[t]||null},t.prototype.getRemoteKeysForTarget=function(t){return this.syncEngine.getRemoteKeysForTarget(t)},t.prototype.sendWatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.startWatchStream=function(){v(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new Lr(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},t.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!A(this.listenTargets)},t.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},t.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},t.prototype.onWatchStreamOpen=function(){return s.__awaiter(this,void 0,void 0,function(){var t=this;return s.__generator(this,function(e){return I(this.listenTargets,function(e,n){t.sendWatchRequest(n)}),[2]})})},t.prototype.onWatchStreamClose=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){return void 0===t&&v(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(t),this.startWatchStream()):this.onlineStateTracker.set(yr.Unknown),[2]})})},t.prototype.onWatchStreamChange=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n;return s.__generator(this,function(r){switch(r.label){case 0:return this.onlineStateTracker.set(yr.Online),t instanceof Pr&&t.state===Or.Removed&&t.cause?[2,this.handleTargetError(t)]:(t instanceof Nr?this.watchChangeAggregator.handleDocumentChange(t):t instanceof Rr?this.watchChangeAggregator.handleExistenceFilter(t):(v(t instanceof Pr,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(t)),e.isEqual(St.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),e.compareTo(n)>=0?[4,this.raiseWatchSnapshot(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.raiseWatchSnapshot=function(t){var e=this;v(!t.isEqual(St.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(t);return I(n.targetChanges,function(n,r){if(r.resumeToken.length>0){var i=e.listenTargets[n];i&&(e.listenTargets[n]=i.copy({resumeToken:r.resumeToken,snapshotVersion:t}))}}),n.targetMismatches.forEach(function(t){var n=e.listenTargets[t];if(n){e.listenTargets[t]=n.copy({resumeToken:b()}),e.sendUnwatchRequest(t);var r=new Tn(n.query,t,Cn.ExistenceFilterMismatch,n.sequenceNumber);e.sendWatchRequest(r)}}),this.syncEngine.applyRemoteEvent(n)},t.prototype.handleTargetError=function(t){var e=this;v(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(t){r=r.then(function(){return s.__awaiter(e,void 0,void 0,function(){return s.__generator(this,function(e){return C(this.listenTargets,t)?(delete this.listenTargets[t],this.watchChangeAggregator.removeTarget(t),[2,this.syncEngine.rejectListen(t,n)]):[2]})})})}),r},t.prototype.fillWritePipeline=function(){return s.__awaiter(this,void 0,void 0,function(){var t;return s.__generator(this,function(e){switch(e.label){case 0:return this.canAddToWritePipeline()?[4,this.localStore.nextMutationBatch(this.writePipeline.length>0?this.writePipeline[this.writePipeline.length-1].batchId:-1)]:[3,4];case 1:return null!==(t=e.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(t),[4,this.fillWritePipeline()];case 3:e.sent(),e.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}})})},t.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},t.prototype.outstandingWrites=function(){return this.writePipeline.length},t.prototype.addToWritePipeline=function(t){v(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(t),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&this.writePipeline.length>0},t.prototype.startWriteStream=function(){v(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},t.prototype.onWriteStreamOpen=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){return this.writeStream.writeHandshake(),[2]})})},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var e=0,n=t.writePipeline;e<n.length;e++)t.writeStream.writeMutations(n[e].mutations)}).catch(Bn)},t.prototype.onMutationResult=function(t,e){var n=this;v(this.writePipeline.length>0,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=jt.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},t.prototype.onWriteStreamClose=function(t){return s.__awaiter(this,void 0,void 0,function(){var e=this;return s.__generator(this,function(n){return void 0===t&&v(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),t&&this.writePipeline.length>0?[2,(this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t)).then(function(){e.shouldStartWriteStream()&&e.startWriteStream()})]:[2]})})},t.prototype.handleHandshakeError=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){return wr(t.code)?(p(Br,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=b(),[2,this.localStore.setLastStreamToken(b()).catch(Bn)]):[2]})})},t.prototype.handleWriteError=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n=this;return s.__generator(this,function(r){return wr(i=t.code)&&i!==w.ABORTED?(e=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(e.batchId,t).then(function(){return n.fillWritePipeline()})]):[2];var i})})},t.prototype.createTransaction=function(){return new gr(this.datastore)},t.prototype.restartNetwork=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(yr.Unknown),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},t.prototype.handleCredentialChange=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.canUseNetwork()?(p(Br,"RemoteStore restarting streams for new credential"),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.applyPrimaryState=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,4];case 2:return t?[3,4]:[4,this.disableNetworkInternal()];case 3:e.sent(),this.onlineStateTracker.set(yr.Unknown),e.label=4;case 4:return[2]}})})},t}(),qr=function(){function t(t,e){if(D("GeoPoint",arguments,2),O("GeoPoint","number",1,t),O("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new E(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new E(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return K(this._lat,t._lat)||K(this._long,t._long)},t}(),jr=function(){function t(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)this.memoizedOrderBy=t.isKeyField()?[ti]:[new Jr(t),ti];else{v(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}n||this.memoizedOrderBy.push((this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:Zr.ASCENDING)===Zr.ASCENDING?ti:ei)}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){v(null==this.getInequalityFilterField()||!(e instanceof Hr)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),v(!this.isDocumentQuery(),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){v(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.withLimit=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,e)},t.prototype.asCollectionQueryAtPath=function(e){return new t(e,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();this.isCollectionGroupQuery()&&(t+="|cg:"+this.collectionGroup),t+="|f:";for(var e=0,n=this.filters;e<n.length;e++)t+=n[e].canonicalId(),t+=",";t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++)t+=i[r].canonicalId(),t+=",";or(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t="Query("+this.path.canonicalString();return this.isCollectionGroupQuery()&&(t+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),or(this.limit)||(t+=", limit: "+this.limit),this.explicitOrderBy.length>0&&(t+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.isKeyField()}return v(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesPathAndCollectionGroup(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimit=function(){return!or(this.limit)},t.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Hr&&n.isInequality())return n.field}return null},t.prototype.findFilterOperator=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof Hr&&t.indexOf(r.op)>=0)return r.op}return null},t.prototype.isDocumentQuery=function(){return ut.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},t.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},t.prototype.matchesPathAndCollectionGroup=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(e):ut.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isImmediateParentOf(e)},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&null===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t)||this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){v(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),zr=function(){return function(){}}(),Qr=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;case"in":return t.IN;case"array-contains-any":return t.ARRAY_CONTAINS_ANY;default:return y("Unknown FieldFilter operator: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t.ARRAY_CONTAINS=new t("array-contains"),t.IN=new t("in"),t.ARRAY_CONTAINS_ANY=new t("array-contains-any"),t}(),Hr=function(t){function e(e,n,r){var i=t.call(this)||this;return i.field=e,i.op=n,i.value=r,i}return s.__extends(e,t),e.create=function(t,n,r){if(t.isKeyField())return n===Qr.IN?(v(r instanceof Ue,"Comparing on key with IN, but filter value not an ArrayValue"),v(r.internalValue.every(function(t){return t instanceof Fe}),"Comparing on key with IN, but an array value was not a RefValue"),new Gr(t,r)):(v(r instanceof Fe,"Comparing on key, but filter value not a RefValue"),v(n!==Qr.ARRAY_CONTAINS&&n!==Qr.ARRAY_CONTAINS_ANY,"'"+n.toString()+"' queries don't make sense on document keys."),new Wr(t,n,r));if(r.isEqual(xe.INSTANCE)){if(n!==Qr.EQUAL)throw new E(w.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new e(t,n,r)}if(r.isEqual(Re.NAN)){if(n!==Qr.EQUAL)throw new E(w.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new e(t,n,r)}return n===Qr.ARRAY_CONTAINS?new Kr(t,r):n===Qr.IN?(v(r instanceof Ue,"IN filter has invalid value: "+r.toString()),new $r(t,r)):n===Qr.ARRAY_CONTAINS_ANY?(v(r instanceof Ue,"ARRAY_CONTAINS_ANY filter has invalid value: "+r.toString()),new Yr(t,r)):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&this.value.typeOrder===e.typeOrder&&this.matchesComparison(e.compareTo(this.value))},e.prototype.matchesComparison=function(t){switch(this.op){case Qr.LESS_THAN:return t<0;case Qr.LESS_THAN_OR_EQUAL:return t<=0;case Qr.EQUAL:return 0===t;case Qr.GREATER_THAN:return t>0;case Qr.GREATER_THAN_OR_EQUAL:return t>=0;default:return y("Unknown FieldFilter operator: "+this.op)}},e.prototype.isInequality=function(){return[Qr.LESS_THAN,Qr.LESS_THAN_OR_EQUAL,Qr.GREATER_THAN,Qr.GREATER_THAN_OR_EQUAL].indexOf(this.op)>=0},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},e.prototype.isEqual=function(t){return t instanceof e&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value)},e.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},e}(zr),Wr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.matches=function(t){var e=ut.comparator(t.key,this.value.key);return this.matchesComparison(e)},e}(Hr),Gr=function(t){function e(e,n){var r=t.call(this,e,Qr.IN,n)||this;return r.value=n,r}return s.__extends(e,t),e.prototype.matches=function(t){return this.value.internalValue.some(function(e){return t.key.isEqual(e.key)})},e}(Hr),Kr=function(t){function e(e,n){return t.call(this,e,Qr.ARRAY_CONTAINS,n)||this}return s.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return e instanceof Ue&&e.contains(this.value)},e}(Hr),$r=function(t){function e(e,n){var r=t.call(this,e,Qr.IN,n)||this;return r.value=n,r}return s.__extends(e,t),e.prototype.matches=function(t){var e=this.value,n=t.field(this.field);return null!==n&&e.contains(n)},e}(Hr),Yr=function(t){function e(e,n){var r=t.call(this,e,Qr.ARRAY_CONTAINS_ANY,n)||this;return r.value=n,r}return s.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return n instanceof Ue&&n.internalValue.some(function(t){return e.value.contains(t)})},e}(Hr),Zr=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),Xr=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++)t+=n[e].toString();return t},t.prototype.sortsBeforeDocument=function(t,e){v(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())v(o instanceof Fe,"Bound has a non-key value where the key path is being used."),n=ut.comparator(o.key,e.key);else{var s=e.field(i.field);v(null!==s,"Field should exist since document matched the orderBy already."),n=o.compareTo(s)}if(i.dir===Zr.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!this.position[e].isEqual(t.position[e]))return!1;return!0},t}(),Jr=function(){function t(t,e){this.field=t,void 0===e&&(e=Zr.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?je.compareByKey(t,e):je.compareByField(this.field,t,e);switch(this.dir){case Zr.ASCENDING:return n;case Zr.DESCENDING:return-1*n;default:return y("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),ti=new Jr(lt.keyField(),Zr.ASCENDING),ei=new Jr(lt.keyField(),Zr.DESCENDING),ni=function(){function t(){}return t.prototype.applyToLocalView=function(t,e){return new Me(e,t)},t.prototype.applyToRemoteDocument=function(t,e){return e},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),ri=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=si(t),n=function(t){e.find(function(e){return e.isEqual(t)})||e.push(t)},r=0,i=this.elements;r<i.length;r++)n(i[r]);return new Ue(e)},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&$(e.elements,this.elements)},t}(),ii=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=si(t),n=function(t){e=e.filter(function(e){return!e.isEqual(t)})},r=0,i=this.elements;r<i.length;r++)n(i[r]);return new Ue(e)},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&$(e.elements,this.elements)},t}(),oi=function(){function t(t){this.operand=t}return t.prototype.applyToLocalView=function(t,e){var n=this.computeBaseValue(t);return n instanceof Ne&&this.operand instanceof Ne?new Ne(n.internalValue+this.operand.internalValue):new Re(n.internalValue+this.operand.internalValue)},t.prototype.applyToRemoteDocument=function(t,e){return v(null!==e,"Didn't receive transformResult for NUMERIC_ADD transform"),e},t.prototype.computeBaseValue=function(t){return t instanceof ke?t:new Ne(0)},t.prototype.isEqual=function(e){return e instanceof t&&this.operand.isEqual(e.operand)},t}();function si(t){return t instanceof Ue?t.internalValue.slice():[]}var ai,li,ui=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}(),ci=((ai={})[Zr.ASCENDING.name]="ASCENDING",ai[Zr.DESCENDING.name]="DESCENDING",ai),hi=((li={})[Qr.LESS_THAN.name]="LESS_THAN",li[Qr.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",li[Qr.GREATER_THAN.name]="GREATER_THAN",li[Qr.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",li[Qr.EQUAL.name]="EQUAL",li[Qr.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",li[Qr.IN.name]="IN",li[Qr.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",li),di=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fi(t,e){v(!or(t),e+" is missing")}function pi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):y("can't parse "+t)}var mi=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?w.UNKNOWN:Er(t.code);return new E(e,t.message||"")},t.prototype.toInt32Value=function(t){return or(t)?void 0:{value:t}},t.prototype.fromInt32Value=function(t){var e;return or(e="object"==typeof t?t.value:t)?null:e},t.prototype.toTimestamp=function(t){return{seconds:""+t.seconds,nanos:t.nanoseconds}},t.prototype.fromTimestamp=function(t){if("string"==typeof t)return this.fromIso8601String(t);v(!!t,"Cannot deserialize null or undefined timestamp.");var e=pi(t.seconds||"0");return new Et(e,t.nanos||0)},t.prototype.fromIso8601String=function(t){var e=0,n=di.exec(t);if(v(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new Et(o,e)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"==typeof t?(v(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),J.fromBase64String(t)):(v(!this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),J.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return v(!!t,"Trying to deserialize version that isn't set"),St.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=st.fromString(t);return v(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return v(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),v(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new ut(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?st.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){return new st(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new st(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return v(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof xe)return{nullValue:"NULL_VALUE"};if(t instanceof Ae)return{booleanValue:t.value()};if(t instanceof Ne)return{integerValue:""+t.value()};if(t instanceof Re){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof Oe?{stringValue:t.value()}:t instanceof Be?{mapValue:this.toMapValue(t)}:t instanceof Ue?{arrayValue:this.toArrayValue(t)}:t instanceof Pe?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof Ve?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof Le?{bytesValue:this.toBytes(t.value())}:t instanceof Fe?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:y("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this;if("nullValue"in t)return xe.INSTANCE;if("booleanValue"in t)return Ae.of(t.booleanValue);if("integerValue"in t)return new Ne(pi(t.integerValue));if("doubleValue"in t){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return Re.NAN;if("Infinity"===t.doubleValue)return Re.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return Re.NEGATIVE_INFINITY}return new Re(t.doubleValue)}if("stringValue"in t)return new Oe(t.stringValue);if("mapValue"in t)return this.fromFields(t.mapValue.fields||{});if("arrayValue"in t)return fi(t.arrayValue,"arrayValue"),new Ue((t.arrayValue.values||[]).map(function(t){return e.fromValue(t)}));if("timestampValue"in t)return fi(t.timestampValue,"timestampValue"),new Pe(this.fromTimestamp(t.timestampValue));if("geoPointValue"in t)return fi(t.geoPointValue,"geoPointValue"),new Ve(new qr(t.geoPointValue.latitude||0,t.geoPointValue.longitude||0));if("bytesValue"in t){fi(t.bytesValue,"bytesValue");var n=this.fromBlob(t.bytesValue);return new Le(n)}if("referenceValue"in t){fi(t.referenceValue,"referenceValue");var r=this.fromResourceName(t.referenceValue),i=new rt(r.get(1),r.get(3)),o=new ut(this.extractLocalPathFromResourceName(r));return new Fe(i,o)}return y("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return v(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data()),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t,e){var n=this,r=this.fromName(t.name),i=this.fromVersion(t.updateTime);return new je(r,i,{hasCommittedMutations:!!e},void 0,t,function(t){return n.fromValue(t)})},t.prototype.toFields=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.toValue(r)}),n},t.prototype.fromFields=function(t){var e=this,n=Be.EMPTY;return x(t,function(t,r){n=n.set(new lt([t]),e.fromValue(r))}),n},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.toValue(t))}),{values:n}},t.prototype.fromFound=function(t){var e=this;v(!!t.found,"Tried to deserialize a found document from a missing document."),fi(t.found.name,"doc.found.name"),fi(t.found.updateTime,"doc.found.updateTime");var n=this.fromName(t.found.name),r=this.fromVersion(t.found.updateTime);return new je(n,r,{},void 0,t.found,function(t){return e.fromValue(t)})},t.prototype.fromMissing=function(t){v(!!t.missing,"Tried to deserialize a missing document from a found document."),v(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new ze(e,n)},t.prototype.fromMaybeDocument=function(t){return"found"in t?this.fromFound(t):"missing"in t?this.fromMissing(t):y("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case Or.Added:return"ADD";case Or.Current:return"CURRENT";case Or.NoChange:return"NO_CHANGE";case Or.Removed:return"REMOVE";case Or.Reset:return"RESET";default:return y("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof Rr)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof Nr){var e;if(t.newDoc instanceof je)return{documentChange:{document:{name:this.toName((e=t.newDoc).key),fields:this.toFields(e.data()),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}};if(t.newDoc instanceof ze)return{documentDelete:{document:this.toName((e=t.newDoc).key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}};if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof Pr){var n=void 0;return t.cause&&(n={code:Sr(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return y("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e,n=this;if("targetChange"in t){fi(t.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=t.targetChange.resumeToken||this.emptyByteString(),s=t.targetChange.cause,a=s&&this.fromRpcStatus(s);e=new Pr(r,i,o,a||null)}else if("documentChange"in t){fi(t.documentChange,"documentChange"),fi(t.documentChange.document,"documentChange.name"),fi(t.documentChange.document.name,"documentChange.document.name"),fi(t.documentChange.document.updateTime,"documentChange.document.updateTime");var l=t.documentChange,u=this.fromName(l.document.name),c=this.fromVersion(l.document.updateTime),h=new je(u,c,{},void 0,l.document,function(t){return n.fromValue(t)});e=new Nr(l.targetIds||[],l.removedTargetIds||[],h.key,h)}else if("documentDelete"in t){fi(t.documentDelete,"documentDelete"),fi(t.documentDelete.document,"documentDelete.document");var d=t.documentDelete;u=this.fromName(d.document),c=d.readTime?this.fromVersion(d.readTime):St.forDeletedDoc(),h=new ze(u,c),e=new Nr([],d.removedTargetIds||[],h.key,h)}else if("documentRemove"in t){fi(t.documentRemove,"documentRemove"),fi(t.documentRemove.document,"documentRemove");var f=t.documentRemove;u=this.fromName(f.document),e=new Nr([],f.removedTargetIds||[],u,null)}else{if(!("filter"in t))return y("Unknown change type "+JSON.stringify(t));fi(t.filter,"filter"),fi(t.filter.targetId,"filter.targetId");var p=t.filter,m=new ui(p.count||0);e=new Rr(p.targetId,m)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?Or.NoChange:"ADD"===t?Or.Added:"REMOVE"===t?Or.Removed:"CURRENT"===t?Or.Current:"RESET"===t?Or.Reset:y("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){if(!("targetChange"in t))return St.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?St.MIN:e.readTime?this.fromVersion(e.readTime):St.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof _e)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof Ee)e={delete:this.toName(t.key)};else if(t instanceof be)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof we))return y("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.toFieldTransform(t)})}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):ye.NONE;if(t.update){fi(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new be(r,i,o,n)}return new _e(r,i,n)}if(t.delete)return r=this.fromName(t.delete),new Ee(r,n);if(t.transform){r=this.fromName(t.transform.document);var s=t.transform.fieldTransforms.map(function(t){return e.fromFieldTransform(t)});return v(!0===n.exists,'Transforms only support precondition "exists == true"'),new we(r,s)}return y("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return v(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:y("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?ye.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?ye.exists(t.exists):ye.NONE},t.prototype.fromWriteResult=function(t,e){var n=this,r=this.fromVersion(t.updateTime?t.updateTime:e),i=null;return t.transformResults&&t.transformResults.length>0&&(i=t.transformResults.map(function(t){return n.fromValue(t)})),new me(r,i)},t.prototype.fromWriteResults=function(t,e){var n=this;return t&&t.length>0?(v(void 0!==e,"Received a write result without a commit time"),t.map(function(t){return n.fromWriteResult(t,e)})):[]},t.prototype.toFieldTransform=function(t){var e=this,n=t.transform;if(n instanceof ni)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ri)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements.map(function(t){return e.toValue(t)})}};if(n instanceof ii)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements.map(function(t){return e.toValue(t)})}};if(n instanceof oi)return{fieldPath:t.field.canonicalString(),increment:this.toValue(n.operand)};throw y("Unknown transform: "+t.transform)},t.prototype.fromFieldTransform=function(t){var e=this,n=null;if("setToServerValue"in t)v("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),n=ni.instance;else if("appendMissingElements"in t)n=new ri((t.appendMissingElements.values||[]).map(function(t){return e.fromValue(t)}));else if("removeAllFromArray"in t)n=new ii((t.removeAllFromArray.values||[]).map(function(t){return e.fromValue(t)}));else if("increment"in t){var r=this.fromValue(t.increment);v(r instanceof ke,"NUMERIC_ADD transform requires a NumberValue"),n=new oi(r)}else y("Unknown transform proto: "+JSON.stringify(t));var i=lt.fromServerFormat(t.fieldPath);return new pe(i,n)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;return v(1===e,"DocumentsTarget contained other than 1 document: "+e),jr.atPath(this.fromQueryPath(t.documents[0]))},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(v(n.length%2==0,"Collection Group queries should be within a document path or root."),e.parent=this.toQueryPath(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(v(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]);var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return void 0!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){v(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.fromFilter(n.where));var a=[];n.orderBy&&(a=this.fromOrder(n.orderBy));var l=null;n.limit&&(l=this.fromInt32Value(n.limit));var u=null;n.startAt&&(u=this.fromCursor(n.startAt));var c=null;return n.endAt&&(c=this.fromCursor(n.endAt)),new jr(e,i,a,s,l,u,c)},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case Cn.Listen:return null;case Cn.ExistenceFilterMismatch:return"existence-filter-mismatch";case Cn.LimboResolution:return"limbo-document";default:return y("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.query;return(e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=t.targetId,t.resumeToken.length>0&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Hr?e.toUnaryOrFieldFilter(t):y("Unrecognized filter: "+JSON.stringify(t))});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromFieldFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.fromFilter(t)}).reduce(function(t,e){return t.concat(e)}):y("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.toPropertyOrder(t)})},t.prototype.fromOrder=function(t){var e=this;return t.map(function(t){return e.fromPropertyOrder(t)})},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.toValue(t)})}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map(function(t){return e.fromValue(t)});return new Xr(r,n)},t.prototype.toDirection=function(t){return ci[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return Zr.ASCENDING;case"DESCENDING":return Zr.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return hi[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return Qr.EQUAL;case"GREATER_THAN":return Qr.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Qr.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Qr.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Qr.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Qr.ARRAY_CONTAINS;case"IN":return Qr.IN;case"ARRAY_CONTAINS_ANY":return Qr.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return y("Unspecified operator");default:return y("Unknown operator")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return lt.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new Jr(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.fromFieldFilter=function(t){return Hr.create(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryOrFieldFilter=function(t){if(t.op===Qr.EQUAL){if(t.value.isEqual(Re.NAN))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}};if(t.value.isEqual(xe.INSTANCE))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return Hr.create(e,Qr.EQUAL,Re.NAN);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return Hr.create(n,Qr.EQUAL,xe.INSTANCE);case"OPERATOR_UNSPECIFIED":return y("Unspecified filter");default:return y("Unknown filter")}},t.prototype.toDocumentMask=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}},t.prototype.fromDocumentMask=function(t){var e=(t.fieldPaths||[]).map(function(t){return lt.fromServerFormat(t)});return fe.fromArray(e)},t}(),gi=function(){return function(){this.viewSnap=null,this.targetId=0,this.listeners=[]}}(),yi=function(){function t(t){this.syncEngine=t,this.queries=new He(function(t){return t.canonicalId()}),this.onlineState=yr.Unknown,this.syncEngine.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);return r||(n=!0,r=new gi,this.queries.set(e,r)),r.listeners.push(t),t.applyOnlineStateChange(this.onlineState),r.viewSnap&&t.onViewSnapshot(r.viewSnap),n?this.syncEngine.listen(e).then(function(t){return r.targetId=t,t}):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n,r,i;return s.__generator(this,function(o){return n=!1,(r=this.queries.get(e=t.query))&&(i=r.listeners.indexOf(t))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(e),[2,this.syncEngine.unlisten(e)]):[2]})})},t.prototype.onWatchChange=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],i=this.queries.get(r.query);if(i){for(var o=0,s=i.listeners;o<s.length;o++)s[o].onViewSnapshot(r);i.viewSnap=r}}},t.prototype.onWatchError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.queries.delete(t)},t.prototype.onOnlineStateChange=function(t){this.onlineState=t,this.queries.forEach(function(e,n){for(var r=0,i=n.listeners;r<i.length;r++)i[r].applyOnlineStateChange(t)})},t}(),vi=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.snap=null,this.onlineState=yr.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(v(t.docChanges.length>0||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==Tr.Metadata&&e.push(i)}t=new Ar(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}this.raisedInitialEvent?this.shouldRaiseEvent(t)&&this.queryObserver.next(t):this.shouldRaiseInitialEvent(t,this.onlineState)&&this.raiseInitialEvent(t),this.snap=t},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&this.raiseInitialEvent(this.snap)},t.prototype.shouldRaiseInitialEvent=function(t,e){return v(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache||(this.options.waitForSyncWhenOnline&&e!==yr.Offline?(v(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===yr.Offline)},t.prototype.shouldRaiseEvent=function(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.raiseInitialEvent=function(t){v(!this.raisedInitialEvent,"Trying to raise initial events for second time"),t=Ar.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(t)},t}(),_i=function(){function t(t,e,n){this.targetId=t,this.addedKeys=e,this.removedKeys=n}return t.fromSnapshot=function(e,n){for(var r=Vt(),i=Vt(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case Tr.Added:r=r.add(a.doc.key);break;case Tr.Removed:i=i.add(a.doc.key)}}return new t(e,r,i)},t}(),bi=function(){return function(t){this.key=t}}(),wi=function(){return function(t){this.key=t}}(),Ei=function(){function t(t,e){this.query=t,this._syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=Vt(),this.mutatedKeys=Vt(),this.documentSet=new Cr(t.docComparator.bind(t))}return Object.defineProperty(t.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new xr,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,l=this.query.hasLimit()&&i.size===this.query.limit?i.last():null;if(t.inorderTraversal(function(t,e){var u=i.get(t),c=e instanceof je?e:null;c&&(v(t.isEqual(c.key),"Mismatching keys found in document changes: "+t+" != "+c.key),c=n.query.matches(c)?c:null);var h=!!u&&n.mutatedKeys.has(u.key),d=!!c&&(c.hasLocalMutations||n.mutatedKeys.has(c.key)&&c.hasCommittedMutations),f=!1;u&&c?u.data().isEqual(c.data())?h!==d&&(r.track({type:Tr.Metadata,doc:c}),f=!0):n.shouldWaitForSyncedDocument(u,c)||(r.track({type:Tr.Modified,doc:c}),f=!0,l&&n.query.docComparator(c,l)>0&&(a=!0)):!u&&c?(r.track({type:Tr.Added,doc:c}),f=!0):u&&!c&&(r.track({type:Tr.Removed,doc:u}),f=!0,l&&(a=!0)),f&&(c?(s=s.add(c),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),this.query.hasLimit())for(;s.size>this.query.limit;){var u=s.last();s=s.delete(u.key),o=o.delete(u.key),r.track({type:Tr.Removed,doc:u})}return v(!a||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:s,changeSet:r,needsRefill:a,mutatedKeys:o}},t.prototype.shouldWaitForSyncedDocument=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this;v(!t.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var o=t.changeSet.getChanges();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case Tr.Added:return 1;case Tr.Modified:case Tr.Metadata:return 2;case Tr.Removed:return 0;default:return y("Unknown ChangeType: "+t)}};return n(t)-n(e)}(t.type,e.type)||r.query.docComparator(t.doc,e.doc)}),this.applyTargetChange(n);var s=e?this.updateLimboDocuments():[],a=0===this.limboDocuments.size&&this.current?Ir.Synced:Ir.Local,l=a!==this.syncState;return this.syncState=a,0!==o.length||l?{snapshot:new Ar(this.query,t.documentSet,i,o,t.mutatedKeys,a===Ir.Local,l,!1),limboChanges:s}:{limboChanges:s}},t.prototype.applyOnlineStateChange=function(t){return this.current&&t===yr.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new xr,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},t.prototype.shouldBeInLimbo=function(t){return!this._syncedDocuments.has(t)&&!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations},t.prototype.applyTargetChange=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.add(t)}),t.modifiedDocuments.forEach(function(t){return v(e._syncedDocuments.has(t),"Modified document "+t+" not found in view.")}),t.removedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.delete(t)}),this.current=t.current)},t.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=Vt(),this.documentSet.forEach(function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))});var n=[];return e.forEach(function(e){t.limboDocuments.has(e)||n.push(new wi(e))}),this.limboDocuments.forEach(function(t){e.has(t)||n.push(new bi(t))}),n},t.prototype.synchronizeWithPersistedState=function(t,e){this._syncedDocuments=e,this.limboDocuments=Vt();var n=this.computeDocChanges(t);return this.applyChanges(n,!0)},t.prototype.computeInitialSnapshot=function(){return Ar.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===Ir.Local)},t}(),Si=5,Ci=function(){function t(t,e,n,r){this.asyncQueue=t,this.remoteStore=e,this.updateFunction=n,this.deferred=r,this.retries=Si,this.backoff=new cr(this.asyncQueue,ht.RetryTransaction)}return t.prototype.run=function(){this.runWithBackOff()},t.prototype.runWithBackOff=function(){var t=this;this.backoff.backoffAndRun(function(){return s.__awaiter(t,void 0,void 0,function(){var t,e,n=this;return s.__generator(this,function(r){return t=this.remoteStore.createTransaction(),(e=this.tryRunUpdateFunction(t))&&e.then(function(e){n.asyncQueue.enqueueAndForget(function(){return t.commit().then(function(){n.deferred.resolve(e)}).catch(function(t){n.handleTransactionError(t)})})}).catch(function(t){n.handleTransactionError(t)}),[2]})})})},t.prototype.tryRunUpdateFunction=function(t){try{var e=this.updateFunction(t);return!or(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(m){return this.deferred.reject(m),null}},t.prototype.handleTransactionError=function(t){var e=this;this.retries>0&&this.isRetryableTransactionError(t)?(this.retries-=1,this.asyncQueue.enqueueAndForget(function(){return e.runWithBackOff(),Promise.resolve()})):this.deferred.reject(t)},t.prototype.isRetryableTransactionError=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!wr(e)}return!1},t}(),Ti=function(){return function(t,e,n){this.query=t,this.targetId=e,this.view=n}}(),Ii=function(){return function(t){this.key=t,this.receivedDocument=!1}}(),xi=function(){function t(t,e,n,r){this.localStore=t,this.remoteStore=e,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new He(function(t){return t.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new Ct(ut.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new Hn,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=Jt.forSyncEngine(),this.isPrimary=void 0,this.onlineState=yr.Unknown}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){v(null!==t,"SyncEngine listener cannot be null"),v(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=t},t.prototype.listen=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o;return s.__generator(this,function(s){switch(s.label){case 0:return this.assertSubscribed("listen()"),(r=this.queryViewsByQuery.get(t))?(this.sharedClientState.addLocalQueryTarget(e=r.targetId),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateQuery(t)];case 2:return i=s.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),e=i.targetId,[4,this.initializeViewAndComputeSnapshot(i,"current"===o)];case 3:n=s.sent(),this.isPrimary&&this.remoteStore.listen(i),s.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,e]}})})},t.prototype.initializeViewAndComputeSnapshot=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n,r,i,o,a,l,u,c;return s.__generator(this,function(s){switch(s.label){case 0:return[4,this.localStore.executeQuery(n=t.query)];case 1:return r=s.sent(),[4,this.localStore.remoteDocumentKeys(t.targetId)];case 2:return i=s.sent(),o=new Ei(n,i),a=o.computeDocChanges(r),l=Dr.createSynthesizedTargetChangeForCurrentChange(t.targetId,e&&this.onlineState!==yr.Offline),v(0===(u=o.applyChanges(a,!0===this.isPrimary,l)).limboChanges.length,"View returned limbo docs before target ack from the server."),v(!!u.snapshot,"applyChanges for new view should always return a snapshot"),c=new Ti(n,t.targetId,o),this.queryViewsByQuery.set(n,c),this.queryViewsByTarget[t.targetId]=c,[2,u.snapshot]}})})},t.prototype.synchronizeViewAndComputeSnapshot=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n,r;return s.__generator(this,function(i){switch(i.label){case 0:return[4,this.localStore.executeQuery(t.query)];case 1:return e=i.sent(),[4,this.localStore.remoteDocumentKeys(t.targetId)];case 2:return n=i.sent(),r=t.view.synchronizeWithPersistedState(e,n),this.isPrimary&&this.updateTrackedLimbos(t.targetId,r.limboChanges),[2,r]}})})},t.prototype.unlisten=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n=this;return s.__generator(this,function(r){switch(r.label){case 0:return this.assertSubscribed("unlisten()"),v(!!(e=this.queryViewsByQuery.get(t)),"Trying to unlisten on query not found:"+t),this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(e.targetId),this.sharedClientState.isActiveQueryTarget(e.targetId)?[3,2]:[4,this.localStore.releaseQuery(t,!1).then(function(){n.sharedClientState.clearQueryState(e.targetId),n.remoteStore.unlisten(e.targetId),n.removeAndCleanupQuery(e)}).catch(Bn)]):[3,3];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupQuery(e),[4,this.localStore.releaseQuery(t,!0)];case 4:r.sent(),r.label=5;case 5:return[2]}})})},t.prototype.write=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n;return s.__generator(this,function(r){switch(r.label){case 0:return this.assertSubscribed("write()"),[4,this.localStore.localWrite(t)];case 1:return n=r.sent(),this.sharedClientState.addPendingMutation(n.batchId),this.addMutationCallback(n.batchId,e),[4,this.emitNewSnapsAndNotifyLocalStore(n.changes)];case 2:return r.sent(),[4,this.remoteStore.fillWritePipeline()];case 3:return r.sent(),[2]}})})},t.prototype.runTransaction=function(t,e,n){new Ci(t,this.remoteStore,e,n).run()},t.prototype.applyRemoteEvent=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n=this;return s.__generator(this,function(r){switch(r.label){case 0:this.assertSubscribed("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.applyRemoteEvent(t)];case 2:return e=r.sent(),x(t.targetChanges,function(t,e){var r=n.limboResolutionsByTarget[Number(t)];r&&(v(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),e.addedDocuments.size>0?r.receivedDocument=!0:e.modifiedDocuments.size>0?v(r.receivedDocument,"Received change for limbo target document without add."):e.removedDocuments.size>0&&(v(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))}),[4,this.emitNewSnapsAndNotifyLocalStore(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,Bn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype.applyOnlineStateChange=function(t,e){if(this.isPrimary&&e===vr.RemoteStore||!this.isPrimary&&e===vr.SharedClientState){this.assertSubscribed("applyOnlineStateChange()");var n=[];this.queryViewsByQuery.forEach(function(e,r){var i=r.view.applyOnlineStateChange(t);v(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)}),this.syncEngineListener.onOnlineStateChange(t),this.syncEngineListener.onWatchChange(n),this.onlineState=t,this.isPrimary&&this.sharedClientState.setOnlineState(t)}},t.prototype.rejectListen=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n,r,i,o,a,l,u=this;return s.__generator(this,function(s){switch(s.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(t,"rejected",e),(r=(n=this.limboResolutionsByTarget[t])&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[t],i=(i=new Ct(ut.comparator)).insert(r,new ze(r,St.forDeletedDoc())),o=Vt().add(r),a=new kr(St.MIN,{},new At(K),i,o),[2,this.applyRemoteEvent(a)]):[3,1];case 1:return v(!!(l=this.queryViewsByTarget[t]),"Unknown targetId: "+t),[4,this.localStore.releaseQuery(l.query,!1).then(function(){return u.removeAndCleanupQuery(l)}).catch(Bn)];case 2:s.sent(),this.syncEngineListener.onWatchError(l.query,e),s.label=3;case 3:return[2]}})})},t.prototype.applyBatchState=function(t,e,n){return s.__awaiter(this,void 0,void 0,function(){var r;return s.__generator(this,function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(t)];case 1:return null===(r=i.sent())?(p("SyncEngine","Cannot apply mutation batch with id: "+t),[2]):"pending"!==e?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.processUserCallback(t,n||null),this.localStore.removeCachedMutationBatchMetadata(t)):y("Unknown batchState: "+e),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}})})},t.prototype.applySuccessfulWrite=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n;return s.__generator(this,function(r){switch(r.label){case 0:this.assertSubscribed("applySuccessfulWrite()"),this.processUserCallback(e=t.batch.batchId,null),this.triggerPendingWritesCallbacks(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.acknowledgeBatch(t)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(e,"acknowledged"),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,Bn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype.rejectFailedWrite=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n;return s.__generator(this,function(r){switch(r.label){case 0:this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.triggerPendingWritesCallbacks(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.rejectBatch(t)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(t,"rejected",e),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,Bn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype.registerPendingWritesCallback=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n;return s.__generator(this,function(r){switch(r.label){case 0:return this.remoteStore.canUseNetwork()||p("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.localStore.getHighestUnacknowledgedBatchId()];case 1:return-1===(e=r.sent())?(t.resolve(),[2]):((n=this.pendingWritesCallbacks.get(e)||[]).push(t),this.pendingWritesCallbacks.set(e,n),[2])}})})},t.prototype.triggerPendingWritesCallbacks=function(t){(this.pendingWritesCallbacks.get(t)||[]).forEach(function(t){t.resolve()}),this.pendingWritesCallbacks.delete(t)},t.prototype.rejectOutstandingPendingWritesCallbacks=function(t){this.pendingWritesCallbacks.forEach(function(e){e.forEach(function(e){e.reject(new E(w.CANCELLED,t))})}),this.pendingWritesCallbacks.clear()},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new Ct(K)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(v(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupQuery=function(t){var e=this;if(this.sharedClientState.removeLocalQueryTarget(t.targetId),this.queryViewsByQuery.delete(t.query),delete this.queryViewsByTarget[t.targetId],this.isPrimary){var n=this.limboDocumentRefs.referencesForId(t.targetId);this.limboDocumentRefs.removeReferencesForId(t.targetId),n.forEach(function(t){e.limboDocumentRefs.containsKey(t)||e.removeLimboTarget(t)})}},t.prototype.removeLimboTarget=function(t){var e=this.limboTargetsByKey.get(t);null!==e&&(this.remoteStore.unlisten(e),this.limboTargetsByKey=this.limboTargetsByKey.remove(t),delete this.limboResolutionsByTarget[e])},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof bi?(this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i)):i instanceof wi?(p("SyncEngine","Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t),this.limboDocumentRefs.containsKey(i.key)||this.removeLimboTarget(i.key)):y("Unknown limbo change: "+JSON.stringify(i))}},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){p("SyncEngine","New document in limbo: "+e);var n=this.limboTargetIdGenerator.next(),r=jr.atPath(e.path);this.limboResolutionsByTarget[n]=new Ii(e),this.remoteStore.listen(new Tn(r,n,Cn.LimboResolution,it.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n,r,i,o=this;return s.__generator(this,function(s){switch(s.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach(function(s,a){i.push(Promise.resolve().then(function(){var e=a.view.computeDocChanges(t);return e.needsRefill?o.localStore.executeQuery(a.query).then(function(t){return a.view.computeDocChanges(t,e)}):e}).then(function(t){var i=a.view.applyChanges(t,!0===o.isPrimary,e&&e.targetChanges[a.targetId]);if(o.updateTrackedLimbos(a.targetId,i.limboChanges),i.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(a.targetId,i.snapshot.fromCache?"not-current":"current"),n.push(i.snapshot);var s=_i.fromSnapshot(a.targetId,i.snapshot);r.push(s)}}))}),[4,Promise.all(i)];case 1:return s.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return s.sent(),[2]}})})},t.prototype.assertSubscribed=function(t){v(null!==this.syncEngineListener,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleCredentialChange=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n;return s.__generator(this,function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?(this.rejectOutstandingPendingWritesCallbacks("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.localStore.handleUserChange(t)]):[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}})})},t.prototype.applyPrimaryState=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o,a,l=this;return s.__generator(this,function(s){switch(s.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return s.sent(),e=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e.toArray())];case 2:for(n=s.sent(),r=0,i=n;r<i.length;r++)this.remoteStore.listen(i[r]);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,o=[],a=Promise.resolve(),I(this.queryViewsByTarget,function(t,e){l.sharedClientState.isLocalQueryTarget(t)?o.push(t):a=a.then(function(){return l.unlisten(e.query)}),l.remoteStore.unlisten(e.targetId)}),[4,a]);case 4:return s.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(o)];case 5:return s.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:s.sent(),s.label=7;case 7:return[2]}})})},t.prototype.resetLimboDocuments=function(){var t=this;I(this.limboResolutionsByTarget,function(e){t.remoteStore.unlisten(e)}),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new Ct(ut.comparator)},t.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o,a,l,u,c;return s.__generator(this,function(s){switch(s.label){case 0:e=[],n=[],r=0,i=t,s.label=1;case 1:return r<i.length?(a=void 0,(l=this.queryViewsByTarget[o=i[r]])?[4,this.localStore.releaseQuery(l.query,!0)]:[3,5]):[3,11];case 2:return s.sent(),[4,this.localStore.allocateQuery(l.query)];case 3:return a=s.sent(),[4,this.synchronizeViewAndComputeSnapshot(l)];case 4:return(u=s.sent()).snapshot&&n.push(u.snapshot),[3,9];case 5:return v(!0===this.isPrimary,"A secondary tab should never have an active query without an active view."),[4,this.localStore.getQueryForTarget(o)];case 6:return v(!!(c=s.sent()),"Query data for target "+o+" not found"),[4,this.localStore.allocateQuery(c)];case 7:return a=s.sent(),[4,this.initializeViewAndComputeSnapshot(a,!1)];case 8:s.sent(),s.label=9;case 9:e.push(a),s.label=10;case 10:return r++,[3,1];case 11:return this.syncEngineListener.onWatchChange(n),[2,e]}})})},t.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},t.prototype.applyTargetState=function(t,e,n){return s.__awaiter(this,void 0,void 0,function(){var r,i,o,a,l;return s.__generator(this,function(s){switch(s.label){case 0:if(this.isPrimary)return p("SyncEngine","Ignoring unexpected query state notification."),[2];if(!this.queryViewsByTarget[t])return[3,11];switch(e){case"current":case"not-current":return[3,1];case"rejected":return[3,8]}return[3,10];case 1:return s.trys.push([1,4,,8]),[4,this.localStore.getNewDocumentChanges()];case 2:return r=s.sent(),i=kr.createSynthesizedRemoteEventForCurrentChange(t,"current"===e),[4,this.emitNewSnapsAndNotifyLocalStore(r,i)];case 3:return s.sent(),[3,11];case 4:return(u=o=s.sent()).code!==w.DATA_LOSS||u.message!==Ge?[3,6]:(a=[],I(this.queryViewsByTarget,function(t){return a.push(t)}),[4,this.synchronizeQueryViewsAndRaiseSnapshots(a)]);case 5:return s.sent(),[3,7];case 6:throw o;case 7:return[3,8];case 8:return this.removeAndCleanupQuery(l=this.queryViewsByTarget[t]),[4,this.localStore.releaseQuery(l.query,!0)];case 9:return s.sent(),this.syncEngineListener.onWatchError(l.query,n),[3,11];case 10:y("Unexpected target state: "+e),s.label=11;case 11:return[2]}var u})})},t.prototype.applyActiveTargetsChange=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n,r,i,o,a,l,u,c,h,d=this;return s.__generator(this,function(f){switch(f.label){case 0:if(!this.isPrimary)return[2];n=0,r=t,f.label=1;case 1:return n<r.length?(v(!this.queryViewsByTarget[h=r[n]],"Trying to add an already active target"),[4,this.localStore.getQueryForTarget(h)]):[3,6];case 2:return v(!!(i=f.sent()),"Query data for active target "+h+" not found"),[4,this.localStore.allocateQuery(i)];case 3:return o=f.sent(),[4,this.initializeViewAndComputeSnapshot(o,!1)];case 4:f.sent(),this.remoteStore.listen(o),f.label=5;case 5:return n++,[3,1];case 6:a=function(t){var e;return s.__generator(this,function(n){switch(n.label){case 0:return(e=l.queryViewsByTarget[t])?[4,l.localStore.releaseQuery(e.query,!1).then(function(){d.remoteStore.unlisten(t),d.removeAndCleanupQuery(e)}).catch(Bn)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})},l=this,u=0,c=e,f.label=7;case 7:return u<c.length?[5,a(h=c[u])]:[3,10];case 8:f.sent(),f.label=9;case 9:return u++,[3,7];case 10:return[2]}})})},t.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},t.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},t.prototype.getRemoteKeysForTarget=function(t){var e=this.limboResolutionsByTarget[t];return e&&e.receivedDocument?Vt().add(e.key):this.queryViewsByTarget[t]?this.queryViewsByTarget[t].view.syncedDocuments:Vt()},t}(),Ai=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),ki="SharedClientState",Di="firestore_clients",Ni="firestore_mutations",Ri="firestore_targets",Oi="firestore_online_state",Pi="firestore_sequence_number",Mi=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r,v(void 0!==r==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new E(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(m(ki,"Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Li=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n,v(void 0!==n==("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new E(r.error.code,r.error.message)),i?new t(e,r.state,o):(m(ki,"Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Fi=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.fromWebStorageEntry=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Ut(),s=0;i&&s<r.activeTargetIds.length;++s)i=sr(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(m(ki,"Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Vi=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.fromWebStorageEntry=function(e){var n=JSON.parse(e);return"object"==typeof n&&n.onlineState in yr&&"string"==typeof n.clientId?new t(n.clientId,yr[n.onlineState]):(m(ki,"Failed to parse online state: "+e),null)},t}(),Bi=function(){function t(){this.activeTargetIds=Ut()}return t.prototype.addQueryTarget=function(t){v(!this.activeTargetIds.has(t),"Target with ID '"+t+"' already active."),this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.removeQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.toWebStorageJSON=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Ui=function(){function t(e,n,r,i,o){if(this.queue=e,this.platform=n,this.persistenceKey=r,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!t.isAvailable(this.platform))throw new E(w.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey=Pi+"_"+r,this.activeClients[this.localClientId]=new Bi,this.clientStateKeyRe=new RegExp("^"+Di+"_"+s+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+Ni+"_"+s+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+Ri+"_"+s+"_(\\d+)$"),this.onlineStateKey=Oi+"_"+r,this.platform.window.addEventListener("storage",this.storageListener)}return t.isAvailable=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return s.__awaiter(this,void 0,void 0,function(){var t,e,n,r,i,o,a,l,u,c,h=this;return s.__generator(this,function(s){switch(s.label){case 0:return v(!this.started,"WebStorageSharedClientState already started"),v(null!==this.syncEngine,"syncEngine property must be set before calling start()"),v(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(t=s.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.localClientId&&(i=this.getItem(this.toWebStorageClientStateKey(r)))&&(o=Fi.fromWebStorageEntry(r,i))&&(this.activeClients[o.clientId]=o);for(this.persistClientState(),(a=this.storage.getItem(this.onlineStateKey))&&(l=this.fromWebStorageOnlineState(a))&&this.handleOnlineStateEvent(l),u=0,c=this.earlyEvents;u<c.length;u++)this.handleWebStorageEvent(c[u]);return this.earlyEvents=[],this.platform.window.addEventListener("unload",function(){return h.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.sequenceNumberKey,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){var t=Ut();return x(this.activeClients,function(e,n){t=t.unionWith(n.activeTargetIds)}),t},t.prototype.isActiveQueryTarget=function(t){for(var e in this.activeClients)if(this.activeClients.hasOwnProperty(e)&&this.activeClients[e].activeTargetIds.has(t))return!0;return!1},t.prototype.addPendingMutation=function(t){this.persistMutationState(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.persistMutationState(t,e,n),this.removeMutationState(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(t));if(n){var r=Li.fromWebStorageEntry(t,n);r&&(e=r.state)}}return this.localClientState.addQueryTarget(t),this.persistClientState(),e},t.prototype.removeLocalQueryTarget=function(t){this.localClientState.removeQueryTarget(t),this.persistClientState()},t.prototype.isLocalQueryTarget=function(t){return this.localClientState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(this.toWebStorageQueryTargetMetadataKey(t))},t.prototype.updateQueryState=function(t,e,n){this.persistQueryTargetState(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.removeMutationState(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.persistOnlineState(t)},t.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return p(ki,"READ",t,e),e},t.prototype.setItem=function(t,e){p(ki,"SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){p(ki,"REMOVE",t),this.storage.removeItem(t)},t.prototype.handleWebStorageEvent=function(t){var e=this;if(t.storageArea===this.storage){if(p(ki,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey)return void m("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget(function(){return s.__awaiter(e,void 0,void 0,function(){var e,n,r,i,o,a;return s.__generator(this,function(s){if(!this.started)return this.earlyEvents.push(t),[2];if(null===t.key)return[2];if(this.clientStateKeyRe.test(t.key)){if(null==t.newValue)return n=this.fromWebStorageClientStateKey(t.key),[2,this.handleClientStateEvent(n,null)];if(e=this.fromWebStorageClientState(t.key,t.newValue))return[2,this.handleClientStateEvent(e.clientId,e)]}else if(this.mutationBatchKeyRe.test(t.key)){if(null!==t.newValue&&(r=this.fromWebStorageMutationMetadata(t.key,t.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(t.key)){if(null!==t.newValue&&(i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(t.key===this.onlineStateKey){if(null!==t.newValue&&(o=this.fromWebStorageOnlineState(t.newValue)))return[2,this.handleOnlineStateEvent(o)]}else t.key===this.sequenceNumberKey&&(v(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(a=function(t){var e=it.INVALID;if(null!=t)try{var n=JSON.parse(t);v("number"==typeof n,"Found non-numeric sequence number"),e=n}catch(r){m(ki,"Failed to read sequence number from WebStorage",r)}return e}(t.newValue))!==it.INVALID&&this.sequenceNumberHandler(a));return[2]})})})}},Object.defineProperty(t.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),t.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},t.prototype.persistMutationState=function(t,e,n){var r=new Mi(this.currentUser,t,e,n),i=this.toWebStorageMutationBatchKey(t);this.setItem(i,r.toWebStorageJSON())},t.prototype.removeMutationState=function(t){var e=this.toWebStorageMutationBatchKey(t);this.removeItem(e)},t.prototype.persistOnlineState=function(t){this.storage.setItem(this.onlineStateKey,JSON.stringify({clientId:this.localClientId,onlineState:yr[t]}))},t.prototype.persistQueryTargetState=function(t,e,n){var r=this.toWebStorageQueryTargetMetadataKey(t),i=new Li(t,e,n);this.setItem(r,i.toWebStorageJSON())},t.prototype.toWebStorageClientStateKey=function(t){return v(-1===t.indexOf("_"),"Client key cannot contain '_', but was '"+t+"'"),Di+"_"+this.persistenceKey+"_"+t},t.prototype.toWebStorageQueryTargetMetadataKey=function(t){return Ri+"_"+this.persistenceKey+"_"+t},t.prototype.toWebStorageMutationBatchKey=function(t){var e=Ni+"_"+this.persistenceKey+"_"+t;return this.currentUser.isAuthenticated()&&(e+="_"+this.currentUser.uid),e},t.prototype.fromWebStorageClientStateKey=function(t){var e=this.clientStateKeyRe.exec(t);return e?e[1]:null},t.prototype.fromWebStorageClientState=function(t,e){var n=this.fromWebStorageClientStateKey(t);return v(null!==n,"Cannot parse client state key '"+t+"'"),Fi.fromWebStorageEntry(n,e)},t.prototype.fromWebStorageMutationMetadata=function(t,e){var n=this.mutationBatchKeyRe.exec(t);v(null!==n,"Cannot parse mutation batch key '"+t+"'");var r=Number(n[1]);return Mi.fromWebStorageEntry(new Ai(void 0!==n[2]?n[2]:null),r,e)},t.prototype.fromWebStorageQueryTargetMetadata=function(t,e){var n=this.queryTargetKeyRe.exec(t);v(null!==n,"Cannot parse query target key '"+t+"'");var r=Number(n[1]);return Li.fromWebStorageEntry(r,e)},t.prototype.fromWebStorageOnlineState=function(t){return Vi.fromWebStorageEntry(t)},t.prototype.handleMutationBatchEvent=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){return t.user.uid!==this.currentUser.uid?(p(ki,"Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.syncEngine.applyBatchState(t.batchId,t.state,t.error)]})})},t.prototype.handleQueryTargetEvent=function(t){return this.syncEngine.applyTargetState(t.targetId,t.state,t.error)},t.prototype.handleClientStateEvent=function(t,e){var n=this,r=this.getAllActiveQueryTargets();e?this.activeClients[t]=e:delete this.activeClients[t];var i=this.getAllActiveQueryTargets(),o=[],a=[];return i.forEach(function(t){return s.__awaiter(n,void 0,void 0,function(){return s.__generator(this,function(e){return r.has(t)||o.push(t),[2]})})}),r.forEach(function(t){return s.__awaiter(n,void 0,void 0,function(){return s.__generator(this,function(e){return i.has(t)||a.push(t),[2]})})}),this.syncEngine.applyActiveTargetsChange(o,a)},t.prototype.handleOnlineStateEvent=function(t){this.activeClients[t.clientId]&&this.onlineStateHandler(t.onlineState)},t}(),qi=function(){function t(){this.localState=new Bi,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.localState.addQueryTarget(t),this.queryState[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.queryState[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.localState.removeQueryTarget(t)},t.prototype.isLocalQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.queryState[t]},t.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.start=function(){return this.localState=new Bi,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t}(),ji=function(){function t(t,e){this.cacheSizeBytes=t,this.synchronizeTabs=e}return t.prototype.lruParams=function(){return Dn.withCacheSize(this.cacheSizeBytes)},t}(),zi=function(){return function(){}}(),Qi=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r,this.clientId=G.newId()}return t.prototype.start=function(t){var e=this;this.verifyNotTerminated();var n=new ct,r=new ct,i=!1;return this.credentials.setChangeListener(function(o){i?e.asyncQueue.enqueueAndForget(function(){return e.handleCredentialChange(o)}):(i=!0,e.initializePersistence(t,r,o).then(function(t){return e.initializeRest(o,t)}).then(n.resolve,n.reject))}),this.asyncQueue.enqueueAndForget(function(){return n.promise}),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return t.syncEngine.enableNetwork()})},t.prototype.initializePersistence=function(t,e,n){var r=this;return t instanceof ji?this.startIndexedDbPersistence(n,t).then(function(t){return e.resolve(),t}).catch(function(t){if(e.reject(t),!r.canFallback(t))throw t;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),r.startMemoryPersistence()}):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t instanceof E?t.code===w.FAILED_PRECONDITION||t.code===w.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new E(w.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.startIndexedDbPersistence=function(t,e){var n=this,r=Vn.buildStoragePrefix(this.databaseInfo),i=new mi(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then(function(){return s.__awaiter(n,void 0,void 0,function(){var n,o;return s.__generator(this,function(s){switch(s.label){case 0:if(e.synchronizeTabs&&!Ui.isAvailable(this.platform))throw new E(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return o=e.lruParams(),e.synchronizeTabs?(this.sharedClientState=new Ui(this.asyncQueue,this.platform,r,this.clientId,t),[4,Vn.createMultiClientIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,o,{sequenceNumberSyncer:this.sharedClientState})]):[3,2];case 1:return n=s.sent(),[3,4];case 2:return this.sharedClientState=new qi,[4,Vn.createIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,o)];case 3:n=s.sent(),s.label=4;case 4:return this.persistence=n,[2,n.referenceDelegate.garbageCollector]}})})})},t.prototype.startMemoryPersistence=function(){return this.persistence=Zn.createEagerPersistence(this.clientId),this.sharedClientState=new qi,Promise.resolve(null)},t.prototype.initializeRest=function(t,e){var n=this;return p("FirestoreClient","Initializing. user=",t.uid),this.platform.loadConnection(this.databaseInfo).then(function(r){return s.__awaiter(n,void 0,void 0,function(){var n,i,o,a,l=this;return s.__generator(this,function(u){switch(u.label){case 0:return this.localStore=new Gn(this.persistence,t),e&&(this.lruScheduler=new Nn(e,this.asyncQueue,this.localStore)),n=this.platform.newConnectivityMonitor(),i=this.platform.newSerializer(this.databaseInfo.databaseId),o=new mr(this.asyncQueue,r,this.credentials,i),a=function(t){return l.syncEngine.applyOnlineStateChange(t,vr.SharedClientState)},this.remoteStore=new Ur(this.localStore,o,this.asyncQueue,function(t){return l.syncEngine.applyOnlineStateChange(t,vr.RemoteStore)},n),this.syncEngine=new xi(this.localStore,this.remoteStore,this.sharedClientState,t),this.sharedClientState.onlineStateHandler=a,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new yi(this.syncEngine),[4,this.sharedClientState.start()];case 1:return u.sent(),[4,this.remoteStore.start()];case 2:return u.sent(),[4,this.persistence.setPrimaryStateListener(function(t){return s.__awaiter(l,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return[4,this.syncEngine.applyPrimaryState(t)];case 1:return e.sent(),this.lruScheduler&&(t&&!this.lruScheduler.started?this.lruScheduler.start():t||this.lruScheduler.stop()),[2]}})})})];case 3:return u.sent(),[4,this.persistence.setDatabaseDeletedListener(function(){return s.__awaiter(l,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})})];case 4:return u.sent(),[2]}})})})},t.prototype.handleCredentialChange=function(t){return this.asyncQueue.verifyOperationInProgress(),p("FirestoreClient","Credential Changed. Current user: "+t.uid),this.syncEngine.handleCredentialChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return t.syncEngine.disableNetwork()})},t.prototype.terminate=function(){var t=this;return this.asyncQueue.enqueueAndInitiateShutdown(function(){return s.__awaiter(t,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()];case 1:return t.sent(),[4,this.sharedClientState.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown()];case 3:return t.sent(),this.credentials.removeChangeListener(),[2]}})})})},t.prototype.waitForPendingWrites=function(){var t=this;this.verifyNotTerminated();var e=new ct;return this.asyncQueue.enqueueAndForget(function(){return t.syncEngine.registerPendingWritesCallback(e)}),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.verifyNotTerminated();var i=new vi(t,e,n);return this.asyncQueue.enqueueAndForget(function(){return r.eventMgr.listen(i)}),i},t.prototype.unlisten=function(t){var e=this;this.clientTerminated||this.asyncQueue.enqueueAndForget(function(){return e.eventMgr.unlisten(t)})},t.prototype.getDocumentFromLocalCache=function(t){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return e.localStore.readDocument(t)}).then(function(t){if(t instanceof je)return t;if(t instanceof ze)return null;throw new E(w.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},t.prototype.getDocumentsFromLocalCache=function(t){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return e.localStore.executeQuery(t)}).then(function(e){var n=Vt(),r=new Ei(t,n),i=r.computeDocChanges(e);return r.applyChanges(i,!1).snapshot})},t.prototype.write=function(t){var e=this;this.verifyNotTerminated();var n=new ct;return this.asyncQueue.enqueueAndForget(function(){return e.syncEngine.write(t,n)}),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},Object.defineProperty(t.prototype,"clientTerminated",{get:function(){return this.asyncQueue.isShuttingDown},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.verifyNotTerminated();var n=new ct;return this.asyncQueue.enqueueAndForget(function(){return e.syncEngine.runTransaction(e.asyncQueue,t,n),Promise.resolve()}),n.promise},t}(),Hi=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Wi=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(e,n,r,i){if(!(t instanceof Array)||t.length<1)throw new E(w.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+W(1,"element")+".")}();for(var n=0;n<t.length;++n)if(O("FieldPath","string",n,t[n]),0===t[n].length)throw new E(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lt(t)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(lt.keyField().canonicalString()),t}(),Gi=new RegExp("[~\\*/\\[\\]]"),Ki=function(){return function(t,e){this.user=e,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+t}}}(),$i=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t){v(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,t(Ai.UNAUTHENTICATED)},t.prototype.removeChangeListener=function(){v(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},t}(),Yi=function(){function t(t){var e=this;this.app=t,this.tokenListener=null,this.currentUser=Ai.UNAUTHENTICATED,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){e.tokenCounter++,e.currentUser=e.getUser(),e.changeListener&&e.changeListener(e.currentUser)},this.currentUser=this.getUser(),this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return t.prototype.getToken=function(){var t=this;v(null!=this.tokenListener,"getToken cannot be called after listener removed.");var e=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(n).then(function(n){if(t.tokenCounter!==e)throw new E(w.ABORTED,"getToken aborted due to token change.");return n?(v("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new Ki(n.accessToken,t.currentUser)):null})},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t){v(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,t(this.currentUser)},t.prototype.removeChangeListener=function(){v(null!=this.tokenListener,"removeChangeListener() called twice"),v(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},t.prototype.getUser=function(){var t=this.app.INTERNAL.getUid();return v(null===t||"string"==typeof t,"Received invalid UID: "+t),new Ai(t)},t}(),Zi=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=Ai.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.sessionIndex},e=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),Xi=function(){function t(t,e){this.gapi=t,this.sessionIndex=e}return t.prototype.getToken=function(){return Promise.resolve(new Zi(this.gapi,this.sessionIndex))},t.prototype.setChangeListener=function(t){t(Ai.FIRST_PARTY)},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Ji(t){if(!t)return new $i;switch(t.type){case"gapi":var e=t.client;return v(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new Xi(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new E(w.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}function to(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var eo=function(){function t(t){this._methodName=t}return t.delete=function(){return k("FieldValue.delete",arguments),no.instance},t.serverTimestamp=function(){return k("FieldValue.serverTimestamp",arguments),ro.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return N("FieldValue.arrayUnion",arguments,1),new io(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return N("FieldValue.arrayRemove",arguments,1),new oo(t)},t.increment=function(t){return O("FieldValue.increment","number",1,t),D("FieldValue.increment",arguments,1),new so(t)},t.prototype.isEqual=function(t){return this===t},t}(),no=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return s.__extends(e,t),e.instance=new e,e}(eo),ro=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return s.__extends(e,t),e.instance=new e,e}(eo),io=function(t){function e(e){var n=t.call(this,"FieldValue.arrayUnion")||this;return n._elements=e,n}return s.__extends(e,t),e}(eo),oo=function(t){function e(e){var n=t.call(this,"FieldValue.arrayRemove")||this;return n._elements=e,n}return s.__extends(e,t),e}(eo),so=function(t){function e(e){var n=t.call(this,"FieldValue.increment")||this;return n._operand=e,n}return s.__extends(e,t),e}(eo),ao=S(eo,"Use FieldValue.<field>() instead."),lo=/^__.*__$/,uo=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return n.push(null!==this.fieldMask?new be(t,this.data,this.fieldMask,e):new _e(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new we(t,this.fieldTransforms)),n},t}(),co=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new be(t,this.data,this.fieldMask,e)];return this.fieldTransforms.length>0&&n.push(new we(t,this.fieldTransforms)),n},t}(),ho=function(t){return t[t.Set=0]="Set",t[t.Update=1]="Update",t[t.MergeSet=2]="MergeSet",t[t.Argument=3]="Argument",t}({});function fo(t){switch(t){case ho.Set:case ho.MergeSet:case ho.Update:return!0;case ho.Argument:return!1;default:throw y("Unexpected case for UserDataSource: "+t)}}var po=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new E(w.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(fo(this.dataSource)&&lo.test(t))throw this.createError("Document fields cannot begin and end with __")},t}(),mo=function(){return function(t,e){this.databaseId=t,this.key=e}}(),go=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new po(ho.Set,t,lt.EMPTY_PATH);vo("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new uo(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e,n){var r=new po(ho.MergeSet,t,lt.EMPTY_PATH);vo("Data must be an object, but it was:",r,e);var i,o,s=this.parseData(e,r);if(n){for(var a=new At(lt.comparator),l=0,u=n;l<u.length;l++){var c=u[l],h=void 0;if(c instanceof Wi)h=c._internalPath;else{if("string"!=typeof c)throw y("Expected stringOrFieldPath to be a string or a FieldPath");h=bo(t,c)}if(!r.contains(h))throw new E(w.INVALID_ARGUMENT,"Field '"+h+"' is specified in your field mask but missing from your input data.");a=a.add(h)}i=fe.fromSet(a),o=r.fieldTransforms.filter(function(t){return i.covers(t.field)})}else i=fe.fromArray(r.fieldMask),o=r.fieldTransforms;return new uo(s,i,o)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new po(ho.Update,t,lt.EMPTY_PATH);vo("Data must be an object, but it was:",r,e);var i=new At(lt.comparator),o=Be.EMPTY;x(e,function(e,s){var a=bo(t,e),l=r.childContextForFieldPath(a);if((s=n.runPreConverter(s,l))instanceof no)i=i.add(a);else{var u=n.parseData(s,l);null!=u&&(i=i.add(a),o=o.set(a,u))}});var s=fe.fromSet(i);return new co(o,s,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new po(ho.Update,t,lt.EMPTY_PATH),o=[_o(t,e)],s=[n];if(r.length%2!=0)throw new E(w.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var a=0;a<r.length;a+=2)o.push(_o(t,r[a])),s.push(r[a+1]);var l=new At(lt.comparator),u=Be.EMPTY;for(a=0;a<o.length;++a){var c=o[a],h=i.childContextForFieldPath(c),d=this.runPreConverter(s[a],h);if(d instanceof no)l=l.add(c);else{var f=this.parseData(d,h);null!=f&&(l=l.add(c),u=u.set(c,f))}}var p=fe.fromSet(l);return new co(u,p,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e){var n=new po(ho.Argument,t,lt.EMPTY_PATH),r=this.parseData(e,n);return v(null!=r,"Parsed data should not be null."),v(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(r){var n=wo(r);throw e.createError(n)}},t.prototype.parseData=function(t,e){if(yo(t=this.runPreConverter(t,e)))return vo("Unsupported field value:",e,t),this.parseObject(t,e);if(t instanceof eo)return this.parseSentinelFieldValue(t,e),null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.arrayElement)throw e.createError("Nested arrays are not supported");return this.parseArray(t,e)}return this.parseScalarValue(t,e)},t.prototype.parseObject=function(t,e){var n=this,r=new Ct(K);return A(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):x(t,function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))}),new Be(r)},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=this.parseData(o[i],e.childContextForArray(r));null==s&&(s=xe.INSTANCE),n.push(s),r++}return new Ue(n)},t.prototype.parseSentinelFieldValue=function(t,e){if(!fo(e.dataSource))throw e.createError(t._methodName+"() can only be used with update() and set()");if(null===e.path)throw e.createError(t._methodName+"() is not currently supported inside arrays");if(t instanceof no){if(e.dataSource!==ho.MergeSet)throw e.dataSource===ho.Update?(v(e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.fieldMask.push(e.path)}else if(t instanceof ro)e.fieldTransforms.push(new pe(e.path,ni.instance));else if(t instanceof io){var n=this.parseArrayTransformElements(t._methodName,t._elements),r=new ri(n);e.fieldTransforms.push(new pe(e.path,r))}else if(t instanceof oo){n=this.parseArrayTransformElements(t._methodName,t._elements);var i=new ii(n);e.fieldTransforms.push(new pe(e.path,i))}else if(t instanceof so){var o=this.parseQueryValue("FieldValue.increment",t._operand),s=new oi(o);e.fieldTransforms.push(new pe(e.path,s))}else y("Unknown FieldValue type: "+t)},t.prototype.parseScalarValue=function(t,e){if(null===t)return xe.INSTANCE;if("number"==typeof t)return sr(t)?new Ne(t):new Re(t);if("boolean"==typeof t)return Ae.of(t);if("string"==typeof t)return new Oe(t);if(t instanceof Date)return new Pe(Et.fromDate(t));if(t instanceof Et)return new Pe(new Et(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof qr)return new Ve(t);if(t instanceof J)return new Le(t);if(t instanceof mo)return new Fe(t.databaseId,t.key);throw e.createError("Unsupported field value: "+q(t))},t.prototype.parseArrayTransformElements=function(t,e){var n=this;return e.map(function(e,r){var i=new po(ho.Argument,t,lt.EMPTY_PATH);return n.parseData(e,i.childContextForArray(r))})},t}();function yo(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Et||t instanceof qr||t instanceof J||t instanceof mo||t instanceof eo)}function vo(t,e,n){if(!yo(n)||!U(n)){var r=q(n);throw e.createError("an object"===r?t+" a custom object":t+" "+r)}}function _o(t,e){if(e instanceof Wi)return e._internalPath;if("string"==typeof e)return bo(t,e);throw new E(w.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function bo(t,e){try{return function(t){if(t.search(Gi)>=0)throw new E(w.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Wi.bind.apply(Wi,[void 0].concat(t.split("."))))}catch(e){throw new E(w.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e)._internalPath}catch(r){var n=wo(r);throw new E(w.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function wo(t){return t instanceof Error?t.message:t.toString()}var Eo="firestore.googleapis.com",So=!0,Co=!0,To=!1,Io=Dn.COLLECTION_DISABLED,xo=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new E(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Eo,this.ssl=So}else M("settings","non-empty string","host",t.host),this.host=t.host,L("settings","boolean","ssl",t.ssl),this.ssl=T(t.ssl,So);if(z("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),L("settings","object","credentials",t.credentials),this.credentials=t.credentials,L("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?m("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===t.timestampsInSnapshots&&m("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=T(t.timestampsInSnapshots,Co),L("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Dn.DEFAULT_CACHE_SIZE_BYTES;else{if(t.cacheSizeBytes!==Io&&t.cacheSizeBytes<Dn.MINIMUM_CACHE_SIZE_BYTES)throw new E(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Dn.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=t.cacheSizeBytes}L("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0===t.experimentalForceLongPolling?To:t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),Ao=function(){function t(e){var n=this;if(this._firebaseApp=null,this._queue=new ft,this.INTERNAL={delete:function(){return s.__awaiter(n,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof e.options){var r=e;this._firebaseApp=r,this._databaseId=t.databaseIdFromApp(r),this._persistenceKey=r.name,this._credentials=new Yi(r)}else{var i=e;if(!i.projectId)throw new E(w.INVALID_ARGUMENT,"Must provide projectId");this._databaseId=new rt(i.projectId,i.database),this._persistenceKey="[DEFAULT]",this._credentials=new $i}this._settings=new xo({}),this._dataConverter=this.createDataConverter(this._databaseId)}return t.prototype.settings=function(t){if(D("Firestore.settings",arguments,1),O("Firestore.settings","object",1,t),C(t,"persistence"))throw new E(w.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new xo(t);if(this._firestoreClient&&!this._settings.isEqual(e))throw new E(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._settings=e,void 0!==e.credentials&&(this._credentials=Ji(e.credentials))},t.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},t.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},t.prototype.enablePersistence=function(t){if(this._firestoreClient)throw new E(w.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1;return t&&(void 0!==t.experimentalTabSynchronization&&m("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),e=T(void 0!==t.synchronizeTabs?t.synchronizeTabs:t.experimentalTabSynchronization,!1)),this.configureClient(new ji(this._settings.cacheSizeBytes,e))},t.prototype.clearPersistence=function(){var t=this,e=Vn.buildStoragePrefix(this.makeDatabaseInfo()),n=new ct;return this._queue.enqueueAndForgetEvenAfterShutdown(function(){return s.__awaiter(t,void 0,void 0,function(){var t;return s.__generator(this,function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientTerminated)throw new E(w.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,Vn.clearPersistence(e)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}})})}),n.promise},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"_isTerminated",{get:function(){return this.ensureClientConfigured(),this._firestoreClient.clientTerminated},enumerable:!0,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.ensureClientConfigured(),this._firestoreClient.waitForPendingWrites()},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new zi),this._firestoreClient},t.prototype.makeDatabaseInfo=function(){return new et(this._databaseId,this._persistenceKey,this._settings.host,this._settings.ssl,this._settings.forceLongPolling)},t.prototype.configureClient=function(t){v(!!this._settings.host,"FirestoreSettings.host is not set"),v(!this._firestoreClient,"configureClient() called multiple times");var e=this.makeDatabaseInfo();return this._firestoreClient=new Qi(_.getPlatform(),e,this._credentials,this._queue),this._firestoreClient.start(t)},t.prototype.createDataConverter=function(t){return new go(function(e){if(e instanceof No){var n=t,r=e.firestore._databaseId;if(!r.isEqual(n))throw new E(w.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new mo(t,e._key)}return e})},t.databaseIdFromApp=function(t){var e=t.options;if(!C(e,"projectId"))throw new E(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=e.projectId;if(!n||"string"!=typeof n)throw new E(w.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new rt(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._firebaseApp)throw new E(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return D("Firestore.collection",arguments,1),O("Firestore.collection","non-empty string",1,t),this.ensureClientConfigured(),new Fo(st.fromString(t),this)},t.prototype.doc=function(t){return D("Firestore.doc",arguments,1),O("Firestore.doc","non-empty string",1,t),this.ensureClientConfigured(),No.forPath(st.fromString(t),this)},t.prototype.collectionGroup=function(t){if(D("Firestore.collectionGroup",arguments,1),O("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new E(w.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ensureClientConfigured(),new Mo(new jr(st.EMPTY_PATH,t),this)},t.prototype.runTransaction=function(t){var e=this;return D("Firestore.runTransaction",arguments,1),O("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction(function(n){return t(new ko(e,n))})},t.prototype.batch=function(){return this.ensureClientConfigured(),new Do(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(d()){case h.DEBUG:return"debug";case h.ERROR:return"error";case h.SILENT:return"silent";default:return y("Unknown log level: "+d())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(D("Firestore.setLogLevel",arguments,1),O("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":f(h.DEBUG);break;case"error":f(h.ERROR);break;case"silent":f(h.SILENT);break;default:throw new E(w.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype._areTimestampsInSnapshotsEnabled=function(){return this._settings.timestampsInSnapshots},t}(),ko=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;D("Transaction.get",arguments,1);var n=qo("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return y("Mismatch in docs returned from document lookup.");var r=t[0];if(r instanceof ze)return new Oo(e._firestore,n._key,null,!1,!1);if(r instanceof je)return new Oo(e._firestore,n._key,r,!1,!1);throw y("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)})},t.prototype.set=function(t,e,n){R("Transaction.set",arguments,2,3);var r=qo("Transaction.set",t,this._firestore),i=(n=Vo("Transaction.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("Transaction.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("Transaction.set",e);return this._transaction.set(r._key,i),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof Wi?(N("Transaction.update",arguments,3),r=qo("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,o)):(D("Transaction.update",arguments,2),r=qo("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(r._key,i),this},t.prototype.delete=function(t){D("Transaction.delete",arguments,1);var e=qo("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},t}(),Do=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){R("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=qo("WriteBatch.set",t,this._firestore),i=(n=Vo("WriteBatch.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("WriteBatch.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("WriteBatch.set",e);return this._mutations=this._mutations.concat(i.toMutations(r._key,ye.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.verifyNotCommitted(),"string"==typeof e||e instanceof Wi?(N("WriteBatch.update",arguments,3),r=qo("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,o)):(D("WriteBatch.update",arguments,2),r=qo("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(i.toMutations(r._key,ye.exists(!0))),this},t.prototype.delete=function(t){D("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=qo("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new Ee(e._key,ye.NONE)),this},t.prototype.commit=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new E(w.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),No=function(){function t(t,e){this._key=t,this.firestore=e,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n){if(e.length%2!=0)throw new E(w.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new ut(e),n)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Fo(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(D("DocumentReference.collection",arguments,1),O("DocumentReference.collection","non-empty string",1,t),!t)throw new E(w.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=st.fromString(t);return new Fo(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)},t.prototype.set=function(t,e){R("DocumentReference.set",arguments,1,2);var n=(e=Vo("DocumentReference.set",e)).merge||e.mergeFields?this.firestore._dataConverter.parseMergeData("DocumentReference.set",t,e.mergeFields):this.firestore._dataConverter.parseSetData("DocumentReference.set",t);return this._firestoreClient.write(n.toMutations(this._key,ye.NONE))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof Wi?(N("DocumentReference.update",arguments,2),n=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,r)):(D("DocumentReference.update",arguments,1),n=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(n.toMutations(this._key,ye.exists(!0)))},t.prototype.delete=function(){return D("DocumentReference.delete",arguments,0),this._firestoreClient.write([new Ee(this._key,ye.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];R("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||to(t[i])||(z("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),L("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return to(t[i])?n=t[i]:(O("DocumentReference.onSnapshot","function",i,t[i]),P("DocumentReference.onSnapshot","function",i+1,t[i+1]),P("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Hi({next:function(t){if(e.next){v(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new Oo(n.firestore,n._key,r,t.fromCache,t.hasPendingWrites))}},error:r}),o=this._firestoreClient.listen(jr.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(t){var e=this;return R("DocumentReference.get",arguments,0,1),Uo("DocumentReference.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentFromLocalCache(e._key).then(function(t){n(new Oo(e.firestore,e._key,t,!0,t instanceof je&&t.hasLocalMutations))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new E(w.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new E(w.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t}(),Ro=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Oo=function(){function t(t,e,n,r,i){this._firestore=t,this._key=e,this._document=n,this._fromCache=r,this._hasPendingWrites=i}return t.prototype.data=function(t){return R("DocumentSnapshot.data",arguments,0,1),t=Bo("DocumentSnapshot.data",t),this._document?this.convertObject(this._document.data(),Te.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},t.prototype.get=function(t,e){if(R("DocumentSnapshot.get",arguments,1,2),e=Bo("DocumentSnapshot.get",e),this._document){var n=this._document.data().field(_o("DocumentSnapshot.get",t));if(null!==n)return this.convertValue(n,Te.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new No(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Ro(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))},t.prototype.convertObject=function(t,e){var n=this,r={};return t.forEach(function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertValue=function(t,e){if(t instanceof Be)return this.convertObject(t,e);if(t instanceof Ue)return this.convertArray(t,e);if(t instanceof Fe){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||m("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new No(n,this._firestore)}return t.value(e)},t.prototype.convertArray=function(t,e){var n=this;return t.internalValue.map(function(t){return n.convertValue(t,e)})},t}(),Po=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return v("object"==typeof n,"Document in a QueryDocumentSnapshot should exist"),n},e}(Oo),Mo=function(){function t(t,e){this._query=t,this.firestore=e}return t.prototype.where=function(e,n,r){if(D("Query.where",arguments,3),j("Query.where",3,r),"in"!==n&&"array-contains-any"!==n){var i=["<","<=","==",">=",">","array-contains"];V("Query.where",i,2,n)}var o,s=_o("Query.where",e),a=Qr.fromString(n);if(s.isKeyField()){if(a===Qr.ARRAY_CONTAINS||a===Qr.ARRAY_CONTAINS_ANY)throw new E(w.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+a.toString()+"' queries on FieldPath.documentId().");if(a===Qr.IN){this.validateDisjunctiveFilterElements(r,a);for(var l=[],u=0,c=r;u<c.length;u++){var h=c[u];l.push(this.parseDocumentIdValue(h))}o=new Ue(l)}else o=this.parseDocumentIdValue(r)}else a!==Qr.IN&&a!==Qr.ARRAY_CONTAINS_ANY||this.validateDisjunctiveFilterElements(r,a),o=this.firestore._dataConverter.parseQueryValue("Query.where",r);var d=Hr.create(s,a,o);return this.validateNewFilter(d),new t(this._query.addFilter(d),this.firestore)},t.prototype.orderBy=function(e,n){var r;if(R("Query.orderBy",arguments,1,2),P("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=Zr.ASCENDING;else{if("desc"!==n)throw new E(w.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=Zr.DESCENDING}if(null!==this._query.startAt)throw new E(w.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new E(w.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=_o("Query.orderBy",e),o=new Jr(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore)},t.prototype.limit=function(e){if(D("Query.limit",arguments,1),O("Query.limit","number",1,e),e<=0)throw new E(w.INVALID_ARGUMENT,"Invalid Query. Query limit ("+e+") is invalid. Limit must be positive.");return new t(this._query.withLimit(e),this.firestore)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];N("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];N("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];N("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];N("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(j(t,1,e),e instanceof Oo){if(n.length>0)throw new E(w.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new E(w.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var s=o[i];if(s.field.isKeyField())r.push(new Fe(this.firestore._databaseId,e.key));else{var a=e.field(s.field);if(a instanceof Me)throw new E(w.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var l=s.field.canonicalString();throw new E(w.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}r.push(a)}}return new Xr(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new E(w.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.isKeyField()){if("string"!=typeof s)throw new E(w.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this._query.isCollectionGroupQuery()&&-1!==s.indexOf("/"))throw new E(w.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var a=this._query.path.child(st.fromString(s));if(!ut.isDocumentKey(a))throw new E(w.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+a+"' is not because it contains an odd number of segments.");var l=new ut(a);i.push(new Fe(this.firestore._databaseId,l))}else{var u=this.firestore._dataConverter.parseQueryValue(t,s);i.push(u)}}return new Xr(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];R("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||to(t[i])||(z("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),L("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),to(t[i])?n=t[i]:(O("Query.onSnapshot","function",i,t[i]),P("Query.onSnapshot","function",i+1,t[i+1]),P("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Hi({next:function(t){e.next&&e.next(new Lo(n.firestore,n._query,t))},error:r}),o=this.firestore.ensureClientConfigured(),s=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(s)}},t.prototype.get=function(t){var e=this;return R("Query.get",arguments,0,1),Uo("Query.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentsFromLocalCache(e._query).then(function(t){n(new Lo(e.firestore,e._query,t))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new E(w.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.parseDocumentIdValue=function(t){if("string"==typeof t){if(""===t)throw new E(w.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this._query.isCollectionGroupQuery()&&-1!==t.indexOf("/"))throw new E(w.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this._query.path.child(st.fromString(t));if(!ut.isDocumentKey(e))throw new E(w.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return new Fe(this.firestore._databaseId,new ut(e))}if(t instanceof No)return new Fe(this.firestore._databaseId,t._key);throw new E(w.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+q(t)+".")},t.prototype.validateDisjunctiveFilterElements=function(t,e){if(!Array.isArray(t)||0===t.length)throw new E(w.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new E(w.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(t.indexOf(null)>=0)throw new E(w.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter(function(t){return Number.isNaN(t)}).length>0)throw new E(w.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},t.prototype.validateNewFilter=function(t){if(t instanceof Hr){var e=[Qr.ARRAY_CONTAINS,Qr.ARRAY_CONTAINS_ANY],n=[Qr.IN,Qr.ARRAY_CONTAINS_ANY],r=e.indexOf(t.op)>=0,i=n.indexOf(t.op)>=0;if(t.isInequality()){var o=this._query.getInequalityFilterField();if(null!==o&&!o.isEqual(t.field))throw new E(w.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this._query.getFirstOrderByField();null!==s&&this.validateOrderByAndInequalityMatch(t.field,s)}else if(i||r){var a=null;if(i&&(a=this._query.findFilterOperator(n)),null===a&&r&&(a=this._query.findFilterOperator(e)),null!=a)throw new E(w.INVALID_ARGUMENT,a===t.op?"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter.":"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+a.toString()+"' filters.")}}},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new E(w.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),Lo=function(){function t(t,e,n){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new Ro(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;R("QuerySnapshot.forEach",arguments,1,2),O("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach(function(r){t.call(e,n.convertToDocumentImpl(r))})},Object.defineProperty(t.prototype,"query",{get:function(){return new Mo(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(z("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),L("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this._snapshot.excludesMetadataChanges)throw new E(w.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e,n){if(n.oldDocs.isEmpty()){var r,i=0;return n.docChanges.map(function(e){var o=new Po(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key));return v(e.type===Tr.Added,"Invalid event type for first snapshot"),v(!r||n.query.docComparator(r,e.doc)<0,"Got added events in wrong order"),r=e.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}})}var o=n.oldDocs;return n.docChanges.filter(function(t){return e||t.type!==Tr.Metadata}).map(function(e){var r=new Po(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key)),i=-1,s=-1;return e.type!==Tr.Added&&(v((i=o.indexOf(e.doc.key))>=0,"Index for document not found"),o=o.delete(e.doc.key)),e.type!==Tr.Removed&&(s=(o=o.add(e.doc)).indexOf(e.doc.key)),{type:jo(e.type),doc:r,oldIndex:i,newIndex:s}})}(this._firestore,e,this._snapshot),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)},t.prototype.convertToDocumentImpl=function(t){return new Po(this._firestore,t.key,t,this.metadata.fromCache,this._snapshot.mutatedKeys.has(t.key))},t}();["length","forEach","map"].concat("undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach(function(t){try{Object.defineProperty(Lo.prototype.docChanges,t,{get:function(){return function(){throw new E(w.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(e){}});var Fo=function(t){function e(e,n){var r=t.call(this,jr.atPath(e),n)||this;if(e.length%2!=1)throw new E(w.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return r}return s.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new No(new ut(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(R("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=G.newId()),O("CollectionReference.doc","non-empty string",1,t),""===t)throw new E(w.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=st.fromString(t);return No.forPath(this._query.path.child(e),this.firestore)},e.prototype.add=function(t){D("CollectionReference.add",arguments,1),O("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then(function(){return e})},e}(Mo);function Vo(t,e){if(void 0===e)return{merge:!1};if(z(t,e,["merge","mergeFields"]),L(t,"boolean","merge",e.merge),"mergeFields","a string or a FieldPath",void 0!==(n=e.mergeFields)&&function(t,e,n,r,i){if(!(r instanceof Array))throw new E(w.INVALID_ARGUMENT,"Function "+t+"() requires its mergeFields option to be an array, but it was: "+q(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new E(w.INVALID_ARGUMENT,"Function "+t+"() requires all mergeFields elements to be a string or a FieldPath, but the value at index "+o+" was: "+q(r[o]))}(t,0,0,n,function(t){return"string"==typeof t||t instanceof Wi}),void 0!==e.mergeFields&&void 0!==e.merge)throw new E(w.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Bo(t,e){return void 0===e?{}:(z(t,e,["serverTimestamps"]),F(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Uo(t,e){P(t,"object",1,e),e&&(z(t,e,["source"]),F(t,0,"source",e.source,["default","server","cache"]))}function qo(t,e,n){if(e instanceof No){if(e.firestore!==n)throw new E(w.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Q(t,"DocumentReference",1,e)}function jo(t){switch(t){case Tr.Added:return"added";case Tr.Modified:case Tr.Metadata:return"modified";case Tr.Removed:return"removed";default:return y("Unknown change type: "+t)}}var zo=S(Ao,"Use firebase.firestore() instead."),Qo=S(ko,"Use firebase.firestore().runTransaction() instead."),Ho=S(Do,"Use firebase.firestore().batch() instead."),Wo=S(No,"Use firebase.firestore().doc() instead."),Go=S(Oo),Ko=S(Po),$o=S(Mo),Yo=S(Lo),Zo=S(Fo,"Use firebase.firestore().collection() instead."),Xo={Firestore:zo,GeoPoint:qr,Timestamp:Et,Blob:tt,Transaction:Qo,WriteBatch:Ho,DocumentReference:Wo,DocumentSnapshot:Go,Query:$o,QueryDocumentSnapshot:Ko,QuerySnapshot:Yo,CollectionReference:Zo,FieldPath:Wi,FieldValue:ao,setLogLevel:Ao.setLogLevel,CACHE_SIZE_UNLIMITED:Io},Jo=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.shutdown=function(){},t}(),ts=function(){function t(){var t=this;this.networkAvailableListener=function(){return t.onNetworkAvailable()},this.networkUnavailableListener=function(){return t.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}return t.prototype.addCallback=function(t){this.callbacks.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},t.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},t.prototype.onNetworkAvailable=function(){p("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++)(0,e[t])(0)},t.prototype.onNetworkUnavailable=function(){p("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++)(0,e[t])(1)},t.isAvailable=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),es=function(){function t(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){v(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){v(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){v(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){v(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){v(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){v(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}(),ns="Connection",rs={BatchGetDocuments:"batchGet",Commit:"commit"},is="gl-js/ fire/"+u,os=function(){function t(t){this.databaseId=t.databaseId,this.baseUrl=(t.ssl?"https":"http")+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=is},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise(function(o,s){var a=new l.XhrIo;a.listenOnce(l.EventType.COMPLETE,function(){try{switch(a.getLastErrorCode()){case l.ErrorCode.NO_ERROR:var e=a.getResponseJson();p(ns,"XHR received:",JSON.stringify(e)),o(e);break;case l.ErrorCode.TIMEOUT:p(ns,'RPC "'+t+'" timed out'),s(new E(w.DEADLINE_EXCEEDED,"Request time out"));break;case l.ErrorCode.HTTP_ERROR:var n=a.getStatus();if(p(ns,'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var i=(u=r.status.toLowerCase().replace("_","-"),Object.values(w).indexOf(u)>=0?u:w.UNKNOWN);s(new E(i,r.message))}else s(new E(w.UNKNOWN,"Server responded with status "+a.getStatus()))}else p(ns,'RPC "'+t+'" failed'),s(new E(w.UNAVAILABLE,"Connection failed."));break;default:y('RPC "'+t+'" failed with unanticipated webchannel error '+a.getLastErrorCode()+": "+a.getLastError()+", giving up.")}}finally{p(ns,'RPC "'+t+'" completed.')}var u});var u=JSON.stringify(e);p(ns,"XHR sending: ",i+" "+u);var c={"Content-Type":"text/plain"};r.modifyHeadersForRequest(c,n),a.send(i,"POST",u,c,15)})},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=l.createWebChannelTransport(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(i.initMessageHeaders,e),a.isReactNative()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");p(ns,"Creating WebChannel: "+o+" "+i);var s=r.createWebChannel(o,i),u=!1,c=!1,h=new es({sendFn:function(t){c?p(ns,"Not sending because WebChannel is closed:",t):(u||(p(ns,"Opening WebChannel transport."),s.open(),u=!0),p(ns,"WebChannel sending:",t),s.send(t))},closeFn:function(){return s.close()}}),d=function(t,e){s.listen(t,function(t){try{e(t)}catch(n){setTimeout(function(){throw n},0)}})};return d(l.WebChannel.EventType.OPEN,function(){c||p(ns,"WebChannel transport opened.")}),d(l.WebChannel.EventType.CLOSE,function(){c||(c=!0,p(ns,"WebChannel transport closed"),h.callOnClose())}),d(l.WebChannel.EventType.ERROR,function(t){c||(c=!0,p(ns,"WebChannel transport errored:",t),h.callOnClose(new E(w.UNAVAILABLE,"The operation could not be completed")))}),d(l.WebChannel.EventType.MESSAGE,function(t){if(!c){var e=t.data[0];v(!!e,"Got a webchannel message without data.");var n=e.error||e[0]&&e[0].error;if(n){p(ns,"WebChannel received error:",n);var r=n.status,i=function(t){var e=br[r];if(void 0!==e)return Er(e)}(),o=n.message;void 0===i&&(i=w.INTERNAL,o="Unknown error status: "+r+" with message "+n.message),c=!0,h.callOnClose(new E(i,o)),s.close()}else p(ns,"WebChannel received:",e),h.callOnMessage(e)}}),setTimeout(function(){h.callOnOpen()},0),h},t.prototype.makeUrl=function(t){var e=rs[t];v(void 0!==e,"Unknown REST mapping for: "+t);var n=[this.baseUrl,"/","v1"];return n.push("/projects/"),n.push(this.databaseId.projectId),n.push("/databases/"),n.push(this.databaseId.database),n.push("/documents"),n.push(":"),n.push(e),n.join("")},t}();function ss(t){t.INTERNAL.registerService("firestore",function(t){return new Ao(t)},function(t){v(t&&"object"==typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}(Xo))}_.setPlatform(new(function(){function t(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.loadConnection=function(t){return Promise.resolve(new os(t))},t.prototype.newConnectivityMonitor=function(){return ts.isAvailable()?new ts:new Jo},t.prototype.newSerializer=function(t){return new mi(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}())),ss(i),e.registerFirestore=ss},Wcq6:function(t,e,n){"use strict";var r,i=(r=n("wj3C"))&&"object"==typeof r&&"default"in r?r.default:r;t.exports=i},mrSG:function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",function(){return i}),n.d(e,"__assign",function(){return o}),n.d(e,"__rest",function(){return s}),n.d(e,"__decorate",function(){return a}),n.d(e,"__param",function(){return l}),n.d(e,"__metadata",function(){return u}),n.d(e,"__awaiter",function(){return c}),n.d(e,"__generator",function(){return h}),n.d(e,"__exportStar",function(){return d}),n.d(e,"__values",function(){return f}),n.d(e,"__read",function(){return p}),n.d(e,"__spread",function(){return m}),n.d(e,"__spreadArrays",function(){return g}),n.d(e,"__await",function(){return y}),n.d(e,"__asyncGenerator",function(){return v}),n.d(e,"__asyncDelegator",function(){return _}),n.d(e,"__asyncValues",function(){return b}),n.d(e,"__makeTemplateObject",function(){return w}),n.d(e,"__importStar",function(){return E}),n.d(e,"__importDefault",function(){return S});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function a(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}function l(t,e){return function(n,r){e(n,r,t)}}function u(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{l(r.next(t))}catch(e){o(e)}}function a(t){try{l(r.throw(t))}catch(e){o(e)}}function l(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}l((r=r.apply(t,e||[])).next())})}function h(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function d(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function f(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function p(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function m(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function g(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function y(t){return this instanceof y?(this.v=t,this):new y(t)}function v(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(t){i[t]&&(r[t]=function(e){return new Promise(function(n,r){o.push([t,e,n,r])>1||a(t,e)})})}function a(t,e){try{(n=i[t](e)).value instanceof y?Promise.resolve(n.value.v).then(l,u):c(o[0][2],n)}catch(r){c(o[0][3],r)}var n}function l(t){a("next",t)}function u(t){a("throw",t)}function c(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}}function _(t){var e,n;return e={},r("next"),r("throw",function(t){throw t}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:y(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=f(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise(function(r,i){!function(t,e,n,r){Promise.resolve(r).then(function(e){t({value:e,done:n})},e)}(r,i,(e=t[n](e)).done,e.value)})}}}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function E(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function S(t){return t&&t.__esModule?t:{default:t}}},"q/0M":function(t,e,n){"use strict";n.r(e),n.d(e,"LogLevel",function(){return i}),n.d(e,"Logger",function(){return a}),n.d(e,"setLogLevel",function(){return l});var r=[],i=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}({}),o=i.INFO,s=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var o=(new Date).toISOString();switch(e){case i.DEBUG:case i.VERBOSE:console.log.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case i.INFO:console.info.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case i.WARN:console.warn.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case i.ERROR:console.error.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},a=function(){function t(t){this.name=t,this._logLevel=o,this._logHandler=s,r.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in i))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.DEBUG].concat(t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.VERBOSE].concat(t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.INFO].concat(t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.WARN].concat(t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.ERROR].concat(t))},t}();function l(t){r.forEach(function(e){e.logLevel=t})}},wj3C:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n("mrSG"),o=n("zVF4"),s=n("q/0M"),a=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r),l=new o.ErrorFactory("app","Firebase",a),u="[DEFAULT]",c=[],h=function(){function t(t,e,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=o.deepCopy(t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){c.push(t),setTimeout(function(){return t(null)},0)},removeAuthTokenListener:function(t){c=c.filter(function(e){return e!==t})}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){t.firebase_.INTERNAL.removeApp(t.name_);for(var e=[],n=0,r=Object.keys(t.services_);n<r.length;n++)for(var i=r[n],o=0,s=Object.keys(t.services_[i]);o<s.length;o++)e.push(t.services_[i][s[o]]);return Promise.all(e.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}))}).then(function(){t.isDeleted_=!0,t.services_={}})},t.prototype._getService=function(t,e){if(void 0===e&&(e=u),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n=e!==u?e:void 0,r=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=r}return this.services_[t][e]},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=u),this.services_[t]&&this.services_[t][e]&&delete this.services_[t][e]},t.prototype.extendApp=function(t){var e=this;o.deepExtend(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(c.forEach(function(t){e.INTERNAL.addAuthTokenListener(t)}),c=[])},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{appName:this.name_})},t}();h.prototype.name&&h.prototype.options||h.prototype.delete||console.log("dc");var d=new s.Logger("@firebase/app");if(o.isBrowser()&&void 0!==self.firebase){d.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var f=self.firebase.SDK_VERSION;f&&f.indexOf("LITE")>=0&&d.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var p=function t(){var e=function(t){var e={},n={},r={},i={__esModule:!0,initializeApp:function(n,r){void 0===r&&(r={}),"object"==typeof r&&null!==r||(r={name:r});var s=r;void 0===s.name&&(s.name=u);var a=s.name;if("string"!=typeof a||!a)throw l.create("bad-app-name",{appName:String(a)});if(o.contains(e,a))throw l.create("duplicate-app",{appName:a});var h=new t(n,s,i);return e[a]=h,c(h,"create"),h},app:s,apps:null,SDK_VERSION:"6.6.0",INTERNAL:{registerService:function(e,u,c,h,f){if(void 0===f&&(f=!1),n[e])return d.debug("There were multiple attempts to register service "+e+"."),i[e];function p(t){if(void 0===t&&(t=s()),"function"!=typeof t[e])throw l.create("invalid-app-argument",{appName:e});return t[e]()}return n[e]=u,h&&(r[e]=h,a().forEach(function(t){h("create",t)})),void 0!==c&&o.deepExtend(p,c),i[e]=p,t.prototype[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this._getService.bind(this,e);return r.apply(this,f?t:[])},p},removeApp:function(t){c(e[t],"delete"),delete e[t]},factories:n,useAsService:h}};function s(t){if(!o.contains(e,t=t||u))throw l.create("no-app",{appName:t});return e[t]}function a(){return Object.keys(e).map(function(t){return e[t]})}function c(t,e){for(var i=0,o=Object.keys(n);i<o.length;i++){var s=h(0,o[i]);if(null===s)return;r[s]&&r[s](e,t)}}function h(t,e){return"serverAuth"===e?null:e}return i.default=i,Object.defineProperty(i,"apps",{get:a}),s.App=t,i}(h);return e.INTERNAL=i.__assign({},e.INTERNAL,{createFirebaseNamespace:t,extendNamespace:function(t){o.deepExtend(e,t)},createSubscribe:o.createSubscribe,ErrorFactory:o.ErrorFactory,deepExtend:o.deepExtend}),e}(),m=p.initializeApp;p.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.isNode()&&d.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),m.apply(void 0,t)};var g=p;e.default=g,e.firebase=g},x7I3:function(t,e,n){"use strict";n.r(e),n.d(e,"ErrorCode",function(){return ar}),n.d(e,"EventType",function(){return lr}),n.d(e,"WebChannel",function(){return ur}),n.d(e,"XhrIo",function(){return cr}),n.d(e,"createWebChannelTransport",function(){return sr});var r,i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o=o||{},s=i;function a(t){return"string"==typeof t}function l(t){return"number"==typeof t}function u(t,e){t=t.split("."),e=e||s;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function c(){}function h(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function d(t){return"array"==h(t)}function f(t){var e=h(t);return"array"==e||"object"==e&&"number"==typeof t.length}function p(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var m="closure_uid_"+(1e9*Math.random()>>>0),g=0;function y(t,e,n){return t.call.apply(t.bind,arguments)}function v(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function _(t,e,n){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?y:v).apply(null,arguments)}function b(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var w=Date.now||function(){return+new Date};function E(t,e){function n(){}n.prototype=e.prototype,t.N=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.yb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function S(){this.j=this.j,this.i=this.i}S.prototype.j=!1,S.prototype.la=function(){!this.j&&(this.j=!0,this.G(),0)&&(this[m]||(this[m]=++g))},S.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var C=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(a(t))return a(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},T=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=a(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function I(t){return Array.prototype.concat.apply([],arguments)}function x(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function A(t){return/^[\s\xa0]*$/.test(t)}var k,D=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function N(t,e){return-1!=t.indexOf(e)}function R(t,e){return t<e?-1:t>e?1:0}t:{var O=s.navigator;if(O){var P=O.userAgent;if(P){k=P;break t}}k=""}function M(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function L(t){var e,n={};for(e in t)n[e]=t[e];return n}var F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<F.length;o++)n=F[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function B(t){return B[" "](t),t}B[" "]=c;var U,q,j=N(k,"Opera"),z=N(k,"Trident")||N(k,"MSIE"),Q=N(k,"Edge"),H=Q||z,W=N(k,"Gecko")&&!(N(k.toLowerCase(),"webkit")&&!N(k,"Edge"))&&!(N(k,"Trident")||N(k,"MSIE"))&&!N(k,"Edge"),G=N(k.toLowerCase(),"webkit")&&!N(k,"Edge");function K(){var t=s.document;return t?t.documentMode:void 0}t:{var $="",Y=(q=k,W?/rv:([^\);]+)(\)|;)/.exec(q):Q?/Edge\/([\d\.]+)/.exec(q):z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(q):G?/WebKit\/(\S+)/.exec(q):j?/(?:Version)[ \/]?(\S+)/.exec(q):void 0);if(Y&&($=Y?Y[1]:""),z){var Z=K();if(null!=Z&&Z>parseFloat($)){U=String(Z);break t}}U=$}var X,J={};function tt(t){return function(t,e){var n=J;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=D(String(U)).split("."),r=D(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=R(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||R(0==s[2].length,0==a[2].length)||R(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e})}var et=s.document;X=et&&z?K()||("CSS1Compat"==et.compatMode?parseInt(U,10):5):void 0;var nt=!z||9<=Number(X),rt=z&&!tt("9"),it=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{s.addEventListener("test",c,e),s.removeEventListener("test",c,e)}catch(n){}return t}();function ot(t,e){this.type=t,this.a=this.target=e,this.Ja=!0}function st(t,e){if(ot.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(W){t:{try{B(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=a(t.pointerType)?t.pointerType:at[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}ot.prototype.b=function(){this.Ja=!1},E(st,ot);var at={2:"touch",3:"pen",4:"mouse"};st.prototype.b=function(){st.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,rt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var lt="closure_listenable_"+(1e6*Math.random()|0),ut=0;function ct(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++ut,this.X=this.Z=!1}function ht(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function dt(t){this.src=t,this.a={},this.b=0}function ft(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=C(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ht(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function pt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}dt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=pt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new ct(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var mt="closure_lm_"+(1e6*Math.random()|0),gt={};function yt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(d(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ct(r),e&&e[lt]?e.Ba(n,r,p(i)?!!i.capture:!!i,o):vt(e,n,r,!0,i,o)}(t,e,n,r,i);if(d(e)){for(var o=0;o<e.length;o++)yt(t,e[o],n,r,i);return null}return n=Ct(n),t&&t[lt]?t.Aa(e,n,p(r)?!!r.capture:!!r,i):vt(t,e,n,!1,r,i)}function vt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=p(i)?!!i.capture:!!i;if(s&&!nt)return null;var a=Et(t);if(a||(t[mt]=a=new dt(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=wt,e=nt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)it||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(bt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function _t(t){if(!l(t)&&t&&!t.X){var e=t.src;if(e&&e[lt])ft(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(bt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Et(e))?(ft(n,t),0==n.b&&(n.src=null,e[mt]=null)):ht(t)}}}function bt(t){return t in gt?gt[t]:gt[t]="on"+t}function wt(t,e){return!!t.X||function(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&_t(t),n.call(r,e)}(t,nt?new st(e,this):e=new st(e||u("window.event"),this))}function Et(t){return(t=t[mt])instanceof dt?t:null}var St="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ct(t){return"function"==h(t)?t:(t[St]||(t[St]=function(e){return t.handleEvent(e)}),t[St])}function Tt(){S.call(this),this.c=new dt(this),this.J=this,this.B=null}function It(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.X&&s.capture==n){var a=s.listener,l=s.da||s.src;s.Z&&ft(t.c,s),i=!1!==a.call(l,r)&&i}}return i&&0!=r.Ja}E(Tt,S),Tt.prototype[lt]=!0,(r=Tt.prototype).addEventListener=function(t,e,n,r){yt(this,t,e,n,r)},r.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(d(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=p(i)?!!i.capture:!!i,r=Ct(r),e&&e[lt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=pt(s=e.a[n],r,i,o))&&(ht(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):e&&(e=Et(e))&&(n=e.a[n.toString()],e=-1,n&&(e=pt(n,r,i,o)),(r=-1<e?n[e]:null)&&_t(r))}(this,t,e,n,r)},r.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(a(t))t=new ot(t,n);else if(t instanceof ot)t.target=t.target||n;else{var i=t;V(t=new ot(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=It(s,r,!0,t)&&i}if(i=It(s=t.a=n,r,!0,t)&&i,i=It(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=It(s=t.a=e[o],r,!1,t)&&i;return i},r.G=function(){if(Tt.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ht(n[r]);delete e.a[t],e.b--}}this.B=null},r.Aa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},r.Ba=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var xt=s.JSON.stringify;function At(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function kt(){this.b=this.a=null}At.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Dt,Nt=new At(function(){return new Ot},function(t){t.reset()});function Rt(){var t=Ft,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Ot(){this.next=this.b=this.a=null}function Pt(t){s.setTimeout(function(){throw t},0)}function Mt(t,e){Dt||function(){var t=s.Promise.resolve(void 0);Dt=function(){t.then(Vt)}}(),Lt||(Dt(),Lt=!0),Ft.add(t,e)}kt.prototype.add=function(t,e){var n=Nt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ot.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Ot.prototype.reset=function(){this.next=this.b=this.a=null};var Lt=!1,Ft=new kt;function Vt(){for(var t;t=Rt();){try{t.a.call(t.b)}catch(n){Pt(n)}var e=Nt;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Lt=!1}function Bt(t,e){Tt.call(this),this.b=t||1,this.a=e||s,this.f=_(this.gb,this),this.g=w()}function Ut(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function qt(t,e,n){if("function"==h(t))n&&(t=_(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_(t.handleEvent,t)}return 2147483647<Number(e)?-1:s.setTimeout(t,e||0)}function jt(t,e,n){S.call(this),this.f=null!=n?_(t,n):t,this.c=e,this.b=_(this.ab,this),this.a=[]}function zt(t){t.U=qt(t.b,t.c),t.f.apply(null,t.a)}function Qt(t){S.call(this),this.b=t,this.a={}}E(Bt,Tt),(r=Bt.prototype).ba=!1,r.L=null,r.gb=function(){if(this.ba){var t=w()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(Ut(this),this.start()))}},r.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=w())},r.G=function(){Bt.N.G.call(this),Ut(this),delete this.a},E(jt,S),(r=jt.prototype).ea=!1,r.U=null,r.Ua=function(t){this.a=arguments,this.U?this.ea=!0:zt(this)},r.G=function(){jt.N.G.call(this),this.U&&(s.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},r.ab=function(){this.U=null,this.ea&&(this.ea=!1,zt(this))},E(Qt,S);var Ht=[];function Wt(t,e,n,r){d(n)||(n&&(Ht[0]=n.toString()),n=Ht);for(var i=0;i<n.length;i++){var o=yt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Gt(t){M(t.a,function(t,e){this.a.hasOwnProperty(e)&&_t(t)},t),t.a={}}function Kt(){}Qt.prototype.G=function(){Qt.N.G.call(this),Gt(this)},Qt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var $t=new Tt;function Yt(t){ot.call(this,"serverreachability",t)}function Zt(t){$t.dispatchEvent(new Yt($t,t))}function Xt(t){ot.call(this,"statevent",t)}function Jt(t){$t.dispatchEvent(new Xt($t,t))}function te(t){ot.call(this,"timingevent",t)}function ee(t,e){if("function"!=h(t))throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){t()},e)}E(Yt,ot),E(Xt,ot),E(te,ot);var ne={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,Ma:7,TIMEOUT:8,sb:9},re={jb:"complete",wb:"success",Na:"error",Ma:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function ie(){}function oe(){}ie.prototype.a=null;var se,ae={OPEN:"a",ib:"b",Na:"c",rb:"d"};function le(){ot.call(this,"d")}function ue(){ot.call(this,"c")}function ce(){}function he(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new Qt(this),this.O=de,this.P=new Bt(t=H?125:void 0),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}E(le,ot),E(ue,ot),E(ce,ie),se=new ce;var de=45e3,fe={},pe={};function me(t,e,n){t.F=1,t.f=Ue(Oe(e)),t.l=n,t.H=!0,ye(t,null)}function ge(t,e,n,r){t.F=1,t.f=Ue(Oe(e)),t.l=null,t.H=n,ye(t,r)}function ye(t,e){t.v=w(),be(t),t.D=Oe(t.f),Be(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new jt(_(t.Ka,t,t.a),t.J)),Wt(t.I,t.a,"readystatechange",t.eb),e=t.h?L(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),Zt(1)}function ve(t,e,n){for(var r=!0;!t.m&&t.A<n.length;){var i=_e(t,n);if(i==pe){4==e&&(t.c=4,Jt(14),r=!1);break}if(i==fe){t.c=4,Jt(15),r=!1;break}Te(t,i)}4==e&&0==n.length&&(t.c=1,Jt(16),r=!1),t.b=t.b&&r,r||(Ce(t),Se(t))}function _e(t,e){var n=t.A,r=e.indexOf("\n",n);return-1==r?pe:(n=Number(e.substring(n,r)),isNaN(n)?fe:(r+=1)+n>e.length?pe:(e=e.substr(r,n),t.A=r+n,e))}function be(t){t.R=w()+t.O,we(t,t.O)}function we(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=ee(_(t.bb,t),e)}function Ee(t){t.i&&(s.clearTimeout(t.i),t.i=null)}function Se(t){t.g.Da()||t.m||t.g.na(t)}function Ce(t){Ee(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,Ut(t.P),Gt(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Te(t,e){try{t.g.Ga(t,e),Zt(4)}catch(n){}}function Ie(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(f(t)||a(t))T(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(f(t)||a(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(a(t))return t.split("");if(f(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function xe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof xe)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ae(t,e){De(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ke(t))}function ke(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];De(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)De(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function De(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(r=he.prototype).setTimeout=function(t){this.O=t},r.eb=function(t){t=t.target;var e=this.B;e&&3==On(t)?e.Ua():this.Ka(t)},r.Ka=function(t){try{if(t==this.a)t:{var e=On(this.a),n=this.a.ya(),r=this.a.T();if(!(3>e||3==e&&!H&&!this.a.aa())){this.m||4!=e||7==n||Zt(8==n||0>=r?3:2),Ee(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var s=Pn(this.a,"X-HTTP-Initial-Response");if(s&&!A(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,Jt(12),Ce(this),Se(this);break t}this.s=!0,Te(this,a)}this.H?(ve(this,e,o),H&&this.b&&3==e&&(Wt(this.I,this.P,"tick",this.cb),this.P.start())):Te(this,o),4==e&&Ce(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,be(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,Jt(12)):(this.c=0,Jt(13)),Ce(this),Se(this)}}}catch(l){}},r.cb=function(){if(this.a){var t=On(this.a),e=this.a.aa();this.A<e.length&&(Ee(this),ve(this,t,e),this.b&&4!=t&&be(this))}},r.cancel=function(){this.m=!0,Ce(this)},r.bb=function(){this.i=null;var t=w();0<=t-this.R?(2!=this.F&&(Zt(3),Jt(17)),Ce(this),this.c=2,Se(this)):we(this,this.R-t)},(r=xe.prototype).C=function(){ke(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},r.K=function(){return ke(this),this.a.concat()},r.get=function(t,e){return De(this.b,t)?this.b[t]:e},r.set=function(t,e){De(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},r.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ne=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Re(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof Re?(this.h=void 0!==e?e:t.h,Pe(this,t.f),this.j=t.j,Me(this,t.b),Le(this,t.i),this.a=t.a,Fe(this,tn(t.c)),this.g=t.g):t&&(n=String(t).match(Ne))?(this.h=!!e,Pe(this,n[1]||"",!0),this.j=qe(n[2]||""),Me(this,n[3]||"",!0),Le(this,n[4]),this.a=qe(n[5]||"",!0),Fe(this,n[6]||"",!0),this.g=qe(n[7]||"")):(this.h=!!e,this.c=new $e(null,this.h))}function Oe(t){return new Re(t)}function Pe(t,e,n){t.f=n?qe(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Me(t,e,n){t.b=n?qe(e,!0):e}function Le(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function Fe(t,e,n){e instanceof $e?(t.c=e,function(t,e){e&&!t.f&&(Ye(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Ze(this,e),Je(this,n,t))},t)),t.f=e}(t.c,t.h)):(n||(e=je(e,Ge)),t.c=new $e(e,t.h))}function Ve(t,e,n){t.c.set(e,n)}function Be(t,e,n){d(n)||(n=[String(n)]),Je(t.c,e,n)}function Ue(t){return Ve(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^w()).toString(36)),t}function qe(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function je(t,e,n){return a(t)?(t=encodeURI(t).replace(e,ze),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ze(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Re.prototype.toString=function(){var t=[],e=this.f;e&&t.push(je(e,Qe,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(je(e,Qe,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(je(n,"/"==n.charAt(0)?We:He,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",je(n,Ke)),t.join("")},Re.prototype.resolve=function(t){var e=Oe(this),n=!!t.f;n?Pe(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?Me(e,t.b):n=null!=t.i;var r=t.a;if(n)Le(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(N(i,"./")||N(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?Fe(e,tn(t.c)):n=!!t.g,n&&(e.g=t.g),e};var Qe=/[#\/\?@]/g,He=/[#\?:]/g,We=/[#\?]/g,Ge=/[#\?@]/g,Ke=/#/g;function $e(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Ye(t){t.a||(t.a=new xe,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Ze(t,e){Ye(t),e=en(t,e),De(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ae(t.a,e))}function Xe(t,e){return Ye(t),e=en(t,e),De(t.a.b,e)}function Je(t,e,n){Ze(t,e),0<n.length&&(t.c=null,t.a.set(en(t,e),x(n)),t.b+=n.length)}function tn(t){var e=new $e;return e.c=t.c,t.a&&(e.a=new xe(t.a),e.b=t.b),e}function en(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function nn(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function rn(t){var e=t.a.F.a;if(null!=e)Jt(4),e?(Jt(10),Wn(t.a,t,!1)):(Jt(11),Wn(t.a,t,!0));else{t.b=new he(t,void 0,void 0),t.b.h=t.h,e=Zn(e=t.a,e.Y()?t.f:null,t.i),Jt(4),Be(e,"TYPE","xmlhttp");var n=t.a.j,r=t.a.I;n&&r&&Ve(e,n,r),ge(t.b,e,!1,t.f)}}function on(){this.a=this.b=null}function sn(){this.a=new xe}function an(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[m]||(t[m]=++g)):e.charAt(0)+t}function ln(t,e){this.b=t,this.a=e}function un(t){this.g=t||cn,t=s.PerformanceNavigationTiming?0<(t=s.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(s.ka&&s.ka.Ea&&s.ka.Ea()&&s.ka.Ea().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new sn),this.b=null,this.c=[]}(r=$e.prototype).add=function(t,e){Ye(this),this.c=null,t=en(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},r.forEach=function(t,e){Ye(this),this.a.forEach(function(n,r){T(n,function(n){t.call(e,n,r,this)},this)},this)},r.K=function(){Ye(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},r.C=function(t){Ye(this);var e=[];if(a(t))Xe(this,t)&&(e=I(e,this.a.get(en(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=I(e,t[n])}return e},r.set=function(t,e){return Ye(this),this.c=null,Xe(this,t=en(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},r.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},r.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")},E(function(){},function(){}),(r=nn.prototype).M=null,r.$=function(t){return this.a.$(t)},r.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},r.Da=function(){return!1},r.Ga=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=Pn(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=Pn(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(i){return(e=this.a).m=this.c,void $n(e,2)}this.f=r[0]}else(e=this.a).m=this.c,$n(e,2)}else 1==this.M&&(this.g?Jt(6):"11111"==e?(Jt(5),this.g=!0,(!z||10<=Number(X))&&(this.c=200,this.b.cancel(),Jt(11),Wn(this.a,this,!0))):(Jt(7),this.g=!1))},r.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,rn(this)):1==this.M&&(this.g?(Jt(11),Wn(this.a,this,!0)):(Jt(10),Wn(this.a,this,!1)));else{0==this.M?Jt(8):1==this.M&&Jt(9);var t=this.a;t.m=this.c,$n(t,2)}},r.Y=function(){return this.a.Y()},r.ma=function(){return this.a.ma()},sn.prototype.add=function(t){this.a.set(an(t),t)},sn.prototype.C=function(){return this.a.C()};var cn=10;function hn(t,e){!t.a&&(N(e,"spdy")||N(e,"quic")||N(e,"h2"))&&(t.f=t.g,t.a=new sn,t.b&&(mn(t,t.b),t.b=null))}function dn(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function fn(t){return t.b?1:t.a?t.a.a.c:0}function pn(t,e){return t.b?t=t.b==e:t.a?(e=an(e),t=De(t.a.a.b,e)):t=!1,t}function mn(t,e){t.a?t.a.add(e):t.b=e}function gn(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=an(e),n=De(t.a.a.b,n)),n&&Ae(t.a.a,an(e)))}function yn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null!=t.a&&0!=t.a.a.c){var e=t.c;return T(t.a.C(),function(t){e=e.concat(t.j)}),e}return x(t.c)}function vn(){}function _n(){this.a=new vn}function bn(t,e,n){var r=n||"";try{Ie(t,function(t,n){var i=t;p(t)&&(i=xt(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function wn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}un.prototype.cancel=function(){this.c=yn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(T(this.a.C(),function(t){t.cancel()}),function(t){t.b={},t.a.length=0,t.c=0}(this.a.a))},vn.prototype.stringify=function(t){return s.JSON.stringify(t,void 0)},vn.prototype.parse=function(t){return s.JSON.parse(t,void 0)};var En=s.JSON.parse;function Sn(t){Tt.call(this),this.headers=new xe,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Cn,this.D=this.F=!1}E(Sn,Tt);var Cn="",Tn=/^https?$/i,In=["POST","PUT"];function xn(t){return"content-type"==t.toLowerCase()}function An(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,kn(t),Nn(t)}function kn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Dn(t){if(t.b&&void 0!==o&&(!t.s[1]||4!=On(t)||2!=t.T()))if(t.l&&4==On(t))qt(t.Fa,0,t);else if(t.dispatchEvent("readystatechange"),4==On(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var a=String(t.A).match(Ne)[1]||null;if(!a&&s.self&&s.self.location){var l=s.self.location.protocol;a=l.substr(0,l.length-1)}i=!Tn.test(a?a.toLowerCase():"")}e=i}e?(t.dispatchEvent("complete"),t.dispatchEvent("success")):(t.h=6,t.f=t.za()+" ["+t.T()+"]",kn(t))}finally{Nn(t)}}}function Nn(t,e){if(t.a){Rn(t);var n=t.a,r=t.s[0]?c:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function Rn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(s.clearTimeout(t.m),t.m=null)}function On(t){return t.a?t.a.readyState:0}function Pn(t,e){return t.a?t.a.getResponseHeader(e):null}function Mn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=function(t){var e="";return M(n,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(),a(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if(0>(n=t.indexOf("#"))&&(n=t.length),0>(r=t.indexOf("?"))||r>n){r=n;var i=""}else i=t.substring(r+1,n);n=(t=[t.substr(0,r),i,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return Ve(t,e,n),t}function Ln(t){this.f=[],this.F=new on,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Ra=this.P=0,this.Pa=!!u("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Oa=u("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Sa=u("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Qa=u("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=u("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.La=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new un(t&&t.concurrentRequestLimit),this.ja=new _n,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function Fn(t){if(Vn(t),3==t.u){var e=t.P++,n=Oe(t.B);Ve(n,"SID",t.H),Ve(n,"RID",e),Ve(n,"TYPE","terminate"),jn(t,n),(e=new he(t,e,void 0)).F=2,e.f=Ue(Oe(n)),n=!1,s.navigator&&s.navigator.sendBeacon&&(n=s.navigator.sendBeacon(e.f.toString(),"")),!n&&s.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=w(),be(e)}Yn(t)}function Vn(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(s.clearTimeout(t.l),t.l=null),Gn(t),t.b.cancel(),t.h&&(l(t.h)&&s.clearTimeout(t.h),t.h=null)}function Bn(t,e){t.f.push(new ln(t.Ra++,e)),3==t.u&&Un(t)}function Un(t){dn(t.b)||t.h||(t.h=!0,Mt(t.Ia,t),t.A=0)}function qn(t,e){var n;n=e?e.W:t.P++;var r=Oe(t.B);Ve(r,"SID",t.H),Ve(r,"RID",n),Ve(r,"AID",t.O),jn(t,r),t.g&&t.i&&Mn(r,t.g,t.i),n=new he(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=zn(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),mn(t.b,n),me(n,r,e)}function jn(t,e){t.c&&Ie({},function(t,n){Ve(e,n,t)})}function zn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?_(t.c.Ta,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var a=!0,l=0;l<n;l++){var u=i[l].b,c=i[l].a;if(0>(u-=o))o=Math.max(0,i[l].b-100),a=!1;else try{bn(c,s,"req"+u+"_")}catch(h){r&&r(c)}}if(a){r=s.join("&");break t}}return t=t.f.splice(0,n),e.j=t,r}function Qn(t){t.a||t.l||(t.S=1,Mt(t.Ha,t),t.v=0)}function Hn(t){return!(t.a||t.l||3<=t.v||(t.S++,t.l=ee(_(t.Ha,t),Kn(t,t.v)),t.v++,0))}function Wn(t,e,n){var r=e.l;r&&hn(t.b,r),t.ia=t.oa&&n,t.m=e.c,t.B=Zn(t,null,t.ha),Un(t)}function Gn(t){null!=t.s&&(s.clearTimeout(t.s),t.s=null)}function Kn(t,e){var n=t.Oa+Math.floor(Math.random()*t.Sa);return t.ma()||(n*=2),n*e}function $n(t,e){if(2==e){var n=null;t.c&&(n=null);var r=_(t.fb,t);n||(n=new Re("//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||Pe(n,"https"),Ue(n)),function(t,e){var n=new Kt;if(s.Image){var r=new Image;r.onload=b(wn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=b(wn,n,r,"TestLoadImage: error",!1,e),r.onabort=b(wn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=b(wn,n,r,"TestLoadImage: timeout",!1,e),s.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Jt(2);t.u=0,t.c&&t.c.ta(e),Yn(t),Vn(t)}function Yn(t){t.u=0,t.m=-1,t.c&&(0==yn(t.b).length&&0==t.f.length||(t.b.c.length=0,x(t.f),t.f.length=0),t.c.sa())}function Zn(t,e,n){var r=function(t){return t instanceof Re?Oe(t):new Re(t,void 0)}(n);if(""!=r.b)e&&Me(r,e+"."+r.b),Le(r,r.i);else{var i=s.location;r=function(t,e,n,r){var i=new Re(null,void 0);return t&&Pe(i,t),e&&Me(i,e),n&&Le(i,n),r&&(i.a=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&M(t.V,function(t,e){Ve(r,e,t)}),n=t.I,(e=t.j)&&n&&Ve(r,e,n),Ve(r,"VER",t.wa),jn(t,r),r}function Xn(){}function Jn(){if(z&&!(10<=Number(X)))throw Error("Environmental error: no available transport.")}function tr(t,e){Tt.call(this),this.a=new Ln(e),this.g=t,this.m=e&&e.testUrl?e.testUrl:function(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r,i=arguments[n];0==i.lastIndexOf("/",0)?e=i:((r=""==e)||(r=0<=(r=e.length-1)&&e.indexOf("/",r)==r),e+=r?i:"/"+i)}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!A(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!A(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new rr(this)}function er(t){le.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function nr(){ue.call(this),this.status=1}function rr(t){this.a=t}(r=Sn.prototype).ca=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:se),this.a.onreadystatechange=_(this.Fa,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(o){return void An(this,o)}t=n||"";var i=new xe(this.headers);r&&Ie(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=xn,n=t.length,r=a(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:a(t)?t.charAt(e):t[e]}(i.K()),n=s.FormData&&t instanceof s.FormData,!(0<=C(In,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Rn(this),0<this.o&&((this.D=function(t){return z&&tt(9)&&l(t.timeout)&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=_(this.Ca,this)):this.m=qt(this.Ca,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){An(this,o)}},r.Ca=function(){void 0!==o&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},r.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Nn(this))},r.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Nn(this,!0)),Sn.N.G.call(this)},r.Fa=function(){this.j||(this.w||this.l||this.g?Dn(this):this.$a())},r.$a=function(){Dn(this)},r.T=function(){try{return 2<On(this)?this.a.status:-1}catch(q){return-1}},r.za=function(){try{return 2<On(this)?this.a.statusText:""}catch(q){return""}},r.aa=function(){try{return this.a?this.a.responseText:""}catch(q){return""}},r.Va=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),En(e)}},r.ya=function(){return this.h},r.Ya=function(){return a(this.f)?this.f:String(this.f)},(r=Ln.prototype).wa=8,r.u=1,r.Da=function(){return 0==this.u},r.Ia=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random());var e,n=new he(this,t=this.P++,void 0),r=this.i;if(this.J&&(r?V(r=L(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&a(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=zn(this,n,e),Ve(i=Oe(this.B),"RID",t),Ve(i,"CVER",22),this.o&&this.j&&Ve(i,"X-HTTP-Session-Id",this.j),jn(this,i),this.g&&r&&Mn(i,this.g,r),mn(this.b,n),this.W?(Ve(i,"$req",e),Ve(i,"SID","null"),n.S=!0,me(n,i,null)):me(n,i,e),this.u=2}}else 3==this.u&&(t?qn(this,t):0==this.f.length||dn(this.b)||qn(this))},r.Ha=function(){this.l=null,this.a=new he(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=Oe(this.pa);Ve(t,"RID","rpc"),Ve(t,"SID",this.H),Ve(t,"CI",this.ia?"0":"1"),Ve(t,"AID",this.O),jn(this,t),Ve(t,"TYPE","xmlhttp"),this.g&&this.i&&Mn(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),ge(this.a,t,!0,this.ga)},r.Ga=function(t,e){if(0!=this.u&&(this.a==t||pn(this.b,t)))if(this.m=t.o,!t.s&&pn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(o){n=null}if(d(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;Gn(this),this.a.cancel(),this.a=null}Hn(this),Jt(18)}}else this.ra=e[1],0<this.ra-this.O&&37500>e[2]&&this.ia&&0==this.v&&!this.s&&(this.s=ee(_(this.Za,this),6e3));if(1>=fn(this.b)&&this.fa){try{this.fa()}catch(o){}this.fa=void 0}}else $n(this,11)}else if((t.s||this.a==t)&&Gn(this),!A(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&l(r)&&0<r&&(this.D=1.5*r),this.o&&(r=t.a)&&((i=Pn(r,"X-Client-Wire-Protocol"))&&hn(this.b,i),this.j&&(r=Pn(r,"X-HTTP-Session-Id")))&&(this.I=r,Ve(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=t,this.pa=Zn(this,this.Y()?this.ga:null,this.ha),r.s?(gn(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(Ee(r),be(r)),this.a=r):Qn(this),0<this.f.length&&Un(this)}else"stop"!=r[0]&&"close"!=r[0]||$n(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?$n(this,7):Fn(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},r.Za=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,Hn(this),Jt(19))},r.na=function(t){var e=null;if(this.a==t){Gn(this),this.a=null;var n=2}else{if(!pn(this.b,t))return;e=t.j,gn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=w()-t.v,$t.dispatchEvent(new te($t,t.l?t.l.length:0,e,this.A)),Un(this)):Qn(this);else{var r=t.c;if(3==r||0==r&&0<this.m||!(1==n&&function(t,e){return!(fn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.f=e.j.concat(t.f),0):1==t.u||2==t.u||t.A>=(t.Pa?0:t.Qa)||(t.h=ee(_(t.Ia,t,e),Kn(t,t.A)),t.A++,0)))}(this,t)||2==n&&Hn(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),r){case 1:$n(this,5);break;case 4:$n(this,10);break;case 3:$n(this,6);break;default:$n(this,2)}}},r.fb=function(t){Jt(t?2:1)},r.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Sn(this.La)).F=this.R,t},r.ma=function(){return!!this.c&&!0},r.Y=function(){return this.R},(r=Xn.prototype).va=function(){},r.ua=function(){},r.ta=function(){},r.sa=function(){},r.Ta=function(){},Jn.prototype.a=function(t,e){return new tr(t,e)},E(tr,Tt),(r=tr.prototype).addEventListener=function(t,e,n,r){tr.N.addEventListener.call(this,t,e,n,r)},r.removeEventListener=function(t,e,n,r){tr.N.removeEventListener.call(this,t,e,n,r)},r.Wa=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;Jt(0),t.ha=n,t.V=r||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new nn(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=Mn(e,t.g,t.i)),(t=t.w).i=n,e=Zn(t.a,null,t.i),Jt(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,rn(t)):(Be(e,"MODE","init"),!t.a.o&&t.a.j&&Be(e,"X-HTTP-Session-Id",t.a.j),t.b=new he(t,void 0,void 0),t.b.h=t.h,ge(t.b,e,!1,null),t.M=0)},r.close=function(){Fn(this.a)},r.Xa=function(t){if(a(t)){var e={};e.__data__=t,Bn(this.a,e)}else this.h?((e={}).__data__=xt(t),Bn(this.a,e)):Bn(this.a,t)},r.G=function(){this.a.c=null,delete this.f,Fn(this.a),delete this.a,tr.N.G.call(this)},E(er,le),E(nr,ue),E(rr,Xn),rr.prototype.va=function(){this.a.dispatchEvent("a")},rr.prototype.ua=function(t){this.a.dispatchEvent(new er(t))},rr.prototype.ta=function(t){this.a.dispatchEvent(new nr(t))},rr.prototype.sa=function(){this.a.dispatchEvent("b")};var ir=b(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},Jn);Jn.prototype.createWebChannel=Jn.prototype.a,tr.prototype.send=tr.prototype.Xa,tr.prototype.open=tr.prototype.Wa,tr.prototype.close=tr.prototype.close,ne.NO_ERROR=0,ne.TIMEOUT=8,ne.HTTP_ERROR=6,re.COMPLETE="complete",oe.EventType=ae,ae.OPEN="a",ae.CLOSE="b",ae.ERROR="c",ae.MESSAGE="d",Tt.prototype.listen=Tt.prototype.Aa,Sn.prototype.listenOnce=Sn.prototype.Ba,Sn.prototype.getLastError=Sn.prototype.Ya,Sn.prototype.getLastErrorCode=Sn.prototype.ya,Sn.prototype.getStatus=Sn.prototype.T,Sn.prototype.getStatusText=Sn.prototype.za,Sn.prototype.getResponseJson=Sn.prototype.Va,Sn.prototype.getResponseText=Sn.prototype.aa,Sn.prototype.send=Sn.prototype.ca;var or={createWebChannelTransport:ir,ErrorCode:ne,EventType:re,WebChannel:oe,XhrIo:Sn},sr=or.createWebChannelTransport,ar=or.ErrorCode,lr=or.EventType,ur=or.WebChannel,cr=or.XhrIo;e.default=or},zUnb:function(t,e,n){"use strict";function r(t){return"function"==typeof t}n.r(e);let i=!1;const o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else i&&console.log("RxJS: Back to a better error behavior. Thank you. <3");i=t},get useDeprecatedSynchronousErrorHandling(){return i}};function s(t){setTimeout(()=>{throw t})}const a={closed:!0,next(t){},error(t){if(o.useDeprecatedSynchronousErrorHandling)throw t;s(t)},complete(){}},l=Array.isArray||(t=>t&&"number"==typeof t.length);function u(t){return null!==t&&"object"==typeof t}function c(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}c.prototype=Object.create(Error.prototype);const h=c;let d=(()=>{class t{constructor(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}unsubscribe(){let t,e=!1;if(this.closed)return;let{_parent:n,_parents:i,_unsubscribe:o,_subscriptions:s}=this;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;let a=-1,c=i?i.length:0;for(;n;)n.remove(this),n=++a<c&&i[a]||null;if(r(o))try{o.call(this)}catch(d){e=!0,t=d instanceof h?f(d.errors):[d]}if(l(s))for(a=-1,c=s.length;++a<c;){const n=s[a];if(u(n))try{n.unsubscribe()}catch(d){e=!0,t=t||[],d instanceof h?t=t.concat(f(d.errors)):t.push(d)}}if(e)throw new h(t)}add(e){let n=e;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){const e=n;(n=new t)._subscriptions=[e]}break;default:if(!e)return t.EMPTY;throw new Error("unrecognized teardown "+e+" added to Subscription.")}if(n._addParent(this)){const t=this._subscriptions;t?t.push(n):this._subscriptions=[n]}return n}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}_addParent(t){let{_parent:e,_parents:n}=this;return e!==t&&(e?n?-1===n.indexOf(t)&&(n.push(t),!0):(this._parents=[t],!0):(this._parent=t,!0))}}return t.EMPTY=function(t){return t.closed=!0,t}(new t),t})();function f(t){return t.reduce((t,e)=>t.concat(e instanceof h?e.errors:e),[])}const p="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class m extends d{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a;break;case 1:if(!t){this.destination=a;break}if("object"==typeof t){t instanceof m?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new g(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new g(this,t,e,n)}}[p](){return this}static create(t,e,n){const r=new m(t,e,n);return r.syncErrorThrowable=!1,r}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parent:t,_parents:e}=this;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this}}class g extends m{constructor(t,e,n,i){let o;super(),this._parentSubscriber=t;let s=this;r(e)?o=e:e&&(o=e.next,n=e.error,i=e.complete,e!==a&&(r((s=Object.create(e)).unsubscribe)&&this.add(s.unsubscribe.bind(s)),s.unsubscribe=this.unsubscribe.bind(this))),this._context=s,this._next=o,this._error=n,this._complete=i}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;o.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=o;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):s(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;s(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);o.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),o.useDeprecatedSynchronousErrorHandling)throw n;s(n)}}__tryOrSetError(t,e,n){if(!o.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return o.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(s(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const y="function"==typeof Symbol&&Symbol.observable||"@@observable";function v(){}function _(...t){return b(t)}function b(t){return t?1===t.length?t[0]:function(e){return t.reduce((t,e)=>e(t),e)}:v}let w=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:r}=this,i=function(t,e,n){if(t){if(t instanceof m)return t;if(t[p])return t[p]()}return t||e||n?new m(t,e,n):new m(a)}(t,e,n);if(i.add(r?r.call(i,this.source):this.source||o.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),o.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}_trySubscribe(t){try{return this._subscribe(t)}catch(e){o.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof m?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=E(e))((e,n)=>{let r;r=this.subscribe(e=>{try{t(e)}catch(i){n(i),r&&r.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[y](){return this}pipe(...t){return 0===t.length?this:b(t)(this)}toPromise(t){return new(t=E(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function E(t){if(t||(t=o.Promise||Promise),!t)throw new Error("no Promise impl found");return t}function S(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}S.prototype=Object.create(Error.prototype);const C=S;class T extends d{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}class I extends m{constructor(t){super(t),this.destination=t}}let x=(()=>{class t extends w{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[p](){return new I(this)}lift(t){const e=new A(this,this);return e.operator=t,e}next(t){if(this.closed)throw new C;if(!this.isStopped){const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].next(t)}}error(t){if(this.closed)throw new C;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].error(t);this.observers.length=0}complete(){if(this.closed)throw new C;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let r=0;r<e;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new C;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new C;return this.hasError?(t.error(this.thrownError),d.EMPTY):this.isStopped?(t.complete(),d.EMPTY):(this.observers.push(t),new T(this,t))}asObservable(){const t=new w;return t.source=this,t}}return t.create=(t,e)=>new A(t,e),t})();class A extends x{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):d.EMPTY}}function k(t){return t&&"function"==typeof t.schedule}class D extends m{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}const N=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.closed||e.complete()},R=t=>e=>(t.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,s),e);function O(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const P=O(),M=t=>e=>{const n=t[P]();for(;;){const t=n.next();if(t.done){e.complete();break}if(e.next(t.value),e.closed)break}return"function"==typeof n.return&&e.add(()=>{n.return&&n.return()}),e},L=t=>e=>{const n=t[y]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)},F=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function V(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const B=t=>{if(t instanceof w)return e=>t._isScalar?(e.next(t.value),void e.complete()):t.subscribe(e);if(t&&"function"==typeof t[y])return L(t);if(F(t))return N(t);if(V(t))return R(t);if(t&&"function"==typeof t[P])return M(t);{const e=u(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected.`+" You can provide an Observable, Promise, Array, or Iterable.")}};function U(t,e,n,r,i=new D(t,n,r)){if(!i.closed)return B(e)(i)}class q extends m{notifyNext(t,e,n,r,i){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}function j(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new z(t,e))}}class z{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new Q(t,this.project,this.thisArg))}}class Q extends m{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}function H(t,e){return new w(e?n=>{const r=new d;let i=0;return r.add(e.schedule(function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()})),r}:N(t))}function W(t,e){if(!e)return t instanceof w?t:new w(B(t));if(null!=t){if(function(t){return t&&"function"==typeof t[y]}(t))return function(t,e){return new w(e?n=>{const r=new d;return r.add(e.schedule(()=>{const i=t[y]();r.add(i.subscribe({next(t){r.add(e.schedule(()=>n.next(t)))},error(t){r.add(e.schedule(()=>n.error(t)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r}:L(t))}(t,e);if(V(t))return function(t,e){return new w(e?n=>{const r=new d;return r.add(e.schedule(()=>t.then(t=>{r.add(e.schedule(()=>{n.next(t),r.add(e.schedule(()=>n.complete()))}))},t=>{r.add(e.schedule(()=>n.error(t)))}))),r}:R(t))}(t,e);if(F(t))return H(t,e);if(function(t){return t&&"function"==typeof t[P]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new w(e?n=>{const r=new d;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(e.schedule(()=>{i=t[P](),r.add(e.schedule(function(){if(n.closed)return;let t,e;try{const o=i.next();t=o.value,e=o.done}catch(r){return void n.error(r)}e?n.complete():(n.next(t),this.schedule())}))})),r}:M(t))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function G(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?r=>r.pipe(G((n,r)=>W(t(n,r)).pipe(j((t,i)=>e(n,t,r,i))),n)):("number"==typeof e&&(n=e),e=>e.lift(new K(t,n)))}class K{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new $(t,this.project,this.concurrent))}}class $ extends q{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e,t,n)}_innerSub(t,e,n){const r=new D(this,void 0,void 0);this.destination.add(r),U(this,t,e,n,r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t,e,n,r,i){this.destination.next(e)}notifyComplete(t){const e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function Y(t){return t}function Z(t=Number.POSITIVE_INFINITY){return G(Y,t)}function X(...t){let e=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return k(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof r&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof w?t[0]:Z(e)(H(t,n))}function J(){return function(t){return t.lift(new tt(t))}}class tt{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const r=new et(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i}}class et extends m{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}const nt=class extends w{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new d).add(this.source.subscribe(new it(this.getSubject(),this))),t.closed?(this._connection=null,t=d.EMPTY):this._connection=t),t}refCount(){return J()(this)}}.prototype,rt={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:nt._subscribe},_isComplete:{value:nt._isComplete,writable:!0},getSubject:{value:nt.getSubject},connect:{value:nt.connect},refCount:{value:nt.refCount}};class it extends I{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function ot(){return new x}function st(){return t=>J()(function(t,e){return function(e){let n;n="function"==typeof t?t:function(){return t};const r=Object.create(e,rt);return r.source=e,r.subjectFactory=n,r}}(ot)(t))}const at="__parameters__";function lt(t,e,n){const r=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function i(...t){if(this instanceof i)return r.apply(this,t),this;const e=new i(...t);return n.annotation=e,n;function n(t,n,r){const i=t.hasOwnProperty(at)?t[at]:Object.defineProperty(t,at,{value:[]})[at];for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(e),t}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i}const ut=lt("Inject",t=>({token:t})),ct=lt("Optional"),ht=lt("Self"),dt=lt("SkipSelf");var ft=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});function pt(t){for(let e in t)if(t[e]===pt)return e;throw Error("Could not find renamed property on target object.")}function mt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function gt(t){const e=t[yt];return e&&e.token===t?e:null}const yt=pt({ngInjectableDef:pt});function vt(t){if("string"==typeof t)return t;if(t instanceof Array)return"["+t.map(vt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}const _t=pt({__forward_ref__:pt});function bt(t){return t.__forward_ref__=bt,t.toString=function(){return vt(this())},t}function wt(t){const e=t;return"function"==typeof e&&e.hasOwnProperty(_t)&&e.__forward_ref__===bt?e():t}const Et="undefined"!=typeof globalThis&&globalThis,St="undefined"!=typeof window&&window,Ct="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Tt="undefined"!=typeof global&&global,It=Et||Tt||St||Ct;class xt{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.ngInjectableDef=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.ngInjectableDef=mt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}const At=new xt("INJECTOR",-1),kt=new Object,Dt="ngTempTokenPath",Nt="ngTokenPath",Rt=/\n/gm,Ot="\u0275",Pt="__source",Mt=pt({provide:String,useValue:pt});let Lt,Ft=void 0;function Vt(t){const e=Ft;return Ft=t,e}function Bt(t,e=ft.Default){return(Lt||function(t,e=ft.Default){if(void 0===Ft)throw new Error("inject() must be called from an injection context");return null===Ft?function(t,e,n){const r=gt(t);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&ft.Optional)return null;throw new Error(`Injector: NOT_FOUND [${vt(t)}]`)}(t,0,e):Ft.get(t,e&ft.Optional?null:void 0,e)})(t,e)}const Ut=Bt;class qt{get(t,e=kt){if(e===kt){const e=new Error(`NullInjectorError: No provider for ${vt(t)}!`);throw e.name="NullInjectorError",e}return e}}function jt(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&t.charAt(1)==Ot?t.substr(2):t;let i=vt(e);if(e instanceof Array)i=e.map(vt).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];t.push(n+":"+("string"==typeof r?JSON.stringify(r):vt(r)))}i=`{${t.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(Rt,"\n  ")}`}class zt{}class Qt{}function Ht(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Wt(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}const Gt=function(){var t={Emulated:0,Native:1,None:2,ShadowDom:3};return t[t.Emulated]="Emulated",t[t.Native]="Native",t[t.None]="None",t[t.ShadowDom]="ShadowDom",t}(),Kt=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(It))(),$t="ngDebugContext",Yt="ngOriginalError",Zt="ngErrorLogger";function Xt(t){return t[$t]}function Jt(t){return t[Yt]}function te(t,...e){t.error(...e)}class ee{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t[Zt]||te}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?Xt(t)?Xt(t):this._findContext(Jt(t)):null}_findOriginalError(t){let e=Jt(t);for(;e&&Jt(e);)e=Jt(e);return e}}let ne=!0,re=!1;function ie(){return re=!0,ne}class oe{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),this.inertBodyElement=this.inertDocument.body,null==this.inertBodyElement){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t),this.inertBodyElement=this.inertDocument.createElement("body"),t.appendChild(this.inertBodyElement)}this.inertBodyElement.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!this.inertBodyElement.querySelector||this.inertBodyElement.querySelector("svg")?(this.inertBodyElement.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=this.inertBodyElement.querySelector&&this.inertBodyElement.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(t){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}getInertBodyElement_XHR(t){t="<body><remove></remove>"+t+"</body>";try{t=encodeURI(t)}catch(r){return null}const e=new XMLHttpRequest;e.responseType="document",e.open("GET","data:text/html;charset=utf-8,"+t,!1),e.send(void 0);const n=e.response.body;return n.removeChild(n.firstChild),n}getInertBodyElement_DOMParser(t){t="<body><remove></remove>"+t+"</body>";try{const n=(new window.DOMParser).parseFromString(t,"text/html").body;return n.removeChild(n.firstChild),n}catch(e){return null}}getInertBodyElement_InertDocument(t){const e=this.inertDocument.createElement("template");return"content"in e?(e.innerHTML=t,e):(this.inertBodyElement.innerHTML=t,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(this.inertBodyElement),this.inertBodyElement)}stripCustomNsAttrs(t){const e=t.attributes;for(let r=e.length-1;0<r;r--){const n=e.item(r).name;"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||t.removeAttribute(n)}let n=t.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const se=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:\/?#]*(?:[\/?#]|$))/gi,ae=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function le(t){return(t=String(t)).match(se)||t.match(ae)?t:(ie()&&console.warn(`WARNING: sanitizing unsafe URL value ${t} (see http://g.co/ng/security#xss)`),"unsafe:"+t)}function ue(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function ce(...t){const e={};for(const n of t)for(const t in n)n.hasOwnProperty(t)&&(e[t]=!0);return e}const he=ue("area,br,col,hr,img,wbr"),de=ue("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),fe=ue("rp,rt"),pe=ce(fe,de),me=ce(he,ce(de,ue("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ce(fe,ue("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),pe),ge=ue("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ye=ue("srcset"),ve=ce(ge,ye,ue("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ue("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),_e=ue("script,style,template");class be{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let t=this.checkClobberedElement(e,e.nextSibling);if(t){e=t;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!me.hasOwnProperty(e))return this.sanitizedSomething=!0,!_e.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let i=0;i<n.length;i++){const t=n.item(i),e=t.name,o=e.toLowerCase();if(!ve.hasOwnProperty(o)){this.sanitizedSomething=!0;continue}let s=t.value;ge[o]&&(s=le(s)),ye[o]&&(r=s,s=(r=String(r)).split(",").map(t=>le(t.trim())).join(", ")),this.buf.push(" ",e,'="',Se(s),'"')}var r;return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();me.hasOwnProperty(e)&&!he.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(Se(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const we=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Ee=/([^\#-~ |!])/g;function Se(t){return t.replace(/&/g,"&amp;").replace(we,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(Ee,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Ce;function Te(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}const Ie=function(){var t={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return t[t.NONE]="NONE",t[t.HTML]="HTML",t[t.STYLE]="STYLE",t[t.SCRIPT]="SCRIPT",t[t.URL]="URL",t[t.RESOURCE_URL]="RESOURCE_URL",t}();class xe{}const Ae=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:calc|attr))\\([-0-9.%, #a-zA-Z]+\\))$","g"),ke=/^url\(([^)]+)\)$/,De=/([A-Z])/g;function Ne(t){try{return null!=t?t.toString().slice(0,30):t}catch(e){return"[ERROR] Exception while trying to serialize the value"}}let Re=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Oe(),t})();const Oe=(...t)=>{},Pe=new xt("The presence of this token marks an injector as being the root injector."),Me=function(t,e,n){return new je(t,e,n)};let Le=(()=>{class t{static create(t,e){return Array.isArray(t)?Me(t,e,""):Me(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=kt,t.NULL=new qt,t.ngInjectableDef=mt({token:t,providedIn:"any",factory:()=>Bt(At)}),t.__NG_ELEMENT_ID__=-1,t})();const Fe=function(t){return t},Ve=[],Be=Fe,Ue=function(){return Array.prototype.slice.call(arguments)},qe="\u0275";class je{constructor(t,e=Le.NULL,n=null){this.parent=e,this.source=n;const r=this._records=new Map;r.set(Le,{token:Le,fn:Fe,deps:Ve,value:this,useNew:!1}),r.set(At,{token:At,fn:Fe,deps:Ve,value:this,useNew:!1}),function t(e,n){if(n)if((n=wt(n))instanceof Array)for(let r=0;r<n.length;r++)t(e,n[r]);else{if("function"==typeof n)throw Qe("Function/Class not supported",n);if(!n||"object"!=typeof n||!n.provide)throw Qe("Unexpected provider",n);{let t=wt(n.provide);const r=function(t){const e=function(t){let e=Ve;const n=t.deps;if(n&&n.length){e=[];for(let t=0;t<n.length;t++){let r=6,i=wt(n[t]);if(i instanceof Array)for(let t=0,e=i;t<e.length;t++){const n=e[t];n instanceof ct||n==ct?r|=1:n instanceof dt||n==dt?r&=-3:n instanceof ht||n==ht?r&=-5:i=n instanceof ut?n.token:wt(n)}e.push({token:i,options:r})}}else if(t.useExisting)e=[{token:wt(t.useExisting),options:6}];else if(!(n||Mt in t))throw Qe("'deps' required",t);return e}(t);let n=Fe,r=Ve,i=!1,o=wt(t.provide);if(Mt in t)r=t.useValue;else if(t.useFactory)n=t.useFactory;else if(t.useExisting);else if(t.useClass)i=!0,n=wt(t.useClass);else{if("function"!=typeof o)throw Qe("StaticProvider does not have [useValue|useFactory|useExisting|useClass] or [provide] is not newable",t);i=!0,n=o}return{deps:e,fn:n,useNew:i,value:r}}(n);if(!0===n.multi){let r=e.get(t);if(r){if(r.fn!==Ue)throw ze(t)}else e.set(t,r={token:n.provide,deps:[],useNew:!1,fn:Ue,value:Ve});r.deps.push({token:t=n,options:6})}const i=e.get(t);if(i&&i.fn==Ue)throw ze(t);e.set(t,r)}}}(r,t)}get(t,e,n=ft.Default){const r=this._records.get(t);try{return function t(e,n,r,i,o,s){try{return function(e,n,r,i,o,s){let a;if(!n||s&ft.SkipSelf)s&ft.Self||(a=i.get(e,o,ft.Default));else{if((a=n.value)==Be)throw Error(qe+"Circular dependency");if(a===Ve){n.value=Be;let e=void 0,o=n.useNew,s=n.fn,l=n.deps,u=Ve;if(l.length){u=[];for(let e=0;e<l.length;e++){const n=l[e],o=n.options,s=2&o?r.get(n.token):void 0;u.push(t(n.token,s,r,s||4&o?i:Le.NULL,1&o?null:Le.THROW_IF_NOT_FOUND,ft.Default))}}n.value=a=o?new s(...u):s.apply(e,u)}}return a}(e,n,r,i,o,s)}catch(a){throw a instanceof Error||(a=new Error(a)),(a[Dt]=a[Dt]||[]).unshift(e),n&&n.value==Be&&(n.value=Ve),a}}(t,r,this._records,this.parent,e,n)}catch(i){return function(t,e,n,r){const i=t[Dt];throw e[Pt]&&i.unshift(e[Pt]),t.message=jt("\n"+t.message,i,"StaticInjectorError",r),t[Nt]=i,t[Dt]=null,t}(i,t,0,this.source)}}toString(){const t=[];return this._records.forEach((e,n)=>t.push(vt(n))),`StaticInjector[${t.join(", ")}]`}}function ze(t){return Qe("Cannot mix multi providers and regular providers",t)}function Qe(t,e){return new Error(jt(t,e,"StaticInjectorError"))}const He=new xt("AnalyzeForEntryComponents");let We=null;function Ge(){if(!We){const t=It.Symbol;if(t&&t.iterator)We=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(We=n)}}}return We}function Ke(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}function $e(t,e){const n=Ze(t),r=Ze(e);if(n&&r)return function(t,e,n){const r=t[Ge()](),i=e[Ge()]();for(;;){const t=r.next(),e=i.next();if(t.done&&e.done)return!0;if(t.done||e.done)return!1;if(!n(t.value,e.value))return!1}}(t,e,$e);{const i=t&&("object"==typeof t||"function"==typeof t),o=e&&("object"==typeof e||"function"==typeof e);return!(n||!i||r||!o)||Ke(t,e)}}class Ye{constructor(t){this.wrapped=t}static wrap(t){return new Ye(t)}static unwrap(t){return Ye.isWrapped(t)?t.wrapped:t}static isWrapped(t){return t instanceof Ye}}function Ze(t){return!!Xe(t)&&(Array.isArray(t)||!(t instanceof Map)&&Ge()in t)}function Xe(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Je(t){return!!t&&"function"==typeof t.then}function tn(t){return!!t&&"function"==typeof t.subscribe}class en{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}class nn{}class rn{}function on(t){const e=Error(`No component factory found for ${vt(t)}. Did you add it to @NgModule.entryComponents?`);return e[sn]=t,e}const sn="ngComponent";class an{resolveComponentFactory(t){throw on(t)}}let ln=(()=>{class t{}return t.NULL=new an,t})();class un{constructor(t,e,n){this._parent=e,this._ngModule=n,this._factories=new Map;for(let r=0;r<t.length;r++){const e=t[r];this._factories.set(e.componentType,e)}}resolveComponentFactory(t){let e=this._factories.get(t);if(!e&&this._parent&&(e=this._parent.resolveComponentFactory(t)),!e)throw on(t);return new cn(e,this._ngModule)}}class cn extends rn{constructor(t,e){super(),this.factory=t,this.ngModule=e,this.selector=t.selector,this.componentType=t.componentType,this.ngContentSelectors=t.ngContentSelectors,this.inputs=t.inputs,this.outputs=t.outputs}create(t,e,n,r){return this.factory.create(t,e,n,r||this.ngModule)}}function hn(...t){}let dn=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=()=>fn(t),t})();const fn=hn;class pn{}class mn{}const gn=function(){var t={Important:1,DashCase:2};return t[t.Important]="Important",t[t.DashCase]="DashCase",t}();let yn=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>vn(),t})();const vn=hn;class _n{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const bn=new _n("8.2.5");class wn{constructor(){}supports(t){return Ze(t)}create(t){return new Sn(t)}}const En=(t,e)=>e;class Sn{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||En}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,r=0,i=null;for(;e||n;){const o=!n||e&&e.currentIndex<xn(n,r,i)?e:n,s=xn(o,r,i),a=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(e=e._next,null==o.previousIndex)r++;else{i||(i=[]);const t=s-r,e=a-r;if(t!=e){for(let n=0;n<t;n++){const r=n<i.length?i[n]:i[n]=0,o=r+n;e<=o&&o<t&&(i[n]=r+1)}i[o.previousIndex]=e-t}}s!==a&&t(o,s,a)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Ze(t))throw new Error(`Error trying to diff '${vt(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,r,i=this._itHead,o=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)r=this._trackByFn(e,n=t[e]),null!==i&&Ke(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,n,r,e)),Ke(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,e),o=!0),i=i._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Ge()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(t,t=>{r=this._trackByFn(e,t),null!==i&&Ke(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,t,r,e)),Ke(i.item,t)||this._addIdentityChange(i,t)):(i=this._mismatch(i,t,r,e),o=!0),i=i._next,e++}),this.length=e;return this._truncate(i),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t,e;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=e)t.previousIndex=t.currentIndex,e=t._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,r){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Ke(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,r)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Ke(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,r)):t=this._addAfter(new Cn(e,n),i,r),t}_verifyReinsertion(t,e,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?t=this._reinsertAfter(i,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,i=t._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new In),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e?t:(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t,t)}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new In),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Cn{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Tn{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Ke(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class In{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new Tn,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function xn(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}class An{constructor(){}supports(t){return t instanceof Map||Xe(t)}create(){return new kn}}class kn{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Xe(t)))throw new Error(`Error trying to diff '${vt(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const r=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,r)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new Dn(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Ke(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class Dn{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let Nn=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,n)},deps:[[t,new dt,new ct]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${n=t,n.name||typeof n}'`);var n}}return t.ngInjectableDef=mt({token:t,providedIn:"root",factory:()=>new t([new wn])}),t})(),Rn=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,n)},deps:[[t,new dt,new ct]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.ngInjectableDef=mt({token:t,providedIn:"root",factory:()=>new t([new An])}),t})();const On=[new An],Pn=new Nn([new wn]),Mn=new Rn(On);let Ln=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Fn(t,dn),t})();const Fn=hn;let Vn=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Bn(t,dn),t})();const Bn=hn;function Un(t,e,n,r){let i=`ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked. Previous value: '${e}'. Current value: '${n}'.`;return r&&(i+=" It seems like the view has been created after its parent and its children have been dirty checked. Has it been created in a change detection hook ?"),function(t,e){const n=new Error(t);return qn(n,e),n}(i,t)}function qn(t,e){t[$t]=e,t[Zt]=e.logError.bind(e)}function jn(t){return new Error(`ViewDestroyedError: Attempt to use a destroyed view: ${t}`)}function zn(t,e,n){const r=t.state,i=1792&r;return i===e?(t.state=-1793&r|n,t.initIndex=-1,!0):i===n}function Qn(t,e,n){return(1792&t.state)===e&&t.initIndex<=n&&(t.initIndex=n+1,!0)}function Hn(t,e){return t.nodes[e]}function Wn(t,e){return t.nodes[e]}function Gn(t,e){return t.nodes[e]}function Kn(t,e){return t.nodes[e]}function $n(t,e){return t.nodes[e]}const Yn={setCurrentNode:void 0,createRootView:void 0,createEmbeddedView:void 0,createComponentView:void 0,createNgModuleRef:void 0,overrideProvider:void 0,overrideComponentView:void 0,clearOverrides:void 0,checkAndUpdateView:void 0,checkNoChangesView:void 0,destroyView:void 0,resolveDep:void 0,createDebugContext:void 0,handleEvent:void 0,updateDirectives:void 0,updateRenderer:void 0,dirtyParentQueries:void 0},Zn=()=>{},Xn=new Map;function Jn(t){let e=Xn.get(t);return e||(e=vt(t)+"_"+Xn.size,Xn.set(t,e)),e}const tr="$$undefined",er="$$empty";function nr(t){return{id:tr,styles:t.styles,encapsulation:t.encapsulation,data:t.data}}let rr=0;function ir(t,e,n,r){return!(!(2&t.state)&&Ke(t.oldValues[e.bindingIndex+n],r))}function or(t,e,n,r){return!!ir(t,e,n,r)&&(t.oldValues[e.bindingIndex+n]=r,!0)}function sr(t,e,n,r){const i=t.oldValues[e.bindingIndex+n];if(1&t.state||!$e(i,r)){const o=e.bindings[n].name;throw Un(Yn.createDebugContext(t,e.nodeIndex),`${o}: ${i}`,`${o}: ${r}`,0!=(1&t.state))}}function ar(t){let e=t;for(;e;)2&e.def.flags&&(e.state|=8),e=e.viewContainerParent||e.parent}function lr(t,e){let n=t;for(;n&&n!==e;)n.state|=64,n=n.viewContainerParent||n.parent}function ur(t,e,n,r){try{return ar(33554432&t.def.nodes[e].flags?Wn(t,e).componentView:t),Yn.handleEvent(t,e,n,r)}catch(i){t.root.errorHandler.handleError(i)}}function cr(t){return t.parent?Wn(t.parent,t.parentNodeDef.nodeIndex):null}function hr(t){return t.parent?t.parentNodeDef.parent:null}function dr(t,e){switch(201347067&e.flags){case 1:return Wn(t,e.nodeIndex).renderElement;case 2:return Hn(t,e.nodeIndex).renderText}}function fr(t){return!!t.parent&&!!(32768&t.parentNodeDef.flags)}function pr(t){return!(!t.parent||32768&t.parentNodeDef.flags)}function mr(t){return 1<<t%32}function gr(t){const e={};let n=0;const r={};return t&&t.forEach(([t,i])=>{"number"==typeof t?(e[t]=i,n|=mr(t)):r[t]=i}),{matchedQueries:e,references:r,matchedQueryIds:n}}function yr(t,e){return t.map(t=>{let n,r;return Array.isArray(t)?[r,n]=t:(r=0,n=t),n&&("function"==typeof n||"object"==typeof n)&&e&&Object.defineProperty(n,Pt,{value:e,configurable:!0}),{flags:r,token:n,tokenKey:Jn(n)}})}function vr(t,e,n){let r=n.renderParent;return r?0==(1&r.flags)||0==(33554432&r.flags)||r.element.componentRendererType&&r.element.componentRendererType.encapsulation===Gt.Native?Wn(t,n.renderParent.nodeIndex).renderElement:void 0:e}const _r=new WeakMap;function br(t){let e=_r.get(t);return e||((e=t(()=>Zn)).factory=t,_r.set(t,e)),e}function wr(t,e,n,r,i){3===e&&(n=t.renderer.parentNode(dr(t,t.def.lastRenderRootNode))),Er(t,e,0,t.def.nodes.length-1,n,r,i)}function Er(t,e,n,r,i,o,s){for(let a=n;a<=r;a++){const n=t.def.nodes[a];11&n.flags&&Cr(t,n,e,i,o,s),a+=n.childCount}}function Sr(t,e,n,r,i,o){let s=t;for(;s&&!fr(s);)s=s.parent;const a=s.parent,l=hr(s),u=l.nodeIndex+l.childCount;for(let c=l.nodeIndex+1;c<=u;c++){const t=a.def.nodes[c];t.ngContentIndex===e&&Cr(a,t,n,r,i,o),c+=t.childCount}if(!a.parent){const s=t.root.projectableNodes[e];if(s)for(let e=0;e<s.length;e++)Tr(t,s[e],n,r,i,o)}}function Cr(t,e,n,r,i,o){if(8&e.flags)Sr(t,e.ngContent.index,n,r,i,o);else{const s=dr(t,e);if(3===n&&33554432&e.flags&&48&e.bindingFlags?(16&e.bindingFlags&&Tr(t,s,n,r,i,o),32&e.bindingFlags&&Tr(Wn(t,e.nodeIndex).componentView,s,n,r,i,o)):Tr(t,s,n,r,i,o),16777216&e.flags){const s=Wn(t,e.nodeIndex).viewContainer._embeddedViews;for(let t=0;t<s.length;t++)wr(s[t],n,r,i,o)}1&e.flags&&!e.element.name&&Er(t,n,e.nodeIndex+1,e.nodeIndex+e.childCount,r,i,o)}}function Tr(t,e,n,r,i,o){const s=t.renderer;switch(n){case 1:s.appendChild(r,e);break;case 2:s.insertBefore(r,e,i);break;case 3:s.removeChild(r,e);break;case 0:o.push(e)}}const Ir=/^:([^:]+):(.+)$/;function xr(t){if(":"===t[0]){const e=t.match(Ir);return[e[1],e[2]]}return["",t]}function Ar(t){let e=0;for(let n=0;n<t.length;n++)e|=t[n].flags;return e}const kr=new Object,Dr=Jn(Le),Nr=Jn(At),Rr=Jn(zt);function Or(t,e,n,r){return n=wt(n),{index:-1,deps:yr(r,vt(e)),flags:t,token:e,value:n}}function Pr(t,e,n=Le.THROW_IF_NOT_FOUND){const r=Vt(t);try{if(8&e.flags)return e.token;if(2&e.flags&&(n=null),1&e.flags)return t._parent.get(e.token,n);const s=e.tokenKey;switch(s){case Dr:case Nr:case Rr:return t}const a=t._def.providersByKey[s];let l;if(a){let e=t._providers[a.index];return void 0===e&&(e=t._providers[a.index]=Mr(t,a)),e===kr?void 0:e}if((l=gt(e.token))&&(i=t,null!=(o=l).providedIn&&(function(t,e){return t._def.modules.indexOf(o.providedIn)>-1}(i)||"root"===o.providedIn&&i._def.isRoot))){const n=t._providers.length;return t._def.providers[n]=t._def.providersByKey[e.tokenKey]={flags:5120,value:l.factory,deps:[],index:n,token:e.token},t._providers[n]=kr,t._providers[n]=Mr(t,t._def.providersByKey[e.tokenKey])}return 4&e.flags?n:t._parent.get(e.token,n)}finally{Vt(r)}var i,o}function Mr(t,e){let n;switch(201347067&e.flags){case 512:n=function(t,e,n){const r=n.length;switch(r){case 0:return new e;case 1:return new e(Pr(t,n[0]));case 2:return new e(Pr(t,n[0]),Pr(t,n[1]));case 3:return new e(Pr(t,n[0]),Pr(t,n[1]),Pr(t,n[2]));default:const i=new Array(r);for(let e=0;e<r;e++)i[e]=Pr(t,n[e]);return new e(...i)}}(t,e.value,e.deps);break;case 1024:n=function(t,e,n){const r=n.length;switch(r){case 0:return e();case 1:return e(Pr(t,n[0]));case 2:return e(Pr(t,n[0]),Pr(t,n[1]));case 3:return e(Pr(t,n[0]),Pr(t,n[1]),Pr(t,n[2]));default:const i=Array(r);for(let e=0;e<r;e++)i[e]=Pr(t,n[e]);return e(...i)}}(t,e.value,e.deps);break;case 2048:n=Pr(t,e.deps[0]);break;case 256:n=e.value}return n===kr||null===n||"object"!=typeof n||131072&e.flags||"function"!=typeof n.ngOnDestroy||(e.flags|=131072),void 0===n?kr:n}function Lr(t,e){const n=t.viewContainer._embeddedViews;if((null==e||e>=n.length)&&(e=n.length-1),e<0)return null;const r=n[e];return r.viewContainerParent=null,Wt(n,e),Yn.dirtyParentQueries(r),Vr(r),r}function Fr(t,e,n){const r=e?dr(e,e.def.lastRenderRootNode):t.renderElement,i=n.renderer.parentNode(r),o=n.renderer.nextSibling(r);wr(n,2,i,o,void 0)}function Vr(t){wr(t,3,null,null,void 0)}const Br=new Object;function Ur(t,e,n,r,i,o){return new qr(t,e,n,r,i,o)}class qr extends rn{constructor(t,e,n,r,i,o){super(),this.selector=t,this.componentType=e,this._inputs=r,this._outputs=i,this.ngContentSelectors=o,this.viewDefFactory=n}get inputs(){const t=[],e=this._inputs;for(let n in e)t.push({propName:n,templateName:e[n]});return t}get outputs(){const t=[];for(let e in this._outputs)t.push({propName:e,templateName:this._outputs[e]});return t}create(t,e,n,r){if(!r)throw new Error("ngModule should be provided");const i=br(this.viewDefFactory),o=i.nodes[0].element.componentProvider.nodeIndex,s=Yn.createRootView(t,e||[],n,i,r,Br),a=Gn(s,o).instance;return n&&s.renderer.setAttribute(Wn(s,0).renderElement,"ng-version",bn.full),new jr(s,new Wr(s),a)}}class jr extends nn{constructor(t,e,n){super(),this._view=t,this._viewRef=e,this._component=n,this._elDef=this._view.def.nodes[0],this.hostView=e,this.changeDetectorRef=e,this.instance=n}get location(){return new dn(Wn(this._view,this._elDef.nodeIndex).renderElement)}get injector(){return new Yr(this._view,this._elDef)}get componentType(){return this._component.constructor}destroy(){this._viewRef.destroy()}onDestroy(t){this._viewRef.onDestroy(t)}}function zr(t,e,n){return new Qr(t,e,n)}class Qr{constructor(t,e,n){this._view=t,this._elDef=e,this._data=n,this._embeddedViews=[]}get element(){return new dn(this._data.renderElement)}get injector(){return new Yr(this._view,this._elDef)}get parentInjector(){let t=this._view,e=this._elDef.parent;for(;!e&&t;)e=hr(t),t=t.parent;return t?new Yr(t,e):new Yr(this._view,null)}clear(){for(let t=this._embeddedViews.length-1;t>=0;t--){const e=Lr(this._data,t);Yn.destroyView(e)}}get(t){const e=this._embeddedViews[t];if(e){const t=new Wr(e);return t.attachToViewContainerRef(this),t}return null}get length(){return this._embeddedViews.length}createEmbeddedView(t,e,n){const r=t.createEmbeddedView(e||{});return this.insert(r,n),r}createComponent(t,e,n,r,i){const o=n||this.parentInjector;i||t instanceof cn||(i=o.get(zt));const s=t.create(o,r,void 0,i);return this.insert(s.hostView,e),s}insert(t,e){if(t.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");const n=t;return function(t,e,n,r){let i=e.viewContainer._embeddedViews;null==n&&(n=i.length),r.viewContainerParent=t,Ht(i,n,r),function(t,e){const n=cr(e);if(!n||n===t||16&e.state)return;e.state|=16;let r=n.template._projectedViews;r||(r=n.template._projectedViews=[]),r.push(e),function(t,n){if(4&n.flags)return;e.parent.def.nodeFlags|=4,n.flags|=4;let r=n.parent;for(;r;)r.childFlags|=4,r=r.parent}(0,e.parentNodeDef)}(e,r),Yn.dirtyParentQueries(r),Fr(e,n>0?i[n-1]:null,r)}(this._view,this._data,e,n._view),n.attachToViewContainerRef(this),t}move(t,e){if(t.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");const n=this._embeddedViews.indexOf(t._view);return function(t,e,r){const i=t.viewContainer._embeddedViews,o=i[n];Wt(i,n),null==r&&(r=i.length),Ht(i,r,o),Yn.dirtyParentQueries(o),Vr(o),Fr(t,r>0?i[r-1]:null,o)}(this._data,0,e),t}indexOf(t){return this._embeddedViews.indexOf(t._view)}remove(t){const e=Lr(this._data,t);e&&Yn.destroyView(e)}detach(t){const e=Lr(this._data,t);return e?new Wr(e):null}}function Hr(t){return new Wr(t)}class Wr{constructor(t){this._view=t,this._viewContainerRef=null,this._appRef=null}get rootNodes(){return function(t){const e=[];return wr(t,0,void 0,void 0,e),e}(this._view)}get context(){return this._view.context}get destroyed(){return 0!=(128&this._view.state)}markForCheck(){ar(this._view)}detach(){this._view.state&=-5}detectChanges(){const t=this._view.root.rendererFactory;t.begin&&t.begin();try{Yn.checkAndUpdateView(this._view)}finally{t.end&&t.end()}}checkNoChanges(){Yn.checkNoChangesView(this._view)}reattach(){this._view.state|=4}onDestroy(t){this._view.disposables||(this._view.disposables=[]),this._view.disposables.push(t)}destroy(){this._appRef?this._appRef.detachView(this):this._viewContainerRef&&this._viewContainerRef.detach(this._viewContainerRef.indexOf(this)),Yn.destroyView(this._view)}detachFromAppRef(){this._appRef=null,Vr(this._view),Yn.dirtyParentQueries(this._view)}attachToAppRef(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}attachToViewContainerRef(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t}}function Gr(t,e){return new Kr(t,e)}class Kr extends Ln{constructor(t,e){super(),this._parentView=t,this._def=e}createEmbeddedView(t){return new Wr(Yn.createEmbeddedView(this._parentView,this._def,this._def.element.template,t))}get elementRef(){return new dn(Wn(this._parentView,this._def.nodeIndex).renderElement)}}function $r(t,e){return new Yr(t,e)}class Yr{constructor(t,e){this.view=t,this.elDef=e}get(t,e=Le.THROW_IF_NOT_FOUND){return Yn.resolveDep(this.view,this.elDef,!!this.elDef&&0!=(33554432&this.elDef.flags),{flags:0,token:t,tokenKey:Jn(t)},e)}}function Zr(t,e){const n=t.def.nodes[e];if(1&n.flags){const e=Wn(t,n.nodeIndex);return n.element.template?e.template:e.renderElement}if(2&n.flags)return Hn(t,n.nodeIndex).renderText;if(20240&n.flags)return Gn(t,n.nodeIndex).instance;throw new Error(`Illegal state: read nodeValue for node index ${e}`)}function Xr(t){return new Jr(t.renderer)}class Jr{constructor(t){this.delegate=t}selectRootElement(t){return this.delegate.selectRootElement(t)}createElement(t,e){const[n,r]=xr(e),i=this.delegate.createElement(r,n);return t&&this.delegate.appendChild(t,i),i}createViewRoot(t){return t}createTemplateAnchor(t){const e=this.delegate.createComment("");return t&&this.delegate.appendChild(t,e),e}createText(t,e){const n=this.delegate.createText(e);return t&&this.delegate.appendChild(t,n),n}projectNodes(t,e){for(let n=0;n<e.length;n++)this.delegate.appendChild(t,e[n])}attachViewAfter(t,e){const n=this.delegate.parentNode(t),r=this.delegate.nextSibling(t);for(let i=0;i<e.length;i++)this.delegate.insertBefore(n,e[i],r)}detachView(t){for(let e=0;e<t.length;e++){const n=t[e],r=this.delegate.parentNode(n);this.delegate.removeChild(r,n)}}destroyView(t,e){for(let n=0;n<e.length;n++)this.delegate.destroyNode(e[n])}listen(t,e,n){return this.delegate.listen(t,e,n)}listenGlobal(t,e,n){return this.delegate.listen(t,e,n)}setElementProperty(t,e,n){this.delegate.setProperty(t,e,n)}setElementAttribute(t,e,n){const[r,i]=xr(e);null!=n?this.delegate.setAttribute(t,i,n,r):this.delegate.removeAttribute(t,i,r)}setBindingDebugInfo(t,e,n){}setElementClass(t,e,n){n?this.delegate.addClass(t,e):this.delegate.removeClass(t,e)}setElementStyle(t,e,n){null!=n?this.delegate.setStyle(t,e,n):this.delegate.removeStyle(t,e)}invokeElementMethod(t,e,n){t[e].apply(t,n)}setText(t,e){this.delegate.setValue(t,e)}animate(){throw new Error("Renderer.animate is no longer supported!")}}function ti(t,e,n,r){return new ei(t,e,n,r)}class ei{constructor(t,e,n,r){this._moduleType=t,this._parent=e,this._bootstrapComponents=n,this._def=r,this._destroyListeners=[],this._destroyed=!1,this.injector=this,function(t){const e=t._def,n=t._providers=new Array(e.providers.length);for(let r=0;r<e.providers.length;r++){const i=e.providers[r];4096&i.flags||void 0===n[r]&&(n[r]=Mr(t,i))}}(this)}get(t,e=Le.THROW_IF_NOT_FOUND,n=ft.Default){let r=0;return n&ft.SkipSelf?r|=1:n&ft.Self&&(r|=4),Pr(this,{token:t,tokenKey:Jn(t),flags:r},e)}get instance(){return this.get(this._moduleType)}get componentFactoryResolver(){return this.get(ln)}destroy(){if(this._destroyed)throw new Error(`The ng module ${vt(this.instance.constructor)} has already been destroyed.`);this._destroyed=!0,function(t,e){const n=t._def,r=new Set;for(let i=0;i<n.providers.length;i++)if(131072&n.providers[i].flags){const e=t._providers[i];if(e&&e!==kr){const t=e.ngOnDestroy;"function"!=typeof t||r.has(e)||(t.apply(e),r.add(e))}}}(this),this._destroyListeners.forEach(t=>t())}onDestroy(t){this._destroyListeners.push(t)}}const ni=Jn(pn),ri=Jn(yn),ii=Jn(dn),oi=Jn(Vn),si=Jn(Ln),ai=Jn(Re),li=Jn(Le),ui=Jn(At);function ci(t,e,n,r,i,o,s,a){const l=[];if(s)for(let c in s){const[t,e]=s[c];l[t]={flags:8,name:c,nonMinifiedName:e,ns:null,securityContext:null,suffix:null}}const u=[];if(a)for(let c in a)u.push({type:1,propName:c,target:null,eventName:a[c]});return di(t,e|=16384,n,r,i,i,o,l,u)}function hi(t,e,n,r,i){return di(-1,t,e,0,n,r,i)}function di(t,e,n,r,i,o,s,a,l){const{matchedQueries:u,references:c,matchedQueryIds:h}=gr(n);l||(l=[]),a||(a=[]),o=wt(o);const d=yr(s,vt(i));return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:e,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:u,matchedQueryIds:h,references:c,ngContentIndex:-1,childCount:r,bindings:a,bindingFlags:Ar(a),outputs:l,element:null,provider:{token:i,value:o,deps:d},text:null,query:null,ngContent:null}}function fi(t,e){return yi(t,e)}function pi(t,e){let n=t;for(;n.parent&&!fr(n);)n=n.parent;return vi(n.parent,hr(n),!0,e.provider.value,e.provider.deps)}function mi(t,e){const n=vi(t,e.parent,(32768&e.flags)>0,e.provider.value,e.provider.deps);if(e.outputs.length)for(let r=0;r<e.outputs.length;r++){const i=e.outputs[r],o=n[i.propName];if(!tn(o))throw new Error(`@Output ${i.propName} not initialized in '${n.constructor.name}'.`);{const n=o.subscribe(gi(t,e.parent.nodeIndex,i.eventName));t.disposables[e.outputIndex+r]=n.unsubscribe.bind(n)}}return n}function gi(t,e,n){return r=>ur(t,e,n,r)}function yi(t,e){const n=(8192&e.flags)>0,r=e.provider;switch(201347067&e.flags){case 512:return vi(t,e.parent,n,r.value,r.deps);case 1024:return function(t,e,n,r,i){const o=i.length;switch(o){case 0:return r();case 1:return r(bi(t,e,n,i[0]));case 2:return r(bi(t,e,n,i[0]),bi(t,e,n,i[1]));case 3:return r(bi(t,e,n,i[0]),bi(t,e,n,i[1]),bi(t,e,n,i[2]));default:const s=Array(o);for(let r=0;r<o;r++)s[r]=bi(t,e,n,i[r]);return r(...s)}}(t,e.parent,n,r.value,r.deps);case 2048:return bi(t,e.parent,n,r.deps[0]);case 256:return r.value}}function vi(t,e,n,r,i){const o=i.length;switch(o){case 0:return new r;case 1:return new r(bi(t,e,n,i[0]));case 2:return new r(bi(t,e,n,i[0]),bi(t,e,n,i[1]));case 3:return new r(bi(t,e,n,i[0]),bi(t,e,n,i[1]),bi(t,e,n,i[2]));default:const s=new Array(o);for(let r=0;r<o;r++)s[r]=bi(t,e,n,i[r]);return new r(...s)}}const _i={};function bi(t,e,n,r,i=Le.THROW_IF_NOT_FOUND){if(8&r.flags)return r.token;const o=t;2&r.flags&&(i=null);const s=r.tokenKey;s===ai&&(n=!(!e||!e.element.componentView)),e&&1&r.flags&&(n=!1,e=e.parent);let a=t;for(;a;){if(e)switch(s){case ni:return Xr(wi(a,e,n));case ri:return wi(a,e,n).renderer;case ii:return new dn(Wn(a,e.nodeIndex).renderElement);case oi:return Wn(a,e.nodeIndex).viewContainer;case si:if(e.element.template)return Wn(a,e.nodeIndex).template;break;case ai:return Hr(wi(a,e,n));case li:case ui:return $r(a,e);default:const t=(n?e.element.allProviders:e.element.publicProviders)[s];if(t){let e=Gn(a,t.nodeIndex);return e||(e={instance:yi(a,t)},a.nodes[t.nodeIndex]=e),e.instance}}n=fr(a),e=hr(a),a=a.parent,4&r.flags&&(a=null)}const l=o.root.injector.get(r.token,_i);return l!==_i||i===_i?l:o.root.ngModule.injector.get(r.token,i)}function wi(t,e,n){let r;if(n)r=Wn(t,e.nodeIndex).componentView;else for(r=t;r.parent&&!fr(r);)r=r.parent;return r}function Ei(t,e,n,r,i,o){if(32768&n.flags){const e=Wn(t,n.parent.nodeIndex).componentView;2&e.def.flags&&(e.state|=8)}if(e.instance[n.bindings[r].name]=i,524288&n.flags){o=o||{};const e=Ye.unwrap(t.oldValues[n.bindingIndex+r]);o[n.bindings[r].nonMinifiedName]=new en(e,i,0!=(2&t.state))}return t.oldValues[n.bindingIndex+r]=i,o}function Si(t,e){if(!(t.def.nodeFlags&e))return;const n=t.def.nodes;let r=0;for(let i=0;i<n.length;i++){const o=n[i];let s=o.parent;for(!s&&o.flags&e&&Ti(t,i,o.flags&e,r++),0==(o.childFlags&e)&&(i+=o.childCount);s&&1&s.flags&&i===s.nodeIndex+s.childCount;)s.directChildFlags&e&&(r=Ci(t,s,e,r)),s=s.parent}}function Ci(t,e,n,r){for(let i=e.nodeIndex+1;i<=e.nodeIndex+e.childCount;i++){const e=t.def.nodes[i];e.flags&n&&Ti(t,i,e.flags&n,r++),i+=e.childCount}return r}function Ti(t,e,n,r){const i=Gn(t,e);if(!i)return;const o=i.instance;o&&(Yn.setCurrentNode(t,e),1048576&n&&Qn(t,512,r)&&o.ngAfterContentInit(),2097152&n&&o.ngAfterContentChecked(),4194304&n&&Qn(t,768,r)&&o.ngAfterViewInit(),8388608&n&&o.ngAfterViewChecked(),131072&n&&o.ngOnDestroy())}const Ii=new xt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Kt}),xi={},Ai=function(){var t={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencySymbol:15,CurrencyName:16,Currencies:17,PluralCase:18,ExtraData:19};return t[t.LocaleId]="LocaleId",t[t.DayPeriodsFormat]="DayPeriodsFormat",t[t.DayPeriodsStandalone]="DayPeriodsStandalone",t[t.DaysFormat]="DaysFormat",t[t.DaysStandalone]="DaysStandalone",t[t.MonthsFormat]="MonthsFormat",t[t.MonthsStandalone]="MonthsStandalone",t[t.Eras]="Eras",t[t.FirstDayOfWeek]="FirstDayOfWeek",t[t.WeekendRange]="WeekendRange",t[t.DateFormat]="DateFormat",t[t.TimeFormat]="TimeFormat",t[t.DateTimeFormat]="DateTimeFormat",t[t.NumberSymbols]="NumberSymbols",t[t.NumberFormats]="NumberFormats",t[t.CurrencySymbol]="CurrencySymbol",t[t.CurrencyName]="CurrencyName",t[t.Currencies]="Currencies",t[t.PluralCase]="PluralCase",t[t.ExtraData]="ExtraData",t}(),ki=void 0;var Di=["en",[["a","p"],["AM","PM"],ki],[["AM","PM"],ki,ki],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ki,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ki,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ki,"{1} 'at' {0}",ki],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"$","US Dollar",{},function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];const Ni="en-US";let Ri=Ni;function Oi(t){var e;e="Expected localeId to be defined",null==t&&function(t){throw new Error(`ASSERTION ERROR: ${t}`)}(e),"string"==typeof t&&(Ri=t.toLowerCase().replace(/_/g,"-"))}class Pi extends x{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){let r,i=t=>null,o=()=>null;t&&"object"==typeof t?(r=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(i=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(o=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(r=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(i=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),n&&(o=this.__isAsync?()=>{setTimeout(()=>n())}:()=>{n()}));const s=super.subscribe(r,i,o);return t instanceof d&&t.add(s),s}}function Mi(){return this._results[Ge()]()}class Li{constructor(){this.dirty=!0,this._results=[],this.changes=new Pi,this.length=0;const t=Ge(),e=Li.prototype;e[t]||(e[t]=Mi)}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t){this._results=function t(e,n){void 0===n&&(n=e);for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?(n===e&&(n=e.slice(0,r)),t(i,n)):n!==e&&n.push(i)}return n}(t),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}const Fi=new xt("Application Initializer");class Vi{constructor(t){this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();Je(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}const Bi=new xt("AppId");function Ui(){return`${qi()}${qi()}${qi()}`}function qi(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const ji=new xt("Platform Initializer"),zi=new xt("Platform ID"),Qi=new xt("appBootstrapListener");class Hi{log(t){console.log(t)}warn(t){console.warn(t)}}const Wi=new xt("LocaleId"),Gi=!1;function Ki(){throw new Error("Runtime compiler is not loaded")}const $i=Ki,Yi=Ki,Zi=Ki,Xi=Ki;class Ji{constructor(){this.compileModuleSync=$i,this.compileModuleAsync=Yi,this.compileModuleAndAllComponentsSync=Zi,this.compileModuleAndAllComponentsAsync=Xi}clearCache(){}clearCacheFor(t){}getModuleId(t){}}class to{}let eo,no;function ro(){const t=It.wtf;return!(!t||!(eo=t.trace)||(no=eo.events,0))}const io=ro(),oo=io?function(t,e=null){return no.createScope(t,e)}:(t,e)=>(function(t,e){return null}),so=io?function(t,e){return eo.leaveScope(t,e),e}:(t,e)=>e,ao=(()=>Promise.resolve(0))();function lo(t){"undefined"==typeof Zone?ao.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class uo{constructor({enableLongStackTrace:t=!1}){if(this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Pi(!1),this.onMicrotaskEmpty=new Pi(!1),this.onStable=new Pi(!1),this.onError=new Pi(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");var e;Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),(e=this)._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,r,i,o,s)=>{try{return po(e),t.invokeTask(r,i,o,s)}finally{mo(e)}},onInvoke:(t,n,r,i,o,s,a)=>{try{return po(e),t.invoke(r,i,o,s,a)}finally{mo(e)}},onHasTask:(t,n,r,i)=>{t.hasTask(r,i),n===r&&("microTask"==i.change?(e.hasPendingMicrotasks=i.microTask,fo(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:(t,n,r,i)=>(t.handleError(r,i),e.runOutsideAngular(()=>e.onError.emit(i)),!1)})}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!uo.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(uo.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,r){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,t,ho,co,co);try{return i.runTask(o,e,n)}finally{i.cancelTask(o)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}function co(){}const ho={};function fo(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function po(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function mo(t){t._nesting--,fo(t)}class go{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Pi,this.onMicrotaskEmpty=new Pi,this.onStable=new Pi,this.onError=new Pi}run(t){return t()}runGuarded(t){return t()}runOutsideAngular(t){return t()}runTask(t){return t()}}class yo{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{uo.assertNotInAngularZone(),lo(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())lo(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let r=-1;e&&e>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==r),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:r,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}class vo{constructor(){this._applications=new Map,wo.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return wo.findTestabilityInTree(this,t,e)}}class _o{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}let bo,wo=new _o,Eo=function(t,e,n){return t.get(to).createCompiler([e]).compileModuleAsync(n)},So=function(t){return t instanceof cn};const Co=new xt("AllowMultipleToken");class To{constructor(t,e){this.name=t,this.token=e}}function Io(t,e,n=[]){const r=`Platform: ${e}`,i=new xt(r);return(e=[])=>{let o=xo();if(!o||o.injector.get(Co,!1))if(t)t(n.concat(e).concat({provide:i,useValue:!0}));else{const t=n.concat(e).concat({provide:i,useValue:!0});!function(t){if(bo&&!bo.destroyed&&!bo.injector.get(Co,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");bo=t.get(Ao);const e=t.get(ji,null);e&&e.forEach(t=>t())}(Le.create({providers:t,name:r}))}return function(t){const e=xo();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function xo(){return bo&&!bo.destroyed?bo:null}class Ao{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n="noop"===(i=e?e.ngZone:void 0)?new go:("zone.js"===i?void 0:i)||new uo({enableLongStackTrace:ie()}),r=[{provide:uo,useValue:n}];var i;return n.run(()=>{const e=Le.create({providers:r,parent:this.injector,name:t.moduleType.name}),i=t.create(e),o=i.injector.get(ee,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return Gi&&Oi(i.injector.get(Wi,Ni)||Ni),i.onDestroy(()=>No(this._modules,i)),n.runOutsideAngular(()=>n.onError.subscribe({next:t=>{o.handleError(t)}})),function(t,e,n){try{const i=n();return Je(i)?i.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):i}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(o,n,()=>{const t=i.injector.get(Vi);return t.runInitializers(),t.donePromise.then(()=>(this._moduleDoBootstrap(i),i))})})}bootstrapModule(t,e=[]){const n=ko({},e);return Eo(this.injector,n,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get(Do);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${vt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. `+"Please define one of these.");t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}function ko(t,e){return Array.isArray(e)?e.reduce(ko,t):Object.assign({},t,e)}let Do=(()=>{class t{constructor(t,e,n,r,i,o){this._zone=t,this._console=e,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=ie(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new w(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),a=new w(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{uo.assertNotInAngularZone(),lo(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{uo.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=X(s,a.pipe(st()))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof rn?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const r=So(n)?null:this._injector.get(zt),i=n.create(Le.NULL,[],e||n.selector,r);i.onDestroy(()=>{this._unloadComponent(i)});const o=i.injector.get(yo,null);return o&&i.injector.get(vo).registerApplication(i.location.nativeElement,o),this._loadComponent(i),ie()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");const e=t._tickScope();try{this._runningTick=!0;for(let t of this._views)t.detectChanges();if(this._enforceNoNewChanges)for(let t of this._views)t.checkNoChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1,so(e)}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;No(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Qi,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}_unloadComponent(t){this.detachView(t.hostView),No(this.components,t)}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy())}get viewCount(){return this._views.length}}return t._tickScope=oo("ApplicationRef#tick()"),t})();function No(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class Ro{}const Oo="#",Po="NgFactory";class Mo{}const Lo={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};class Fo{constructor(t,e){this._compiler=t,this._config=e||Lo}load(t){return!Gi&&this._compiler instanceof Ji?this.loadFactory(t):this.loadAndCompile(t)}loadAndCompile(t){let[e,r]=t.split(Oo);return void 0===r&&(r="default"),n("zn8P")(e).then(t=>t[r]).then(t=>Vo(t,e,r)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,r]=t.split(Oo),i=Po;return void 0===r&&(r="default",i=""),n("zn8P")(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[r+i]).then(t=>Vo(t,e,r))}}function Vo(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}class Bo{constructor(t,e){this.name=t,this.callback=e}}class Uo{constructor(t,e,n){this.listeners=[],this.parent=null,this._debugContext=n,this.nativeNode=t,e&&e instanceof qo&&e.addChild(this)}get injector(){return this._debugContext.injector}get componentInstance(){return this._debugContext.component}get context(){return this._debugContext.context}get references(){return this._debugContext.references}get providerTokens(){return this._debugContext.providerTokens}}class qo extends Uo{constructor(t,e,n){super(t,e,n),this.properties={},this.attributes={},this.classes={},this.styles={},this.childNodes=[],this.nativeElement=t}addChild(t){t&&(this.childNodes.push(t),t.parent=this)}removeChild(t){const e=this.childNodes.indexOf(t);-1!==e&&(t.parent=null,this.childNodes.splice(e,1))}insertChildrenAfter(t,e){const n=this.childNodes.indexOf(t);-1!==n&&(this.childNodes.splice(n+1,0,...e),e.forEach(e=>{e.parent&&e.parent.removeChild(e),t.parent=this}))}insertBefore(t,e){const n=this.childNodes.indexOf(t);-1===n?this.addChild(e):(e.parent&&e.parent.removeChild(e),e.parent=this,this.childNodes.splice(n,0,e))}query(t){return this.queryAll(t)[0]||null}queryAll(t){const e=[];return function t(e,n,r){e.childNodes.forEach(e=>{e instanceof qo&&(n(e)&&r.push(e),t(e,n,r))})}(this,t,e),e}queryAllNodes(t){const e=[];return function t(e,n,r){e instanceof qo&&e.childNodes.forEach(e=>{n(e)&&r.push(e),e instanceof qo&&t(e,n,r)})}(this,t,e),e}get children(){return this.childNodes.filter(t=>t instanceof qo)}triggerEventHandler(t,e){this.listeners.forEach(n=>{n.name==t&&n.callback(e)})}}const jo=new Map,zo=function(t){return jo.get(t)||null};function Qo(t){jo.set(t.nativeNode,t)}const Ho=Io(null,"core",[{provide:zi,useValue:"unknown"},{provide:Ao,deps:[Le]},{provide:vo,deps:[]},{provide:Hi,deps:[]}]);function Wo(){return Pn}function Go(){return Mn}function Ko(t){return t?(Gi&&Oi(t),t):Ni}function $o(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}class Yo{constructor(t){}}function Zo(t,e,n,r,i,o){t|=1;const{matchedQueries:s,references:a,matchedQueryIds:l}=gr(e);return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,flags:t,checkIndex:-1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:s,matchedQueryIds:l,references:a,ngContentIndex:n,childCount:r,bindings:[],bindingFlags:0,outputs:[],element:{ns:null,name:null,attrs:null,template:o?br(o):null,componentProvider:null,componentView:null,componentRendererType:null,publicProviders:null,allProviders:null,handleEvent:i||Zn},provider:null,text:null,query:null,ngContent:null}}function Xo(t,e,n,r,i,o,s=[],a,l,u,c,h){u||(u=Zn);const{matchedQueries:d,references:f,matchedQueryIds:p}=gr(n);let m=null,g=null;o&&([m,g]=xr(o)),a=a||[];const y=new Array(a.length);for(let b=0;b<a.length;b++){const[t,e,n]=a[b],[r,i]=xr(e);let o=void 0,s=void 0;switch(15&t){case 4:s=n;break;case 1:case 8:o=n}y[b]={flags:t,ns:r,name:i,nonMinifiedName:i,securityContext:o,suffix:s}}l=l||[];const v=new Array(l.length);for(let b=0;b<l.length;b++){const[t,e]=l[b];v[b]={type:0,target:t,eventName:e,propName:null}}const _=(s=s||[]).map(([t,e])=>{const[n,r]=xr(t);return[n,r,e]});return h=function(t){if(t&&t.id===tr){const e=null!=t.encapsulation&&t.encapsulation!==Gt.None||t.styles.length||Object.keys(t.data).length;t.id=e?`c${rr++}`:er}return t&&t.id===er&&(t=null),t||null}(h),c&&(e|=33554432),{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:e|=1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:d,matchedQueryIds:p,references:f,ngContentIndex:r,childCount:i,bindings:y,bindingFlags:Ar(y),outputs:v,element:{ns:m,name:g,attrs:_,template:null,componentProvider:null,componentView:c||null,componentRendererType:h,publicProviders:null,allProviders:null,handleEvent:u||Zn},provider:null,text:null,query:null,ngContent:null}}function Jo(t,e,n){const r=n.element,i=t.root.selectorOrNode,o=t.renderer;let s;if(t.parent||!i){s=r.name?o.createElement(r.name,r.ns):o.createComment("");const i=vr(t,e,n);i&&o.appendChild(i,s)}else s=o.selectRootElement(i,!!r.componentRendererType&&r.componentRendererType.encapsulation===Gt.ShadowDom);if(r.attrs)for(let a=0;a<r.attrs.length;a++){const[t,e,n]=r.attrs[a];o.setAttribute(s,e,n,t)}return s}function ts(t,e,n,r){for(let s=0;s<n.outputs.length;s++){const a=n.outputs[s],l=es(t,n.nodeIndex,(o=a.eventName,(i=a.target)?`${i}:${o}`:o));let u=a.target,c=t;"component"===a.target&&(u=null,c=e);const h=c.renderer.listen(u||r,a.eventName,l);t.disposables[n.outputIndex+s]=h}var i,o}function es(t,e,n){return r=>ur(t,e,n,r)}function ns(t,e,n,r){if(!or(t,e,n,r))return!1;const i=e.bindings[n],o=Wn(t,e.nodeIndex),s=o.renderElement,a=i.name;switch(15&i.flags){case 1:!function(t,e,n,r,i,o){const s=e.securityContext;let a=s?t.root.sanitizer.sanitize(s,o):o;a=null!=a?a.toString():null;const l=t.renderer;null!=o?l.setAttribute(n,i,a,r):l.removeAttribute(n,i,r)}(t,i,s,i.ns,a,r);break;case 2:!function(t,e,n,r){const i=t.renderer;r?i.addClass(e,n):i.removeClass(e,n)}(t,s,a,r);break;case 4:!function(t,e,n,r,i){let o=t.root.sanitizer.sanitize(Ie.STYLE,i);if(null!=o){o=o.toString();const t=e.suffix;null!=t&&(o+=t)}else o=null;const s=t.renderer;null!=o?s.setStyle(n,r,o):s.removeStyle(n,r)}(t,i,s,a,r);break;case 8:!function(t,e,n,r,i){const o=e.securityContext;let s=o?t.root.sanitizer.sanitize(o,i):i;t.renderer.setProperty(n,r,s)}(33554432&e.flags&&32&i.flags?o.componentView:t,i,s,a,r)}return!0}function rs(t,e,n){let r=[];for(let i in n)r.push({propName:i,bindingType:n[i]});return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:t,childFlags:0,directChildFlags:0,childMatchedQueries:0,ngContentIndex:-1,matchedQueries:{},matchedQueryIds:0,references:{},childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:{id:e,filterId:mr(e),bindings:r},ngContent:null}}function is(t){const e=t.def.nodeMatchedQueries;for(;t.parent&&pr(t);){let n=t.parentNodeDef;t=t.parent;const r=n.nodeIndex+n.childCount;for(let i=0;i<=r;i++){const r=t.def.nodes[i];67108864&r.flags&&536870912&r.flags&&(r.query.filterId&e)===r.query.filterId&&$n(t,i).setDirty(),!(1&r.flags&&i+r.childCount<n.nodeIndex)&&67108864&r.childFlags&&536870912&r.childFlags||(i+=r.childCount)}}if(134217728&t.def.nodeFlags)for(let n=0;n<t.def.nodes.length;n++){const e=t.def.nodes[n];134217728&e.flags&&536870912&e.flags&&$n(t,n).setDirty(),n+=e.childCount}}function os(t,e){const n=$n(t,e.nodeIndex);if(!n.dirty)return;let r,i=void 0;if(67108864&e.flags){const n=e.parent.parent;i=ss(t,n.nodeIndex,n.nodeIndex+n.childCount,e.query,[]),r=Gn(t,e.parent.nodeIndex).instance}else 134217728&e.flags&&(i=ss(t,0,t.def.nodes.length-1,e.query,[]),r=t.component);n.reset(i);const o=e.query.bindings;let s=!1;for(let a=0;a<o.length;a++){const t=o[a];let e;switch(t.bindingType){case 0:e=n.first;break;case 1:e=n,s=!0}r[t.propName]=e}s&&n.notifyOnChanges()}function ss(t,e,n,r,i){for(let o=e;o<=n;o++){const e=t.def.nodes[o],n=e.matchedQueries[r.id];if(null!=n&&i.push(as(t,e,n)),1&e.flags&&e.element.template&&(e.element.template.nodeMatchedQueries&r.filterId)===r.filterId){const n=Wn(t,o);if((e.childMatchedQueries&r.filterId)===r.filterId&&(ss(t,o+1,o+e.childCount,r,i),o+=e.childCount),16777216&e.flags){const t=n.viewContainer._embeddedViews;for(let e=0;e<t.length;e++){const o=t[e],s=cr(o);s&&s===n&&ss(o,0,o.def.nodes.length-1,r,i)}}const s=n.template._projectedViews;if(s)for(let t=0;t<s.length;t++){const e=s[t];ss(e,0,e.def.nodes.length-1,r,i)}}(e.childMatchedQueries&r.filterId)!==r.filterId&&(o+=e.childCount)}return i}function as(t,e,n){if(null!=n)switch(n){case 1:return Wn(t,e.nodeIndex).renderElement;case 0:return new dn(Wn(t,e.nodeIndex).renderElement);case 2:return Wn(t,e.nodeIndex).template;case 3:return Wn(t,e.nodeIndex).viewContainer;case 4:return Gn(t,e.nodeIndex).instance}}function ls(t,e){return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:8,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:t,childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:null,ngContent:{index:e}}}function us(t,e,n){const r=vr(t,e,n);r&&Sr(t,n.ngContent.index,1,r,null,void 0)}function cs(t,e,n){const r=new Array(n.length-1);for(let i=1;i<n.length;i++)r[i-1]={flags:8,name:null,ns:null,nonMinifiedName:null,securityContext:null,suffix:n[i]};return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:2,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:e,childCount:0,bindings:r,bindingFlags:8,outputs:[],element:null,provider:null,text:{prefix:n[0]},query:null,ngContent:null}}function hs(t,e,n){let r;const i=t.renderer;r=i.createText(n.text.prefix);const o=vr(t,e,n);return o&&i.appendChild(o,r),{renderText:r}}function ds(t,e){return(null!=t?t.toString():"")+e.suffix}function fs(t,e,n,r){let i=0,o=0,s=0,a=0,l=0,u=null,c=null,h=!1,d=!1,f=null;for(let p=0;p<e.length;p++){const t=e[p];if(t.nodeIndex=p,t.parent=u,t.bindingIndex=i,t.outputIndex=o,t.renderParent=c,s|=t.flags,l|=t.matchedQueryIds,t.element){const e=t.element;e.publicProviders=u?u.element.publicProviders:Object.create(null),e.allProviders=e.publicProviders,h=!1,d=!1,t.element.template&&(l|=t.element.template.nodeMatchedQueries)}if(ms(u,t,e.length),i+=t.bindings.length,o+=t.outputs.length,!c&&3&t.flags&&(f=t),20224&t.flags){h||(h=!0,u.element.publicProviders=Object.create(u.element.publicProviders),u.element.allProviders=u.element.publicProviders);const e=0!=(32768&t.flags);0==(8192&t.flags)||e?u.element.publicProviders[Jn(t.provider.token)]=t:(d||(d=!0,u.element.allProviders=Object.create(u.element.publicProviders)),u.element.allProviders[Jn(t.provider.token)]=t),e&&(u.element.componentProvider=t)}if(u?(u.childFlags|=t.flags,u.directChildFlags|=t.flags,u.childMatchedQueries|=t.matchedQueryIds,t.element&&t.element.template&&(u.childMatchedQueries|=t.element.template.nodeMatchedQueries)):a|=t.flags,t.childCount>0)u=t,ps(t)||(c=t);else for(;u&&p===u.nodeIndex+u.childCount;){const t=u.parent;t&&(t.childFlags|=u.childFlags,t.childMatchedQueries|=u.childMatchedQueries),c=(u=t)&&ps(u)?u.renderParent:u}}return{factory:null,nodeFlags:s,rootNodeFlags:a,nodeMatchedQueries:l,flags:t,nodes:e,updateDirectives:n||Zn,updateRenderer:r||Zn,handleEvent:(t,n,r,i)=>e[n].element.handleEvent(t,r,i),bindingCount:i,outputCount:o,lastRenderRootNode:f}}function ps(t){return 0!=(1&t.flags)&&null===t.element.name}function ms(t,e,n){const r=e.element&&e.element.template;if(r){if(!r.lastRenderRootNode)throw new Error("Illegal State: Embedded templates without nodes are not allowed!");if(r.lastRenderRootNode&&16777216&r.lastRenderRootNode.flags)throw new Error(`Illegal State: Last root node of a template can't have embedded views, at index ${e.nodeIndex}!`)}if(20224&e.flags&&0==(1&(t?t.flags:0)))throw new Error(`Illegal State: StaticProvider/Directive nodes need to be children of elements or anchors, at index ${e.nodeIndex}!`);if(e.query){if(67108864&e.flags&&(!t||0==(16384&t.flags)))throw new Error(`Illegal State: Content Query nodes need to be children of directives, at index ${e.nodeIndex}!`);if(134217728&e.flags&&t)throw new Error(`Illegal State: View Query nodes have to be top level nodes, at index ${e.nodeIndex}!`)}if(e.childCount){const r=t?t.nodeIndex+t.childCount:n-1;if(e.nodeIndex<=r&&e.nodeIndex+e.childCount>r)throw new Error(`Illegal State: childCount of node leads outside of parent, at index ${e.nodeIndex}!`)}}function gs(t,e,n,r){const i=_s(t.root,t.renderer,t,e,n);return bs(i,t.component,r),ws(i),i}function ys(t,e,n){const r=_s(t,t.renderer,null,null,e);return bs(r,n,n),ws(r),r}function vs(t,e,n,r){const i=e.element.componentRendererType;let o;return o=i?t.root.rendererFactory.createRenderer(r,i):t.root.renderer,_s(t.root,o,t,e.element.componentProvider,n)}function _s(t,e,n,r,i){const o=new Array(i.nodes.length),s=i.outputCount?new Array(i.outputCount):null;return{def:i,parent:n,viewContainerParent:null,parentNodeDef:r,context:null,component:null,nodes:o,state:13,root:t,renderer:e,oldValues:new Array(i.bindingCount),disposables:s,initIndex:-1}}function bs(t,e,n){t.component=e,t.context=n}function ws(t){let e;fr(t)&&(e=Wn(t.parent,t.parentNodeDef.parent.nodeIndex).renderElement);const n=t.def,r=t.nodes;for(let i=0;i<n.nodes.length;i++){const o=n.nodes[i];let s;switch(Yn.setCurrentNode(t,i),201347067&o.flags){case 1:const n=Jo(t,e,o);let a=void 0;if(33554432&o.flags){const e=br(o.element.componentView);a=Yn.createComponentView(t,o,e,n)}ts(t,a,o,n),s={renderElement:n,componentView:a,viewContainer:null,template:o.element.template?Gr(t,o):void 0},16777216&o.flags&&(s.viewContainer=zr(t,o,s));break;case 2:s=hs(t,e,o);break;case 512:case 1024:case 2048:case 256:(s=r[i])||4096&o.flags||(s={instance:fi(t,o)});break;case 16:s={instance:pi(t,o)};break;case 16384:(s=r[i])||(s={instance:mi(t,o)}),32768&o.flags&&bs(Wn(t,o.parent.nodeIndex).componentView,s.instance,s.instance);break;case 32:case 64:case 128:s={value:void 0};break;case 67108864:case 134217728:s=new Li;break;case 8:us(t,e,o),s=void 0}r[i]=s}Ds(t,ks.CreateViewNodes),Ps(t,201326592,268435456,0)}function Es(t){Ts(t),Yn.updateDirectives(t,1),Ns(t,ks.CheckNoChanges),Yn.updateRenderer(t,1),Ds(t,ks.CheckNoChanges),t.state&=-97}function Ss(t){1&t.state?(t.state&=-2,t.state|=2):t.state&=-3,zn(t,0,256),Ts(t),Yn.updateDirectives(t,0),Ns(t,ks.CheckAndUpdate),Ps(t,67108864,536870912,0);let e=zn(t,256,512);Si(t,2097152|(e?1048576:0)),Yn.updateRenderer(t,0),Ds(t,ks.CheckAndUpdate),Ps(t,134217728,536870912,0),Si(t,8388608|((e=zn(t,512,768))?4194304:0)),2&t.def.flags&&(t.state&=-9),t.state&=-97,zn(t,768,1024)}function Cs(t,e,n,r,i,o,s,a,l,u,c,h,d){return 0===n?function(t,e,n,r,i,o,s,a,l,u,c,h){switch(201347067&e.flags){case 1:return function(t,e,n,r,i,o,s,a,l,u,c,h){const d=e.bindings.length;let f=!1;return d>0&&ns(t,e,0,n)&&(f=!0),d>1&&ns(t,e,1,r)&&(f=!0),d>2&&ns(t,e,2,i)&&(f=!0),d>3&&ns(t,e,3,o)&&(f=!0),d>4&&ns(t,e,4,s)&&(f=!0),d>5&&ns(t,e,5,a)&&(f=!0),d>6&&ns(t,e,6,l)&&(f=!0),d>7&&ns(t,e,7,u)&&(f=!0),d>8&&ns(t,e,8,c)&&(f=!0),d>9&&ns(t,e,9,h)&&(f=!0),f}(t,e,n,r,i,o,s,a,l,u,c,h);case 2:return function(t,e,n,r,i,o,s,a,l,u,c,h){let d=!1;const f=e.bindings,p=f.length;if(p>0&&or(t,e,0,n)&&(d=!0),p>1&&or(t,e,1,r)&&(d=!0),p>2&&or(t,e,2,i)&&(d=!0),p>3&&or(t,e,3,o)&&(d=!0),p>4&&or(t,e,4,s)&&(d=!0),p>5&&or(t,e,5,a)&&(d=!0),p>6&&or(t,e,6,l)&&(d=!0),p>7&&or(t,e,7,u)&&(d=!0),p>8&&or(t,e,8,c)&&(d=!0),p>9&&or(t,e,9,h)&&(d=!0),d){let d=e.text.prefix;p>0&&(d+=ds(n,f[0])),p>1&&(d+=ds(r,f[1])),p>2&&(d+=ds(i,f[2])),p>3&&(d+=ds(o,f[3])),p>4&&(d+=ds(s,f[4])),p>5&&(d+=ds(a,f[5])),p>6&&(d+=ds(l,f[6])),p>7&&(d+=ds(u,f[7])),p>8&&(d+=ds(c,f[8])),p>9&&(d+=ds(h,f[9]));const m=Hn(t,e.nodeIndex).renderText;t.renderer.setValue(m,d)}return d}(t,e,n,r,i,o,s,a,l,u,c,h);case 16384:return function(t,e,n,r,i,o,s,a,l,u,c,h){const d=Gn(t,e.nodeIndex),f=d.instance;let p=!1,m=void 0;const g=e.bindings.length;return g>0&&ir(t,e,0,n)&&(p=!0,m=Ei(t,d,e,0,n,m)),g>1&&ir(t,e,1,r)&&(p=!0,m=Ei(t,d,e,1,r,m)),g>2&&ir(t,e,2,i)&&(p=!0,m=Ei(t,d,e,2,i,m)),g>3&&ir(t,e,3,o)&&(p=!0,m=Ei(t,d,e,3,o,m)),g>4&&ir(t,e,4,s)&&(p=!0,m=Ei(t,d,e,4,s,m)),g>5&&ir(t,e,5,a)&&(p=!0,m=Ei(t,d,e,5,a,m)),g>6&&ir(t,e,6,l)&&(p=!0,m=Ei(t,d,e,6,l,m)),g>7&&ir(t,e,7,u)&&(p=!0,m=Ei(t,d,e,7,u,m)),g>8&&ir(t,e,8,c)&&(p=!0,m=Ei(t,d,e,8,c,m)),g>9&&ir(t,e,9,h)&&(p=!0,m=Ei(t,d,e,9,h,m)),m&&f.ngOnChanges(m),65536&e.flags&&Qn(t,256,e.nodeIndex)&&f.ngOnInit(),262144&e.flags&&f.ngDoCheck(),p}(t,e,n,r,i,o,s,a,l,u,c,h);case 32:case 64:case 128:return function(t,e,n,r,i,o,s,a,l,u,c,h){const d=e.bindings;let f=!1;const p=d.length;if(p>0&&or(t,e,0,n)&&(f=!0),p>1&&or(t,e,1,r)&&(f=!0),p>2&&or(t,e,2,i)&&(f=!0),p>3&&or(t,e,3,o)&&(f=!0),p>4&&or(t,e,4,s)&&(f=!0),p>5&&or(t,e,5,a)&&(f=!0),p>6&&or(t,e,6,l)&&(f=!0),p>7&&or(t,e,7,u)&&(f=!0),p>8&&or(t,e,8,c)&&(f=!0),p>9&&or(t,e,9,h)&&(f=!0),f){const f=Kn(t,e.nodeIndex);let m;switch(201347067&e.flags){case 32:m=new Array(d.length),p>0&&(m[0]=n),p>1&&(m[1]=r),p>2&&(m[2]=i),p>3&&(m[3]=o),p>4&&(m[4]=s),p>5&&(m[5]=a),p>6&&(m[6]=l),p>7&&(m[7]=u),p>8&&(m[8]=c),p>9&&(m[9]=h);break;case 64:m={},p>0&&(m[d[0].name]=n),p>1&&(m[d[1].name]=r),p>2&&(m[d[2].name]=i),p>3&&(m[d[3].name]=o),p>4&&(m[d[4].name]=s),p>5&&(m[d[5].name]=a),p>6&&(m[d[6].name]=l),p>7&&(m[d[7].name]=u),p>8&&(m[d[8].name]=c),p>9&&(m[d[9].name]=h);break;case 128:const t=n;switch(p){case 1:m=t.transform(n);break;case 2:m=t.transform(r);break;case 3:m=t.transform(r,i);break;case 4:m=t.transform(r,i,o);break;case 5:m=t.transform(r,i,o,s);break;case 6:m=t.transform(r,i,o,s,a);break;case 7:m=t.transform(r,i,o,s,a,l);break;case 8:m=t.transform(r,i,o,s,a,l,u);break;case 9:m=t.transform(r,i,o,s,a,l,u,c);break;case 10:m=t.transform(r,i,o,s,a,l,u,c,h)}}f.value=m}return f}(t,e,n,r,i,o,s,a,l,u,c,h);default:throw"unreachable"}}(t,e,r,i,o,s,a,l,u,c,h,d):function(t,e,n){switch(201347067&e.flags){case 1:return function(t,e,n){let r=!1;for(let i=0;i<n.length;i++)ns(t,e,i,n[i])&&(r=!0);return r}(t,e,n);case 2:return function(t,e,n){const r=e.bindings;let i=!1;for(let o=0;o<n.length;o++)or(t,e,o,n[o])&&(i=!0);if(i){let i="";for(let t=0;t<n.length;t++)i+=ds(n[t],r[t]);i=e.text.prefix+i;const o=Hn(t,e.nodeIndex).renderText;t.renderer.setValue(o,i)}return i}(t,e,n);case 16384:return function(t,e,n){const r=Gn(t,e.nodeIndex),i=r.instance;let o=!1,s=void 0;for(let a=0;a<n.length;a++)ir(t,e,a,n[a])&&(o=!0,s=Ei(t,r,e,a,n[a],s));return s&&i.ngOnChanges(s),65536&e.flags&&Qn(t,256,e.nodeIndex)&&i.ngOnInit(),262144&e.flags&&i.ngDoCheck(),o}(t,e,n);case 32:case 64:case 128:return function(t,e,n){const r=e.bindings;let i=!1;for(let o=0;o<n.length;o++)or(t,e,o,n[o])&&(i=!0);if(i){const i=Kn(t,e.nodeIndex);let o;switch(201347067&e.flags){case 32:o=n;break;case 64:o={};for(let e=0;e<n.length;e++)o[r[e].name]=n[e];break;case 128:const t=n[0],i=n.slice(1);o=t.transform(...i)}i.value=o}return i}(t,e,n);default:throw"unreachable"}}(t,e,r)}function Ts(t){const e=t.def;if(4&e.nodeFlags)for(let n=0;n<e.nodes.length;n++){const r=e.nodes[n];if(4&r.flags){const e=Wn(t,n).template._projectedViews;if(e)for(let n=0;n<e.length;n++){const r=e[n];r.state|=32,lr(r,t)}}else 0==(4&r.childFlags)&&(n+=r.childCount)}}function Is(t,e,n,r,i,o,s,a,l,u,c,h,d){return 0===n?function(t,e,n,r,i,o,s,a,l,u,c,h){const d=e.bindings.length;d>0&&sr(t,e,0,n),d>1&&sr(t,e,1,r),d>2&&sr(t,e,2,i),d>3&&sr(t,e,3,o),d>4&&sr(t,e,4,s),d>5&&sr(t,e,5,a),d>6&&sr(t,e,6,l),d>7&&sr(t,e,7,u),d>8&&sr(t,e,8,c),d>9&&sr(t,e,9,h)}(t,e,r,i,o,s,a,l,u,c,h,d):function(t,e,n){for(let r=0;r<n.length;r++)sr(t,e,r,n[r])}(t,e,r),!1}function xs(t,e){if($n(t,e.nodeIndex).dirty)throw Un(Yn.createDebugContext(t,e.nodeIndex),`Query ${e.query.id} not dirty`,`Query ${e.query.id} dirty`,0!=(1&t.state))}function As(t){if(!(128&t.state)){if(Ns(t,ks.Destroy),Ds(t,ks.Destroy),Si(t,131072),t.disposables)for(let e=0;e<t.disposables.length;e++)t.disposables[e]();!function(t){if(!(16&t.state))return;const e=cr(t);if(e){const n=e.template._projectedViews;n&&(Wt(n,n.indexOf(t)),Yn.dirtyParentQueries(t))}}(t),t.renderer.destroyNode&&function(t){const e=t.def.nodes.length;for(let n=0;n<e;n++){const e=t.def.nodes[n];1&e.flags?t.renderer.destroyNode(Wn(t,n).renderElement):2&e.flags?t.renderer.destroyNode(Hn(t,n).renderText):(67108864&e.flags||134217728&e.flags)&&$n(t,n).destroy()}}(t),fr(t)&&t.renderer.destroy(),t.state|=128}}const ks=function(){var t={CreateViewNodes:0,CheckNoChanges:1,CheckNoChangesProjectedViews:2,CheckAndUpdate:3,CheckAndUpdateProjectedViews:4,Destroy:5};return t[t.CreateViewNodes]="CreateViewNodes",t[t.CheckNoChanges]="CheckNoChanges",t[t.CheckNoChangesProjectedViews]="CheckNoChangesProjectedViews",t[t.CheckAndUpdate]="CheckAndUpdate",t[t.CheckAndUpdateProjectedViews]="CheckAndUpdateProjectedViews",t[t.Destroy]="Destroy",t}();function Ds(t,e){const n=t.def;if(33554432&n.nodeFlags)for(let r=0;r<n.nodes.length;r++){const i=n.nodes[r];33554432&i.flags?Rs(Wn(t,r).componentView,e):0==(33554432&i.childFlags)&&(r+=i.childCount)}}function Ns(t,e){const n=t.def;if(16777216&n.nodeFlags)for(let r=0;r<n.nodes.length;r++){const i=n.nodes[r];if(16777216&i.flags){const n=Wn(t,r).viewContainer._embeddedViews;for(let t=0;t<n.length;t++)Rs(n[t],e)}else 0==(16777216&i.childFlags)&&(r+=i.childCount)}}function Rs(t,e){const n=t.state;switch(e){case ks.CheckNoChanges:0==(128&n)&&(12==(12&n)?Es(t):64&n&&Os(t,ks.CheckNoChangesProjectedViews));break;case ks.CheckNoChangesProjectedViews:0==(128&n)&&(32&n?Es(t):64&n&&Os(t,e));break;case ks.CheckAndUpdate:0==(128&n)&&(12==(12&n)?Ss(t):64&n&&Os(t,ks.CheckAndUpdateProjectedViews));break;case ks.CheckAndUpdateProjectedViews:0==(128&n)&&(32&n?Ss(t):64&n&&Os(t,e));break;case ks.Destroy:As(t);break;case ks.CreateViewNodes:ws(t)}}function Os(t,e){Ns(t,e),Ds(t,e)}function Ps(t,e,n,r){if(!(t.def.nodeFlags&e&&t.def.nodeFlags&n))return;const i=t.def.nodes.length;for(let o=0;o<i;o++){const i=t.def.nodes[o];if(i.flags&e&&i.flags&n)switch(Yn.setCurrentNode(t,i.nodeIndex),r){case 0:os(t,i);break;case 1:xs(t,i)}i.childFlags&e&&i.childFlags&n||(o+=i.childCount)}}let Ms=!1;function Ls(t,e,n,r,i,o){const s=i.injector.get(mn);return ys(Vs(t,i,s,e,n),r,o)}function Fs(t,e,n,r,i,o){const s=i.injector.get(mn),a=Vs(t,i,new ga(s),e,n),l=Ks(r);return pa(ta.create,ys,null,[a,l,o])}function Vs(t,e,n,r,i){const o=e.injector.get(xe),s=e.injector.get(ee),a=n.createRenderer(null,null);return{ngModule:e,injector:t,projectableNodes:r,selectorOrNode:i,sanitizer:o,rendererFactory:n,renderer:a,errorHandler:s}}function Bs(t,e,n,r){const i=Ks(n);return pa(ta.create,gs,null,[t,e,i,r])}function Us(t,e,n,r){return n=Qs.get(e.element.componentProvider.provider.token)||Ks(n),pa(ta.create,vs,null,[t,e,n,r])}function qs(t,e,n,r){return ti(t,e,n,function(t){const{hasOverrides:e,hasDeprecatedOverrides:n}=function(t){let e=!1,n=!1;return 0===js.size?{hasOverrides:e,hasDeprecatedOverrides:n}:(t.providers.forEach(t=>{const r=js.get(t.token);3840&t.flags&&r&&(e=!0,n=n||r.deprecatedBehavior)}),t.modules.forEach(t=>{zs.forEach((r,i)=>{gt(i).providedIn===t&&(e=!0,n=n||r.deprecatedBehavior)})}),{hasOverrides:e,hasDeprecatedOverrides:n})}(t);return e?(function(t){for(let e=0;e<t.providers.length;e++){const r=t.providers[e];n&&(r.flags|=4096);const i=js.get(r.token);i&&(r.flags=-3841&r.flags|i.flags,r.deps=yr(i.deps),r.value=i.value)}if(zs.size>0){let e=new Set(t.modules);zs.forEach((r,i)=>{if(e.has(gt(i).providedIn)){let e={token:i,flags:r.flags|(n?4096:0),deps:yr(r.deps),value:r.value,index:t.providers.length};t.providers.push(e),t.providersByKey[Jn(i)]=e}})}}(t=t.factory(()=>Zn)),t):t}(r))}const js=new Map,zs=new Map,Qs=new Map;function Hs(t){let e;js.set(t.token,t),"function"==typeof t.token&&(e=gt(t.token))&&"function"==typeof e.providedIn&&zs.set(t.token,t)}function Ws(t,e){const n=br(e.viewDefFactory),r=br(n.nodes[0].element.componentView);Qs.set(t,r)}function Gs(){js.clear(),zs.clear(),Qs.clear()}function Ks(t){if(0===js.size)return t;const e=function(t){const e=[];let n=null;for(let r=0;r<t.nodes.length;r++){const i=t.nodes[r];1&i.flags&&(n=i),n&&3840&i.flags&&js.has(i.provider.token)&&(e.push(n.nodeIndex),n=null)}return e}(t);if(0===e.length)return t;t=t.factory(()=>Zn);for(let r=0;r<e.length;r++)n(t,e[r]);return t;function n(t,e){for(let n=e+1;n<t.nodes.length;n++){const e=t.nodes[n];if(1&e.flags)return;if(3840&e.flags){const t=e.provider,n=js.get(t.token);n&&(e.flags=-3841&e.flags|n.flags,t.deps=yr(n.deps),t.value=n.value)}}}}function $s(t,e,n,r,i,o,s,a,l,u,c,h,d){const f=t.def.nodes[e];return Cs(t,f,n,r,i,o,s,a,l,u,c,h,d),224&f.flags?Kn(t,e).value:void 0}function Ys(t,e,n,r,i,o,s,a,l,u,c,h,d){const f=t.def.nodes[e];return Is(t,f,n,r,i,o,s,a,l,u,c,h,d),224&f.flags?Kn(t,e).value:void 0}function Zs(t){return pa(ta.detectChanges,Ss,null,[t])}function Xs(t){return pa(ta.checkNoChanges,Es,null,[t])}function Js(t){return pa(ta.destroy,As,null,[t])}const ta=function(){var t={create:0,detectChanges:1,checkNoChanges:2,destroy:3,handleEvent:4};return t[t.create]="create",t[t.detectChanges]="detectChanges",t[t.checkNoChanges]="checkNoChanges",t[t.destroy]="destroy",t[t.handleEvent]="handleEvent",t}();let ea,na,ra;function ia(t,e){na=t,ra=e}function oa(t,e,n,r){return ia(t,e),pa(ta.handleEvent,t.def.handleEvent,null,[t,e,n,r])}function sa(t,e){if(128&t.state)throw jn(ta[ea]);return ia(t,ca(t,0)),t.def.updateDirectives(function(t,n,r,...i){const o=t.def.nodes[n];return 0===e?la(t,o,r,i):ua(t,o,r,i),16384&o.flags&&ia(t,ca(t,n)),224&o.flags?Kn(t,o.nodeIndex).value:void 0},t)}function aa(t,e){if(128&t.state)throw jn(ta[ea]);return ia(t,ha(t,0)),t.def.updateRenderer(function(t,n,r,...i){const o=t.def.nodes[n];return 0===e?la(t,o,r,i):ua(t,o,r,i),3&o.flags&&ia(t,ha(t,n)),224&o.flags?Kn(t,o.nodeIndex).value:void 0},t)}function la(t,e,n,r){if(Cs(t,e,n,...r)){const s=1===n?r[0]:r;if(16384&e.flags){const n={};for(let t=0;t<e.bindings.length;t++){const r=e.bindings[t],a=s[t];8&r.flags&&(n[(i=r.nonMinifiedName,o=void 0,o=i.replace(/[$@]/g,"_"),`ng-reflect-${i=o.replace(De,(...t)=>"-"+t[1].toLowerCase())}`)]=Ne(a))}const r=e.parent,a=Wn(t,r.nodeIndex).renderElement;if(r.element.name)for(let e in n){const r=n[e];null!=r?t.renderer.setAttribute(a,e,r):t.renderer.removeAttribute(a,e)}else t.renderer.setValue(a,`bindings=${JSON.stringify(n,null,2)}`)}}var i,o}function ua(t,e,n,r){Is(t,e,n,...r)}function ca(t,e){for(let n=e;n<t.def.nodes.length;n++){const e=t.def.nodes[n];if(16384&e.flags&&e.bindings&&e.bindings.length)return n}return null}function ha(t,e){for(let n=e;n<t.def.nodes.length;n++){const e=t.def.nodes[n];if(3&e.flags&&e.bindings&&e.bindings.length)return n}return null}class da{constructor(t,e){this.view=t,this.nodeIndex=e,null==e&&(this.nodeIndex=e=0),this.nodeDef=t.def.nodes[e];let n=this.nodeDef,r=t;for(;n&&0==(1&n.flags);)n=n.parent;if(!n)for(;!n&&r;)n=hr(r),r=r.parent;this.elDef=n,this.elView=r}get elOrCompView(){return Wn(this.elView,this.elDef.nodeIndex).componentView||this.view}get injector(){return $r(this.elView,this.elDef)}get component(){return this.elOrCompView.component}get context(){return this.elOrCompView.context}get providerTokens(){const t=[];if(this.elDef)for(let e=this.elDef.nodeIndex+1;e<=this.elDef.nodeIndex+this.elDef.childCount;e++){const n=this.elView.def.nodes[e];20224&n.flags&&t.push(n.provider.token),e+=n.childCount}return t}get references(){const t={};if(this.elDef){fa(this.elView,this.elDef,t);for(let e=this.elDef.nodeIndex+1;e<=this.elDef.nodeIndex+this.elDef.childCount;e++){const n=this.elView.def.nodes[e];20224&n.flags&&fa(this.elView,n,t),e+=n.childCount}}return t}get componentRenderElement(){const t=function(t){for(;t&&!fr(t);)t=t.parent;return t.parent?Wn(t.parent,hr(t).nodeIndex):null}(this.elOrCompView);return t?t.renderElement:void 0}get renderNode(){return 2&this.nodeDef.flags?dr(this.view,this.nodeDef):dr(this.elView,this.elDef)}logError(t,...e){let n,r;2&this.nodeDef.flags?(n=this.view.def,r=this.nodeDef.nodeIndex):(n=this.elView.def,r=this.elDef.nodeIndex);const i=function(t,e){let n=-1;for(let r=0;r<=e;r++)3&t.nodes[r].flags&&n++;return n}(n,r);let o=-1;n.factory(()=>++o===i?t.error.bind(t,...e):Zn),o<i&&(t.error("Illegal state: the ViewDefinitionFactory did not call the logger!"),t.error(...e))}}function fa(t,e,n){for(let r in e.references)n[r]=as(t,e,e.references[r])}function pa(t,e,n,r){const i=ea,o=na,s=ra;try{ea=t;const l=e.apply(n,r);return na=o,ra=s,ea=i,l}catch(a){if(Xt(a)||!na)throw a;throw function(t,e){return t instanceof Error||(t=new Error(t.toString())),qn(t,e),t}(a,ma())}}function ma(){return na?new da(na,ra):null}class ga{constructor(t){this.delegate=t}createRenderer(t,e){return new ya(this.delegate.createRenderer(t,e))}begin(){this.delegate.begin&&this.delegate.begin()}end(){this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.delegate.whenRenderingDone?this.delegate.whenRenderingDone():Promise.resolve(null)}}class ya{constructor(t){this.delegate=t,this.debugContextFactory=ma,this.data=this.delegate.data}createDebugContext(t){return this.debugContextFactory(t)}destroyNode(t){const e=zo(t);jo.delete(e.nativeNode),e instanceof Uo&&(e.listeners.length=0),this.delegate.destroyNode&&this.delegate.destroyNode(t)}destroy(){this.delegate.destroy()}createElement(t,e){const n=this.delegate.createElement(t,e),r=this.createDebugContext(n);if(r){const e=new qo(n,null,r);e.name=t,Qo(e)}return n}createComment(t){const e=this.delegate.createComment(t),n=this.createDebugContext(e);return n&&Qo(new Uo(e,null,n)),e}createText(t){const e=this.delegate.createText(t),n=this.createDebugContext(e);return n&&Qo(new Uo(e,null,n)),e}appendChild(t,e){const n=zo(t),r=zo(e);n&&r&&n instanceof qo&&n.addChild(r),this.delegate.appendChild(t,e)}insertBefore(t,e,n){const r=zo(t),i=zo(e),o=zo(n);r&&i&&r instanceof qo&&r.insertBefore(o,i),this.delegate.insertBefore(t,e,n)}removeChild(t,e){const n=zo(t),r=zo(e);n&&r&&n instanceof qo&&n.removeChild(r),this.delegate.removeChild(t,e)}selectRootElement(t,e){const n=this.delegate.selectRootElement(t,e),r=ma();return r&&Qo(new qo(n,null,r)),n}setAttribute(t,e,n,r){const i=zo(t);i&&i instanceof qo&&(i.attributes[r?r+":"+e:e]=n),this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){const r=zo(t);r&&r instanceof qo&&(r.attributes[n?n+":"+e:e]=null),this.delegate.removeAttribute(t,e,n)}addClass(t,e){const n=zo(t);n&&n instanceof qo&&(n.classes[e]=!0),this.delegate.addClass(t,e)}removeClass(t,e){const n=zo(t);n&&n instanceof qo&&(n.classes[e]=!1),this.delegate.removeClass(t,e)}setStyle(t,e,n,r){const i=zo(t);i&&i instanceof qo&&(i.styles[e]=n),this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){const r=zo(t);r&&r instanceof qo&&(r.styles[e]=null),this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){const r=zo(t);r&&r instanceof qo&&(r.properties[e]=n),this.delegate.setProperty(t,e,n)}listen(t,e,n){if("string"!=typeof t){const r=zo(t);r&&r.listeners.push(new Bo(e,n))}return this.delegate.listen(t,e,n)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setValue(t,e){return this.delegate.setValue(t,e)}}function va(t,e,n){return new _a(t,e,n)}class _a extends Qt{constructor(t,e,n){super(),this.moduleType=t,this._bootstrapComponents=e,this._ngModuleDefFactory=n}create(t){!function(){if(Ms)return;Ms=!0;const t=ie()?{setCurrentNode:ia,createRootView:Fs,createEmbeddedView:Bs,createComponentView:Us,createNgModuleRef:qs,overrideProvider:Hs,overrideComponentView:Ws,clearOverrides:Gs,checkAndUpdateView:Zs,checkNoChangesView:Xs,destroyView:Js,createDebugContext:(t,e)=>new da(t,e),handleEvent:oa,updateDirectives:sa,updateRenderer:aa}:{setCurrentNode:()=>{},createRootView:Ls,createEmbeddedView:gs,createComponentView:vs,createNgModuleRef:ti,overrideProvider:Zn,overrideComponentView:Zn,clearOverrides:Zn,checkAndUpdateView:Ss,checkNoChangesView:Es,destroyView:As,createDebugContext:(t,e)=>new da(t,e),handleEvent:(t,e,n,r)=>t.def.handleEvent(t,e,n,r),updateDirectives:(t,e)=>t.def.updateDirectives(0===e?$s:Ys,t),updateRenderer:(t,e)=>t.def.updateRenderer(0===e?$s:Ys,t)};Yn.setCurrentNode=t.setCurrentNode,Yn.createRootView=t.createRootView,Yn.createEmbeddedView=t.createEmbeddedView,Yn.createComponentView=t.createComponentView,Yn.createNgModuleRef=t.createNgModuleRef,Yn.overrideProvider=t.overrideProvider,Yn.overrideComponentView=t.overrideComponentView,Yn.clearOverrides=t.clearOverrides,Yn.checkAndUpdateView=t.checkAndUpdateView,Yn.checkNoChangesView=t.checkNoChangesView,Yn.destroyView=t.destroyView,Yn.resolveDep=bi,Yn.createDebugContext=t.createDebugContext,Yn.handleEvent=t.handleEvent,Yn.updateDirectives=t.updateDirectives,Yn.updateRenderer=t.updateRenderer,Yn.dirtyParentQueries=is}();const e=function(t){const e=Array.from(t.providers),n=Array.from(t.modules),r={};for(const i in t.providersByKey)r[i]=t.providersByKey[i];return{factory:t.factory,isRoot:t.isRoot,providers:e,modules:n,providersByKey:r}}(br(this._ngModuleDefFactory));return Yn.createNgModuleRef(this.moduleType,t||Le.NULL,this._bootstrapComponents,e)}}class ba{}class wa{constructor(){this.title="lovenfriendship"}}class Ea{}const Sa=new xt("Location Initialized");class Ca{}const Ta=new xt("appBaseHref");class Ia{constructor(t,e){this._subject=new Pi,this._urlChangeListeners=[],this._platformStrategy=t;const n=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=Ia.stripTrailingSlash(xa(n)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+Ia.normalizeQueryParams(e))}normalize(t){return Ia.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,xa(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",n=null){this._platformStrategy.pushState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ia.normalizeQueryParams(e)),n)}replaceState(t,e="",n=null){this._platformStrategy.replaceState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ia.normalizeQueryParams(e)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(t){this._urlChangeListeners.push(t),this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)})}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(n=>n(t,e))}subscribe(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}static normalizeQueryParams(t){return t&&"?"!==t[0]?"?"+t:t}static joinWithSlash(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}static stripTrailingSlash(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}}function xa(t){return t.replace(/\/index.html$/,"")}class Aa extends Ca{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",null!=e&&(this._baseHref=e)}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=Ia.joinWithSlash(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,n,r){let i=this.prepareExternalUrl(n+Ia.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){let i=this.prepareExternalUrl(n+Ia.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}class ka extends Ca{constructor(t,e){if(super(),this._platformLocation=t,null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Ia.joinWithSlash(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+Ia.normalizeQueryParams(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,r){const i=this.prepareExternalUrl(n+Ia.normalizeQueryParams(r));this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){const i=this.prepareExternalUrl(n+Ia.normalizeQueryParams(r));this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}const Da=function(){var t={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return t[t.Zero]="Zero",t[t.One]="One",t[t.Two]="Two",t[t.Few]="Few",t[t.Many]="Many",t[t.Other]="Other",t}(),Na=function(t){return function(t){const e=t.toLowerCase().replace(/_/g,"-");let n=xi[e];if(n)return n;const r=e.split("-")[0];if(n=xi[r])return n;if("en"===r)return Di;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[Ai.PluralCase]},Ra=new xt("UseV4Plurals");class Oa{}class Pa extends Oa{constructor(t,e){super(),this.locale=t,this.deprecatedPluralFn=e}getPluralCategory(t,e){switch(this.deprecatedPluralFn?this.deprecatedPluralFn(e||this.locale,t):Na(e||this.locale)(t)){case Da.Zero:return"zero";case Da.One:return"one";case Da.Two:return"two";case Da.Few:return"few";case Da.Many:return"many";default:return"other"}}}class Ma{constructor(t,e){this._viewContainer=t,this._context=new La,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Fa("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Fa("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}class La{constructor(){this.$implicit=null,this.ngIf=null}}function Fa(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${vt(e)}'.`)}class Va{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}class Ba{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)}_matchCase(t){const e=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||e,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),e}_updateDefaultCases(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(let e=0;e<this._defaultViews.length;e++)this._defaultViews[e].enforceState(t)}}}class Ua{constructor(t,e,n){this.ngSwitch=n,n._addCase(),this._view=new Va(t,e)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}class qa{}const ja=new xt("DocumentToken"),za="browser",Qa="server";function Ha(t){return t===Qa}let Wa=(()=>{class t{}return t.ngInjectableDef=mt({token:t,providedIn:"root",factory:()=>new Ga(Bt(ja),window,Bt(ee))}),t})();class Ga{constructor(t,e,n){this.document=t,this.window=e,this.errorHandler=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}scrollToPosition(t){this.supportScrollRestoration()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(this.supportScrollRestoration()){t=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(t):t.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{const n=this.document.querySelector(`#${t}`);if(n)return void this.scrollToElement(n);const r=this.document.querySelector(`[name='${t}']`);if(r)return void this.scrollToElement(r)}catch(e){this.errorHandler.handleError(e)}}}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}supportScrollRestoration(){try{return!!this.window&&!!this.window.scrollTo}catch(t){return!1}}}const Ka=new w(t=>t.complete());function $a(t){return t?function(t){return new w(e=>t.schedule(()=>e.complete()))}(t):Ka}function Ya(t){const e=new w(e=>{e.next(t),e.complete()});return e._isScalar=!0,e.value=t,e}function Za(...t){let e=t[t.length-1];switch(k(e)?t.pop():e=void 0,t.length){case 0:return $a(e);case 1:return e?H(t,e):Ya(t[0]);default:return H(t,e)}}class Xa extends x{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new C;return this._value}next(t){super.next(this._value=t)}}function Ja(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}Ja.prototype=Object.create(Error.prototype);const tl=Ja,el={};function nl(...t){let e=null,n=null;return k(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&l(t[0])&&(t=t[0]),H(t,n).lift(new rl(e))}class rl{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new il(t,this.resultSelector))}}class il extends q{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(el),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let n=0;n<e;n++){const e=t[n];this.add(U(this,e,e,n))}}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,n,r,i){const o=this.values,s=this.toRespond?o[n]===el?--this.toRespond:this.toRespond:0;o[n]=e,0===s&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}function ol(t){return new w(e=>{let n;try{n=t()}catch(r){return void e.error(r)}return(n?W(n):$a()).subscribe(e)})}function sl(){return Z(1)}function al(t,e){return function(n){return n.lift(new ll(t,e))}}class ll{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new ul(t,this.predicate,this.thisArg))}}class ul extends m{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}function cl(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}cl.prototype=Object.create(Error.prototype);const hl=cl;function dl(t){return function(e){return 0===t?$a():e.lift(new fl(t))}}class fl{constructor(t){if(this.total=t,this.total<0)throw new hl}call(t,e){return e.subscribe(new pl(t,this.total))}}class pl extends m{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const n=this.count>=this.total?this.total:this.count,r=this.ring;for(let i=0;i<n;i++){const i=e++%n;t.next(r[i])}}t.complete()}}function ml(t,e,n){return function(r){return r.lift(new gl(t,e,n))}}class gl{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new yl(t,this.nextOrObserver,this.error,this.complete))}}class yl extends m{constructor(t,e,n,i){super(t),this._tapNext=v,this._tapError=v,this._tapComplete=v,this._tapError=n||v,this._tapComplete=i||v,r(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||v,this._tapError=e.error||v,this._tapComplete=e.complete||v)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}const vl=(t=function(){return new tl})=>ml({hasValue:!1,next(){this.hasValue=!0},complete(){if(!this.hasValue)throw t()}});function _l(t=null){return e=>e.lift(new bl(t))}class bl{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new wl(t,this.defaultValue))}}class wl extends m{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function El(t,e){const n=arguments.length>=2;return r=>r.pipe(t?al((e,n)=>t(e,n,r)):Y,dl(1),n?_l(e):vl(()=>new tl))}function Sl(t){return function(e){const n=new Cl(t),r=e.lift(n);return n.caught=r}}class Cl{constructor(t){this.selector=t}call(t,e){return e.subscribe(new Tl(t,this.selector,this.caught))}}class Tl extends q{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let n;try{n=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const r=new D(this,void 0,void 0);this.add(r),U(this,n,void 0,void 0,r)}}}function Il(t){return e=>0===t?$a():e.lift(new xl(t))}class xl{constructor(t){if(this.total=t,this.total<0)throw new hl}call(t,e){return e.subscribe(new Al(t,this.total))}}class Al extends m{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}function kl(t,e){const n=arguments.length>=2;return r=>r.pipe(t?al((e,n)=>t(e,n,r)):Y,Il(1),n?_l(e):vl(()=>new tl))}class Dl{constructor(t,e,n){this.predicate=t,this.thisArg=e,this.source=n}call(t,e){return e.subscribe(new Nl(t,this.predicate,this.thisArg,this.source))}}class Nl extends m{constructor(t,e,n,r){super(t),this.predicate=e,this.thisArg=n,this.source=r,this.index=0,this.thisArg=n||this}notifyComplete(t){this.destination.next(t),this.destination.complete()}_next(t){let e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(n){return void this.destination.error(n)}e||this.notifyComplete(!1)}_complete(){this.notifyComplete(!0)}}function Rl(t,e){return"function"==typeof e?n=>n.pipe(Rl((n,r)=>W(t(n,r)).pipe(j((t,i)=>e(n,t,r,i))))):e=>e.lift(new Ol(t))}class Ol{constructor(t){this.project=t}call(t,e){return e.subscribe(new Pl(t,this.project))}}class Pl extends q{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this._innerSub(e,t,n)}_innerSub(t,e,n){const r=this.innerSubscription;r&&r.unsubscribe();const i=new D(this,void 0,void 0);this.destination.add(i),this.innerSubscription=U(this,t,e,n,i)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=null}notifyComplete(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&super._complete()}notifyNext(t,e,n,r,i){this.destination.next(e)}}function Ml(...t){return sl()(Za(...t))}function Ll(...t){return e=>{let n=t[t.length-1];k(n)?t.pop():n=null;const r=t.length;return Ml(1!==r||n?r>0?H(t,n):$a(n):Ya(t[0]),e)}}function Fl(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new Vl(t,e,n))}}class Vl{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new Bl(t,this.accumulator,this.seed,this.hasSeed))}}class Bl extends m{constructor(t,e,n,r){super(t),this.accumulator=e,this._seed=n,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(r){this.destination.error(r)}this.seed=n,this.destination.next(n)}}function Ul(t,e){return G(t,e,1)}class ql{constructor(t){this.callback=t}call(t,e){return e.subscribe(new jl(t,this.callback))}}class jl extends m{constructor(t,e){super(t),this.add(new d(e))}}let zl=null;function Ql(){return zl}class Hl{constructor(){this.resourceLoaderType=null}get attrToPropMap(){return this._attrToPropMap}set attrToPropMap(t){this._attrToPropMap=t}}class Wl extends Hl{constructor(){super(),this._animationPrefix=null,this._transitionEnd=null;try{const e=this.createElement("div",document);if(null!=this.getStyle(e,"animationName"))this._animationPrefix="";else{const t=["Webkit","Moz","O","ms"];for(let n=0;n<t.length;n++)if(null!=this.getStyle(e,t[n]+"AnimationName")){this._animationPrefix="-"+t[n].toLowerCase()+"-";break}}const n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};Object.keys(n).forEach(t=>{null!=this.getStyle(e,t)&&(this._transitionEnd=n[t])})}catch(t){this._animationPrefix=null,this._transitionEnd=null}}getDistributedNodes(t){return t.getDistributedNodes()}resolveAndSetHref(t,e,n){t.href=null==n?e:e+"/../"+n}supportsDOMEvents(){return!0}supportsNativeShadowDOM(){return"function"==typeof document.body.createShadowRoot}getAnimationPrefix(){return this._animationPrefix?this._animationPrefix:""}getTransitionEnd(){return this._transitionEnd?this._transitionEnd:""}supportsAnimation(){return null!=this._animationPrefix&&null!=this._transitionEnd}}const Gl={class:"className",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"},Kl=3,$l={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Yl={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Zl=(()=>{if(It.Node)return It.Node.prototype.contains||function(t){return!!(16&this.compareDocumentPosition(t))}})();class Xl extends Wl{parse(t){throw new Error("parse not implemented")}static makeCurrent(){var t;t=new Xl,zl||(zl=t)}hasProperty(t,e){return e in t}setProperty(t,e,n){t[e]=n}getProperty(t,e){return t[e]}invoke(t,e,n){t[e](...n)}logError(t){window.console&&(console.error?console.error(t):console.log(t))}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}get attrToPropMap(){return Gl}contains(t,e){return Zl.call(t,e)}querySelector(t,e){return t.querySelector(e)}querySelectorAll(t,e){return t.querySelectorAll(e)}on(t,e,n){t.addEventListener(e,n,!1)}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}createMouseEvent(t){const e=this.getDefaultDocument().createEvent("MouseEvent");return e.initEvent(t,!0,!0),e}createEvent(t){const e=this.getDefaultDocument().createEvent("Event");return e.initEvent(t,!0,!0),e}preventDefault(t){t.preventDefault(),t.returnValue=!1}isPrevented(t){return t.defaultPrevented||null!=t.returnValue&&!t.returnValue}getInnerHTML(t){return t.innerHTML}getTemplateContent(t){return"content"in t&&this.isTemplateElement(t)?t.content:null}getOuterHTML(t){return t.outerHTML}nodeName(t){return t.nodeName}nodeValue(t){return t.nodeValue}type(t){return t.type}content(t){return this.hasProperty(t,"content")?t.content:t}firstChild(t){return t.firstChild}nextSibling(t){return t.nextSibling}parentElement(t){return t.parentNode}childNodes(t){return t.childNodes}childNodesAsList(t){const e=t.childNodes,n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r];return n}clearNodes(t){for(;t.firstChild;)t.removeChild(t.firstChild)}appendChild(t,e){t.appendChild(e)}removeChild(t,e){t.removeChild(e)}replaceChild(t,e,n){t.replaceChild(e,n)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}insertBefore(t,e,n){t.insertBefore(n,e)}insertAllBefore(t,e,n){n.forEach(n=>t.insertBefore(n,e))}insertAfter(t,e,n){t.insertBefore(n,e.nextSibling)}setInnerHTML(t,e){t.innerHTML=e}getText(t){return t.textContent}setText(t,e){t.textContent=e}getValue(t){return t.value}setValue(t,e){t.value=e}getChecked(t){return t.checked}setChecked(t,e){t.checked=e}createComment(t){return this.getDefaultDocument().createComment(t)}createTemplate(t){const e=this.getDefaultDocument().createElement("template");return e.innerHTML=t,e}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createElementNS(t,e,n){return(n=n||this.getDefaultDocument()).createElementNS(t,e)}createTextNode(t,e){return(e=e||this.getDefaultDocument()).createTextNode(t)}createScriptTag(t,e,n){const r=(n=n||this.getDefaultDocument()).createElement("SCRIPT");return r.setAttribute(t,e),r}createStyleElement(t,e){const n=(e=e||this.getDefaultDocument()).createElement("style");return this.appendChild(n,this.createTextNode(t,e)),n}createShadowRoot(t){return t.createShadowRoot()}getShadowRoot(t){return t.shadowRoot}getHost(t){return t.host}clone(t){return t.cloneNode(!0)}getElementsByClassName(t,e){return t.getElementsByClassName(e)}getElementsByTagName(t,e){return t.getElementsByTagName(e)}classList(t){return Array.prototype.slice.call(t.classList,0)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}hasClass(t,e){return t.classList.contains(e)}setStyle(t,e,n){t.style[e]=n}removeStyle(t,e){t.style[e]=""}getStyle(t,e){return t.style[e]}hasStyle(t,e,n){const r=this.getStyle(t,e)||"";return n?r==n:r.length>0}tagName(t){return t.tagName}attributeMap(t){const e=new Map,n=t.attributes;for(let r=0;r<n.length;r++){const t=n.item(r);e.set(t.name,t.value)}return e}hasAttribute(t,e){return t.hasAttribute(e)}hasAttributeNS(t,e,n){return t.hasAttributeNS(e,n)}getAttribute(t,e){return t.getAttribute(e)}getAttributeNS(t,e,n){return t.getAttributeNS(e,n)}setAttribute(t,e,n){t.setAttribute(e,n)}setAttributeNS(t,e,n,r){t.setAttributeNS(e,n,r)}removeAttribute(t,e){t.removeAttribute(e)}removeAttributeNS(t,e,n){t.removeAttributeNS(e,n)}templateAwareRoot(t){return this.isTemplateElement(t)?this.content(t):t}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}getBoundingClientRect(t){try{return t.getBoundingClientRect()}catch(e){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}}getTitle(t){return t.title}setTitle(t,e){t.title=e||""}elementMatches(t,e){return!!this.isElementNode(t)&&(t.matches&&t.matches(e)||t.msMatchesSelector&&t.msMatchesSelector(e)||t.webkitMatchesSelector&&t.webkitMatchesSelector(e))}isTemplateElement(t){return this.isElementNode(t)&&"TEMPLATE"===t.nodeName}isTextNode(t){return t.nodeType===Node.TEXT_NODE}isCommentNode(t){return t.nodeType===Node.COMMENT_NODE}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}hasShadowRoot(t){return null!=t.shadowRoot&&t instanceof HTMLElement}isShadowRoot(t){return t instanceof DocumentFragment}importIntoDoc(t){return document.importNode(this.templateAwareRoot(t),!0)}adoptNode(t){return document.adoptNode(t)}getHref(t){return t.getAttribute("href")}getEventKey(t){let e=t.key;if(null==e){if(null==(e=t.keyIdentifier))return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),t.location===Kl&&Yl.hasOwnProperty(e)&&(e=Yl[e]))}return $l[e]||e}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=tu||(tu=document.querySelector("base"))?tu.getAttribute("href"):null;return null==e?null:(n=e,Jl||(Jl=document.createElement("a")),Jl.setAttribute("href",n),"/"===Jl.pathname.charAt(0)?Jl.pathname:"/"+Jl.pathname);var n}resetBaseElement(){tu=null}getUserAgent(){return window.navigator.userAgent}setData(t,e,n){this.setAttribute(t,"data-"+e,n)}getData(t,e){return this.getAttribute(t,"data-"+e)}getComputedStyle(t){return getComputedStyle(t)}supportsWebAnimation(){return"function"==typeof Element.prototype.animate}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return function(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[r,i]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(r.trim()===e)return decodeURIComponent(i)}return null}(document.cookie,t)}setCookie(t,e){document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(e)}}let Jl,tu=null;function eu(){return!!window.history.pushState}const nu=new xt("TRANSITION_ID"),ru=[{provide:Fi,useFactory:function(t,e,n){return()=>{n.get(Vi).donePromise.then(()=>{const n=Ql();Array.prototype.slice.apply(n.querySelectorAll(e,"style[ng-transition]")).filter(e=>n.getAttribute(e,"ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[nu,ja,Le],multi:!0}];class iu{static init(){var t;t=new iu,wo=t}addToWindow(t){It.getAngularTestability=(e,n=!0)=>{const r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r},It.getAllAngularTestabilities=()=>t.getAllTestabilities(),It.getAllAngularRootElements=()=>t.getAllRootElements(),It.frameworkStabilizers||(It.frameworkStabilizers=[]),It.frameworkStabilizers.push(t=>{const e=It.getAllAngularTestabilities();let n=e.length,r=!1;const i=function(e){r=r||e,0==--n&&t(r)};e.forEach(function(t){t.whenStable(i)})})}findTestabilityInTree(t,e,n){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:n?Ql().isShadowRoot(e)?this.findTestabilityInTree(t,Ql().getHost(e),!0):this.findTestabilityInTree(t,Ql().parentElement(e),!0):null}}function ou(t,e){"undefined"!=typeof COMPILED&&COMPILED||((It.ng=It.ng||{})[t]=e)}const su=(()=>({ApplicationRef:Do,NgZone:uo}))();function au(t){return zo(t)}const lu=new xt("EventManagerPlugins");class uu{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let r=0;r<n.length;r++){const e=n[r];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error(`No event manager plugin found for event ${t}`)}}class cu{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const r=Ql().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,n)}}class hu{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}class du extends hu{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const n=this._doc.createElement("style");n.textContent=t,this._styleNodes.add(e.appendChild(n))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>Ql().remove(t))}}const fu={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},pu=/%COMP%/g,mu="_nghost-%COMP%",gu="_ngcontent-%COMP%";function yu(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?yu(t,i,n):(i=i.replace(pu,t),n.push(i))}return n}function vu(t){return e=>{!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}class _u{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new bu(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case Gt.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new Su(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case Gt.Native:case Gt.ShadowDom:return new Cu(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=yu(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}class bu{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(fu[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=r+":"+e;const i=fu[r];i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=fu[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&gn.DashCase?t.style.setProperty(e,n,r&gn.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&gn.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){Eu(e,"property"),t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return Eu(e,"listener"),"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,vu(n)):this.eventManager.addEventListener(t,e,vu(n))}}const wu=(()=>"@".charCodeAt(0))();function Eu(t,e){if(t.charCodeAt(0)===wu)throw new Error(`Found the synthetic ${e} ${t}. Please include either "BrowserAnimationsModule" or "NoopAnimationsModule" in your application.`)}class Su extends bu{constructor(t,e,n,r){super(t),this.component=n;const i=yu(r+"-"+n.id,n.styles,[]);e.addStyles(i),this.contentAttr=gu.replace(pu,r+"-"+n.id),this.hostAttr=mu.replace(pu,r+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class Cu extends bu{constructor(t,e,n,r){super(t),this.sharedStylesHost=e,this.hostEl=n,this.component=r,this.shadowRoot=r.encapsulation===Gt.ShadowDom?n.attachShadow({mode:"open"}):n.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const i=yu(r.id,r.styles,[]);for(let o=0;o<i.length;o++){const t=document.createElement("style");t.textContent=i[o],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}const Tu=(()=>"undefined"!=typeof Zone&&Zone.__symbol__||function(t){return"__zone_symbol__"+t})(),Iu=Tu("addEventListener"),xu=Tu("removeEventListener"),Au={},ku="FALSE",Du="ANGULAR",Nu="addEventListener",Ru="removeEventListener",Ou="__zone_symbol__propagationStopped",Pu="__zone_symbol__stopImmediatePropagation",Mu=(()=>{const t="undefined"!=typeof Zone&&Zone[Tu("BLACK_LISTED_EVENTS")];if(t){const e={};return t.forEach(t=>{e[t]=t}),e}})(),Lu=function(t){return!!Mu&&Mu.hasOwnProperty(t)},Fu=function(t){const e=Au[t.type];if(!e)return;const n=this[e];if(!n)return;const r=[t];if(1===n.length){const t=n[0];return t.zone!==Zone.current?t.zone.run(t.handler,this,r):t.handler.apply(this,r)}{const e=n.slice();for(let n=0;n<e.length&&!0!==t[Ou];n++){const t=e[n];t.zone!==Zone.current?t.zone.run(t.handler,this,r):t.handler.apply(this,r)}}};class Vu extends cu{constructor(t,e,n){super(t),this.ngZone=e,n&&Ha(n)||this.patchEvent()}patchEvent(){if("undefined"==typeof Event||!Event||!Event.prototype)return;if(Event.prototype[Pu])return;const t=Event.prototype[Pu]=Event.prototype.stopImmediatePropagation;Event.prototype.stopImmediatePropagation=function(){this&&(this[Ou]=!0),t&&t.apply(this,arguments)}}supports(t){return!0}addEventListener(t,e,n){let r=n;if(!t[Iu]||uo.isInAngularZone()&&!Lu(e))t[Nu](e,r,!1);else{let n=Au[e];n||(n=Au[e]=Tu(Du+e+ku));let i=t[n];const o=i&&i.length>0;i||(i=t[n]=[]);const s=Lu(e)?Zone.root:Zone.current;if(0===i.length)i.push({zone:s,handler:r});else{let t=!1;for(let e=0;e<i.length;e++)if(i[e].handler===r){t=!0;break}t||i.push({zone:s,handler:r})}o||t[Iu](e,Fu,!1)}return()=>this.removeEventListener(t,e,r)}removeEventListener(t,e,n){let r=t[xu];if(!r)return t[Ru].apply(t,[e,n,!1]);let i=Au[e],o=i&&t[i];if(!o)return t[Ru].apply(t,[e,n,!1]);let s=!1;for(let a=0;a<o.length;a++)if(o[a].handler===n){s=!0,o.splice(a,1);break}s?0===o.length&&r.apply(t,[e,Fu,!1]):t[Ru].apply(t,[e,n,!1])}}const Bu={pan:!0,panstart:!0,panmove:!0,panend:!0,pancancel:!0,panleft:!0,panright:!0,panup:!0,pandown:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchcancel:!0,pinchin:!0,pinchout:!0,press:!0,pressup:!0,rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,rotatecancel:!0,swipe:!0,swipeleft:!0,swiperight:!0,swipeup:!0,swipedown:!0,tap:!0},Uu=new xt("HammerGestureConfig"),qu=new xt("HammerLoader");class ju{constructor(){this.events=[],this.overrides={}}buildHammer(t){const e=new Hammer(t,this.options);e.get("pinch").set({enable:!0}),e.get("rotate").set({enable:!0});for(const n in this.overrides)e.get(n).set(this.overrides[n]);return e}}class zu extends cu{constructor(t,e,n,r){super(t),this._config=e,this.console=n,this.loader=r}supports(t){return!(!Bu.hasOwnProperty(t.toLowerCase())&&!this.isCustomEvent(t)||!window.Hammer&&!this.loader&&(this.console.warn(`The "${t}" event cannot be bound because Hammer.JS is not `+"loaded and no custom loader has been specified."),1))}addEventListener(t,e,n){const r=this.manager.getZone();if(e=e.toLowerCase(),!window.Hammer&&this.loader){let r=!1,i=()=>{r=!0};return this.loader().then(()=>{if(!window.Hammer)return this.console.warn("The custom HAMMER_LOADER completed, but Hammer.JS is not present."),void(i=()=>{});r||(i=this.addEventListener(t,e,n))}).catch(()=>{this.console.warn(`The "${e}" event cannot be bound because the custom `+"Hammer.JS loader failed."),i=()=>{}}),()=>{i()}}return r.runOutsideAngular(()=>{const i=this._config.buildHammer(t),o=function(t){r.runGuarded(function(){n(t)})};return i.on(e,o),()=>{i.off(e,o),"function"==typeof i.destroy&&i.destroy()}})}isCustomEvent(t){return this._config.events.indexOf(t)>-1}}const Qu=["alt","control","meta","shift"],Hu={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};class Wu extends cu{constructor(t){super(t)}supports(t){return null!=Wu.parseEventName(t)}addEventListener(t,e,n){const r=Wu.parseEventName(e),i=Wu.eventCallback(r.fullKey,n,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ql().onAndCancel(t,r.domEventName,i))}static parseEventName(t){const e=t.toLowerCase().split("."),n=e.shift();if(0===e.length||"keydown"!==n&&"keyup"!==n)return null;const r=Wu._normalizeKey(e.pop());let i="";if(Qu.forEach(t=>{const n=e.indexOf(t);n>-1&&(e.splice(n,1),i+=t+".")}),i+=r,0!=e.length||0===r.length)return null;const o={};return o.domEventName=n,o.fullKey=i,o}static getEventFullKey(t){let e="",n=Ql().getEventKey(t);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),Qu.forEach(r=>{r!=n&&(0,Hu[r])(t)&&(e+=r+".")}),e+=n}static eventCallback(t,e,n){return r=>{Wu.getEventFullKey(r)===t&&n.runGuarded(()=>e(r))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}class Gu{}class Ku extends Gu{constructor(t){super(),this._doc=t}sanitize(t,e){if(null==e)return null;switch(t){case Ie.NONE:return e;case Ie.HTML:return e instanceof Yu?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"HTML"),function(t,e){let n=null;try{Ce=Ce||new oe(t);let r=e?String(e):"";n=Ce.getInertBodyElement(r);let i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=n.innerHTML,n=Ce.getInertBodyElement(r)}while(r!==o);const s=new be,a=s.sanitizeChildren(Te(n)||n);return ie()&&s.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),a}finally{if(n){const t=Te(n)||n;for(;t.firstChild;)t.removeChild(t.firstChild)}}}(this._doc,String(e)));case Ie.STYLE:return e instanceof Zu?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"Style"),function(t){if(!(t=String(t).trim()))return"";const e=t.match(ke);return e&&le(e[1])===e[1]||t.match(Ae)&&function(t){let e=!0,n=!0;for(let r=0;r<t.length;r++){const i=t.charAt(r);"'"===i&&n?e=!e:'"'===i&&e&&(n=!n)}return e&&n}(t)?t:(ie()&&console.warn(`WARNING: sanitizing unsafe style value ${t} (see http://g.co/ng/security#xss).`),"unsafe")}(e));case Ie.SCRIPT:if(e instanceof Xu)return e.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(e,"Script"),new Error("unsafe value used in a script context");case Ie.URL:return e instanceof tc||e instanceof Ju?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"URL"),le(String(e)));case Ie.RESOURCE_URL:if(e instanceof tc)return e.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(e,"ResourceURL"),new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see http://g.co/ng/security#xss)`)}}checkNotSafeValue(t,e){if(t instanceof $u)throw new Error(`Required a safe ${e}, got a ${t.getTypeName()} `+"(see http://g.co/ng/security#xss)")}bypassSecurityTrustHtml(t){return new Yu(t)}bypassSecurityTrustStyle(t){return new Zu(t)}bypassSecurityTrustScript(t){return new Xu(t)}bypassSecurityTrustUrl(t){return new Ju(t)}bypassSecurityTrustResourceUrl(t){return new tc(t)}}class $u{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity}`+" (see http://g.co/ng/security#xss)"}}class Yu extends $u{getTypeName(){return"HTML"}}class Zu extends $u{getTypeName(){return"Style"}}class Xu extends $u{getTypeName(){return"Script"}}class Ju extends $u{getTypeName(){return"URL"}}class tc extends $u{getTypeName(){return"ResourceURL"}}const ec=Io(Ho,"browser",[{provide:zi,useValue:za},{provide:ji,useValue:function(){Xl.makeCurrent(),iu.init()},multi:!0},{provide:Ea,useClass:class extends Ea{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=Ql().getLocation(),this._history=Ql().getHistory()}getBaseHrefFromDOM(){return Ql().getBaseHref(this._doc)}onPopState(t){Ql().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}onHashChange(t){Ql().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){eu()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){eu()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}},deps:[ja]},{provide:ja,useFactory:function(){return document},deps:[]}]);function nc(){return new ee}class rc{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:rc,providers:[{provide:Bi,useValue:t.appId},{provide:nu,useExisting:Bi},ru]}}}"undefined"!=typeof window&&window;class ic{constructor(t,e){this.id=t,this.url=e}}class oc extends ic{constructor(t,e,n="imperative",r=null){super(t,e),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class sc extends ic{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class ac extends ic{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class lc extends ic{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class uc extends ic{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class cc extends ic{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class hc extends ic{constructor(t,e,n,r,i){super(t,e),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class dc extends ic{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class fc extends ic{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class pc{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class mc{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class gc{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class yc{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class vc{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class _c{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class bc{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class wc{}const Ec="primary";class Sc{constructor(t){this.params=t||{}}has(t){return this.params.hasOwnProperty(t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function Cc(t){return new Sc(t)}const Tc="ngNavigationCancelingError";function Ic(t){const e=Error("NavigationCancelingError: "+t);return e[Tc]=!0,e}function xc(t,e,n){const r=n.path.split("/");if(r.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let o=0;o<r.length;o++){const e=r[o],n=t[o];if(e.startsWith(":"))i[e.substring(1)]=n;else if(e!==n.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}class Ac{constructor(t,e){this.routes=t,this.module=e}}function kc(t,e=""){for(let n=0;n<t.length;n++){const r=t[n];Dc(r,Nc(e,r))}}function Dc(t,e){if(!t)throw new Error(`\n      Invalid configuration of route '${e}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);if(Array.isArray(t))throw new Error(`Invalid configuration of route '${e}': Array cannot be specified`);if(!t.component&&!t.children&&!t.loadChildren&&t.outlet&&t.outlet!==Ec)throw new Error(`Invalid configuration of route '${e}': a componentless route without children or loadChildren cannot have a named outlet set`);if(t.redirectTo&&t.children)throw new Error(`Invalid configuration of route '${e}': redirectTo and children cannot be used together`);if(t.redirectTo&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': redirectTo and loadChildren cannot be used together`);if(t.children&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': children and loadChildren cannot be used together`);if(t.redirectTo&&t.component)throw new Error(`Invalid configuration of route '${e}': redirectTo and component cannot be used together`);if(t.path&&t.matcher)throw new Error(`Invalid configuration of route '${e}': path and matcher cannot be used together`);if(void 0===t.redirectTo&&!t.component&&!t.children&&!t.loadChildren)throw new Error(`Invalid configuration of route '${e}'. One of the following must be provided: component, redirectTo, children or loadChildren`);if(void 0===t.path&&void 0===t.matcher)throw new Error(`Invalid configuration of route '${e}': routes must have either a path or a matcher specified`);if("string"==typeof t.path&&"/"===t.path.charAt(0))throw new Error(`Invalid configuration of route '${e}': path cannot start with a slash`);if(""===t.path&&void 0!==t.redirectTo&&void 0===t.pathMatch)throw new Error(`Invalid configuration of route '{path: "${e}", redirectTo: "${t.redirectTo}"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`);if(void 0!==t.pathMatch&&"full"!==t.pathMatch&&"prefix"!==t.pathMatch)throw new Error(`Invalid configuration of route '${e}': pathMatch can only be set to 'prefix' or 'full'`);t.children&&kc(t.children,e)}function Nc(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function Rc(t){const e=t.children&&t.children.map(Rc),n=e?Object.assign({},t,{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&n.outlet!==Ec&&(n.component=wc),n}function Oc(t,e){const n=Object.keys(t),r=Object.keys(e);if(!n||!r||n.length!=r.length)return!1;let i;for(let o=0;o<n.length;o++)if(t[i=n[o]]!==e[i])return!1;return!0}function Pc(t){return Array.prototype.concat.apply([],t)}function Mc(t){return t.length>0?t[t.length-1]:null}function Lc(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function Fc(t){return tn(t)?t:Je(t)?W(Promise.resolve(t)):Za(t)}function Vc(t,e,n){return n?function(t,e){return Oc(t,e)}(t.queryParams,e.queryParams)&&function t(e,n){if(!jc(e.segments,n.segments))return!1;if(e.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children){if(!e.children[r])return!1;if(!t(e.children[r],n.children[r]))return!1}return!0}(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>e[n]===t[n])}(t.queryParams,e.queryParams)&&function t(e,n){return function e(n,r,i){if(n.segments.length>i.length){return!!jc(n.segments.slice(0,i.length),i)&&!r.hasChildren()}if(n.segments.length===i.length){if(!jc(n.segments,i))return!1;for(const e in r.children){if(!n.children[e])return!1;if(!t(n.children[e],r.children[e]))return!1}return!0}{const t=i.slice(0,n.segments.length),o=i.slice(n.segments.length);return!!jc(n.segments,t)&&!!n.children[Ec]&&e(n.children[Ec],r,o)}}(e,n,n.segments)}(t.root,e.root)}class Bc{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Cc(this.queryParams)),this._queryParamMap}toString(){return Wc.serialize(this)}}class Uc{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Lc(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Gc(this)}}class qc{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=Cc(this.parameters)),this._parameterMap}toString(){return Jc(this)}}function jc(t,e){return t.length===e.length&&t.every((t,n)=>t.path===e[n].path)}function zc(t,e){let n=[];return Lc(t.children,(t,r)=>{r===Ec&&(n=n.concat(e(t,r)))}),Lc(t.children,(t,r)=>{r!==Ec&&(n=n.concat(e(t,r)))}),n}class Qc{}class Hc{parse(t){const e=new ih(t);return new Bc(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){var e;return`${`/${function t(e,n){if(!e.hasChildren())return Gc(e);if(n){const n=e.children[Ec]?t(e.children[Ec],!1):"",r=[];return Lc(e.children,(e,n)=>{n!==Ec&&r.push(`${n}:${t(e,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=zc(e,(n,r)=>r===Ec?[t(e.children[Ec],!1)]:[`${r}:${t(n,!1)}`]);return`${Gc(e)}/(${n.join("//")})`}}(t.root,!0)}`}${function(t){const e=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(t=>`${$c(e)}=${$c(t)}`).join("&"):`${$c(e)}=${$c(n)}`});return e.length?`?${e.join("&")}`:""}(t.queryParams)}${"string"==typeof t.fragment?`#${e=t.fragment,encodeURI(e)}`:""}`}}const Wc=new Hc;function Gc(t){return t.segments.map(t=>Jc(t)).join("/")}function Kc(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function $c(t){return Kc(t).replace(/%3B/gi,";")}function Yc(t){return Kc(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Zc(t){return decodeURIComponent(t)}function Xc(t){return Zc(t.replace(/\+/g,"%20"))}function Jc(t){return`${Yc(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${Yc(t)}=${Yc(e[t])}`).join("")}`;var e}const th=/^[^\/()?;=#]+/;function eh(t){const e=t.match(th);return e?e[0]:""}const nh=/^[^=?&#]+/,rh=/^[^?&#]+/;class ih{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Uc([],{}):new Uc([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n[Ec]=new Uc(t,e)),n}parseSegment(){const t=eh(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new qc(Zc(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=eh(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=eh(this.remaining);t&&this.capture(n=t)}t[Zc(e)]=Zc(n)}parseQueryParam(t){const e=function(t){const e=t.match(nh);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(rh);return e?e[0]:""}(this.remaining);t&&this.capture(n=t)}const r=Xc(e),i=Xc(n);if(t.hasOwnProperty(r)){let e=t[r];Array.isArray(e)||(t[r]=e=[e]),e.push(i)}else t[r]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=eh(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):t&&(i=Ec);const o=this.parseChildren();e[i]=1===Object.keys(o).length?o[Ec]:new Uc([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class oh{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=sh(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=sh(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=ah(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return ah(t,this._root).map(t=>t.value)}}function sh(t,e){if(t===e.value)return e;for(const n of e.children){const e=sh(t,n);if(e)return e}return null}function ah(t,e){if(t===e.value)return[e];for(const n of e.children){const r=ah(t,n);if(r.length)return r.unshift(e),r}return[]}class lh{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function uh(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class ch extends oh{constructor(t,e){super(t),this.snapshot=e,gh(this,t)}toString(){return this.snapshot.toString()}}function hh(t,e){const n=function(t,e){const n=new ph([],{},{},"",{},Ec,e,null,t.root,-1,{});return new mh("",new lh(n,[]))}(t,e),r=new Xa([new qc("",{})]),i=new Xa({}),o=new Xa({}),s=new Xa({}),a=new Xa(""),l=new dh(r,i,s,a,o,Ec,e,n.root);return l.snapshot=n.root,new ch(new lh(l,[]),n)}class dh{constructor(t,e,n,r,i,o,s,a){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=s,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(j(t=>Cc(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(j(t=>Cc(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function fh(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const t=n[r],e=n[r-1];if(t.routeConfig&&""===t.routeConfig.path)r--;else{if(e.component)break;r--}}return function(t){return t.reduce((t,e)=>({params:Object.assign({},t.params,e.params),data:Object.assign({},t.data,e.data),resolve:Object.assign({},t.resolve,e._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class ph{constructor(t,e,n,r,i,o,s,a,l,u,c){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=s,this.routeConfig=a,this._urlSegment=l,this._lastPathIndex=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Cc(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Cc(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class mh extends oh{constructor(t,e){super(e),this.url=t,gh(this,e)}toString(){return yh(this._root)}}function gh(t,e){e.value._routerState=t,e.children.forEach(e=>gh(t,e))}function yh(t){const e=t.children.length>0?` { ${t.children.map(yh).join(", ")} } `:"";return`${t.value}${e}`}function vh(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Oc(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),Oc(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Oc(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),Oc(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function _h(t,e){var n,r;return Oc(t.params,e.params)&&jc(n=t.url,r=e.url)&&n.every((t,e)=>Oc(t.parameters,r[e].parameters))&&!(!t.parent!=!e.parent)&&(!t.parent||_h(t.parent,e.parent))}function bh(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function wh(t,e,n,r,i){let o={};return r&&Lc(r,(t,e)=>{o[e]=Array.isArray(t)?t.map(t=>`${t}`):`${t}`}),new Bc(n.root===t?e:function t(e,n,r){const i={};return Lc(e.children,(e,o)=>{i[o]=e===n?r:t(e,n,r)}),new Uc(e.segments,i)}(n.root,t,e),o,i)}class Eh{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&bh(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(t=>"object"==typeof t&&null!=t&&t.outlets);if(r&&r!==Mc(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Sh{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function Ch(t){return"object"==typeof t&&null!=t&&t.outlets?t.outlets[Ec]:`${t}`}function Th(t,e,n){if(t||(t=new Uc([],{})),0===t.segments.length&&t.hasChildren())return Ih(t,e,n);const r=function(t,e,n){let r=0,i=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return o;const e=t.segments[i],s=Ch(n[r]),a=r<n.length-1?n[r+1]:null;if(i>0&&void 0===s)break;if(s&&a&&"object"==typeof a&&void 0===a.outlets){if(!Dh(s,a,e))return o;r+=2}else{if(!Dh(s,{},e))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const e=new Uc(t.segments.slice(0,r.pathIndex),{});return e.children[Ec]=new Uc(t.segments.slice(r.pathIndex),t.children),Ih(e,0,i)}return r.match&&0===i.length?new Uc(t.segments,{}):r.match&&!t.hasChildren()?xh(t,e,n):r.match?Ih(t,0,i):xh(t,e,n)}function Ih(t,e,n){if(0===n.length)return new Uc(t.segments,{});{const r=function(t){return"object"!=typeof t[0]?{[Ec]:t}:void 0===t[0].outlets?{[Ec]:t}:t[0].outlets}(n),i={};return Lc(r,(n,r)=>{null!==n&&(i[r]=Th(t.children[r],e,n))}),Lc(t.children,(t,e)=>{void 0===r[e]&&(i[e]=t)}),new Uc(t.segments,i)}}function xh(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){if("object"==typeof n[i]&&void 0!==n[i].outlets){const t=Ah(n[i].outlets);return new Uc(r,t)}if(0===i&&bh(n[0])){r.push(new qc(t.segments[e].path,n[0])),i++;continue}const o=Ch(n[i]),s=i<n.length-1?n[i+1]:null;o&&s&&bh(s)?(r.push(new qc(o,kh(s))),i+=2):(r.push(new qc(o,{})),i++)}return new Uc(r,{})}function Ah(t){const e={};return Lc(t,(t,n)=>{null!==t&&(e[n]=xh(new Uc([],{}),0,t))}),e}function kh(t){const e={};return Lc(t,(t,n)=>e[n]=`${t}`),e}function Dh(t,e,n){return t==n.path&&Oc(e,n.parameters)}const Nh=(t,e,n)=>j(r=>(new Rh(e,r.targetRouterState,r.currentRouterState,n).activate(t),r));class Rh{constructor(t,e,n,r){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=r}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),vh(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const r=uh(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,r[e],n),delete r[e]}),Lc(r,(t,e)=>{this.deactivateRouteAndItsChildren(t,n)})}deactivateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(r===i)if(r.component){const i=n.getContext(r.outlet);i&&this.deactivateChildRoutes(t,e,i.children)}else this.deactivateChildRoutes(t,e,n);else i&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet);if(n&&n.outlet){const e=n.outlet.detach(),r=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:r})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet);if(n){const r=uh(t),i=t.value.component?n.children:e;Lc(r,(t,e)=>this.deactivateRouteAndItsChildren(t,i)),n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated())}}activateChildRoutes(t,e,n){const r=uh(e);t.children.forEach(t=>{this.activateRoutes(t,r[t.value.outlet],n),this.forwardEvent(new _c(t.value.snapshot))}),t.children.length&&this.forwardEvent(new yc(t.value.snapshot))}activateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(vh(r),r===i)if(r.component){const i=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,i.children)}else this.activateChildRoutes(t,e,n);else if(r.component){const e=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const t=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),Oh(t.route)}else{const n=function(t){for(let e=r.snapshot.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(),i=n?n.module.componentFactoryResolver:null;e.attachRef=null,e.route=r,e.resolver=i,e.outlet&&e.outlet.activateWith(r,i),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,n)}}function Oh(t){vh(t.value),t.children.forEach(Oh)}function Ph(t){return"function"==typeof t}function Mh(t){return t instanceof Bc}class Lh{constructor(t){this.segmentGroup=t||null}}class Fh{constructor(t){this.urlTree=t}}function Vh(t){return new w(e=>e.error(new Lh(t)))}function Bh(t){return new w(e=>e.error(new Fh(t)))}function Uh(t){return new w(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class qh{constructor(t,e,n,r,i){this.configLoader=e,this.urlSerializer=n,this.urlTree=r,this.config=i,this.allowRedirects=!0,this.ngModule=t.get(zt)}apply(){return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,Ec).pipe(j(t=>this.createUrlTree(t,this.urlTree.queryParams,this.urlTree.fragment))).pipe(Sl(t=>{if(t instanceof Fh)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof Lh)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,Ec).pipe(j(e=>this.createUrlTree(e,t.queryParams,t.fragment))).pipe(Sl(t=>{if(t instanceof Lh)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const r=t.segments.length>0?new Uc([],{[Ec]:t}):t;return new Bc(r,e,n)}expandSegmentGroup(t,e,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe(j(t=>new Uc([],t))):this.expandSegment(t,n,e,n.segments,r,!0)}expandChildren(t,e,n){return function(t,e){if(0===Object.keys(t).length)return Za({});const n=[],r=[],i={};return Lc(t,(t,o)=>{const s=e(o,t).pipe(j(t=>i[o]=t));o===Ec?n.push(s):r.push(s)}),Za.apply(null,n.concat(r)).pipe(sl(),El(),j(()=>i))}(n.children,(n,r)=>this.expandSegmentGroup(t,e,r,n))}expandSegment(t,e,n,r,i,o){return Za(...n).pipe(j(s=>this.expandSegmentAgainstRoute(t,e,n,s,r,i,o).pipe(Sl(t=>{if(t instanceof Lh)return Za(null);throw t}))),sl(),kl(t=>!!t),Sl((t,n)=>{if(t instanceof tl||"EmptyError"===t.name){if(this.noLeftoversInUrl(e,r,i))return Za(new Uc([],{}));throw new Lh(e)}throw t}))}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}expandSegmentAgainstRoute(t,e,n,r,i,o,s){return Hh(r)!==o?Vh(e):void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,i):s&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o):Vh(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,r){const i=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Bh(i):this.lineralizeSegments(n,i).pipe(G(n=>{const i=new Uc(n,{});return this.expandSegment(t,i,e,n,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o){const{matched:s,consumedSegments:a,lastChild:l,positionalParamSegments:u}=jh(e,r,i);if(!s)return Vh(e);const c=this.applyRedirectCommands(a,r.redirectTo,u);return r.redirectTo.startsWith("/")?Bh(c):this.lineralizeSegments(r,c).pipe(G(r=>this.expandSegment(t,e,n,r.concat(i.slice(l)),o,!1)))}matchSegmentAgainstRoute(t,e,n,r){if("**"===n.path)return n.loadChildren?this.configLoader.load(t.injector,n).pipe(j(t=>(n._loadedConfig=t,new Uc(r,{})))):Za(new Uc(r,{}));const{matched:i,consumedSegments:o,lastChild:s}=jh(e,n,r);if(!i)return Vh(e);const a=r.slice(s);return this.getChildConfig(t,n,r).pipe(G(t=>{const n=t.module,r=t.routes,{segmentGroup:i,slicedSegments:s}=function(t,e,n,r){return n.length>0&&function(t,e,n){return r.some(n=>Qh(t,e,n)&&Hh(n)!==Ec)}(t,n)?{segmentGroup:zh(new Uc(e,function(t,e){const n={};n[Ec]=e;for(const r of t)""===r.path&&Hh(r)!==Ec&&(n[Hh(r)]=new Uc([],{}));return n}(r,new Uc(n,t.children)))),slicedSegments:[]}:0===n.length&&function(t,e,n){return r.some(n=>Qh(t,e,n))}(t,n)?{segmentGroup:zh(new Uc(t.segments,function(t,e,n,r){const i={};for(const o of n)Qh(t,e,o)&&!r[Hh(o)]&&(i[Hh(o)]=new Uc([],{}));return Object.assign({},r,i)}(t,n,r,t.children))),slicedSegments:n}:{segmentGroup:t,slicedSegments:n}}(e,o,a,r);return 0===s.length&&i.hasChildren()?this.expandChildren(n,r,i).pipe(j(t=>new Uc(o,t))):0===r.length&&0===s.length?Za(new Uc(o,{})):this.expandSegment(n,i,r,s,Ec,!0).pipe(j(t=>new Uc(o.concat(t.segments),t.children)))}))}getChildConfig(t,e,n){return e.children?Za(new Ac(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?Za(e._loadedConfig):function(t,e,n){const r=e.canLoad;return r&&0!==r.length?W(r).pipe(j(r=>{const i=t.get(r);let o;if(function(t){return t&&Ph(t.canLoad)}(i))o=i.canLoad(e,n);else{if(!Ph(i))throw new Error("Invalid CanLoad guard");o=i(e,n)}return Fc(o)})).pipe(sl(),(i=t=>!0===t,t=>t.lift(new Dl(i,void 0,t)))):Za(!0);var i}(t.injector,e,n).pipe(G(n=>n?this.configLoader.load(t.injector,e).pipe(j(t=>(e._loadedConfig=t,t))):function(t){return new w(e=>e.error(Ic(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):Za(new Ac([],t))}lineralizeSegments(t,e){let n=[],r=e.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Za(n);if(r.numberOfChildren>1||!r.children[Ec])return Uh(t.redirectTo);r=r.children[Ec]}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,r){const i=this.createSegmentGroup(t,e.root,n,r);return new Bc(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return Lc(t,(t,r)=>{if("string"==typeof t&&t.startsWith(":")){const i=t.substring(1);n[r]=e[i]}else n[r]=t}),n}createSegmentGroup(t,e,n,r){const i=this.createSegments(t,e.segments,n,r);let o={};return Lc(e.children,(e,i)=>{o[i]=this.createSegmentGroup(t,e,n,r)}),new Uc(i,o)}createSegments(t,e,n,r){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,r):this.findOrReturn(e,n))}findPosParam(t,e,n){const r=n[e.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return r}findOrReturn(t,e){let n=0;for(const r of e){if(r.path===t.path)return e.splice(n),r;n++}return t}}function jh(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const r=(e.matcher||xc)(n,t,e);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function zh(t){if(1===t.numberOfChildren&&t.children[Ec]){const e=t.children[Ec];return new Uc(t.segments.concat(e.segments),e.children)}return t}function Qh(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function Hh(t){return t.outlet||Ec}class Wh{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Gh{constructor(t,e){this.component=t,this.route=e}}function Kh(t,e,n){const r=t._root;return function t(e,n,r,i,o={canDeactivateChecks:[],canActivateChecks:[]}){const s=uh(n);return e.children.forEach(e=>{!function(e,n,r,i,o={canDeactivateChecks:[],canActivateChecks:[]}){const s=e.value,a=n?n.value:null,l=r?r.getContext(e.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){const u=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!jc(t.url,e.url);case"pathParamsOrQueryParamsChange":return!jc(t.url,e.url)||!Oc(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!_h(t,e)||!Oc(t.queryParams,e.queryParams);case"paramsChange":default:return!_h(t,e)}}(a,s,s.routeConfig.runGuardsAndResolvers);u?o.canActivateChecks.push(new Wh(i)):(s.data=a.data,s._resolvedData=a._resolvedData),t(e,n,s.component?l?l.children:null:r,i,o),u&&o.canDeactivateChecks.push(new Gh(l&&l.outlet&&l.outlet.component||null,a))}else a&&Yh(n,l,o),o.canActivateChecks.push(new Wh(i)),t(e,null,s.component?l?l.children:null:r,i,o)}(e,s[e.value.outlet],r,i.concat([e.value]),o),delete s[e.value.outlet]}),Lc(s,(t,e)=>Yh(t,r.getContext(e),o)),o}(r,e?e._root:null,n,[r.value])}function $h(t,e,n){const r=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(r?r.module.injector:n).get(t)}function Yh(t,e,n){const r=uh(t),i=t.value;Lc(r,(t,r)=>{Yh(t,i.component?e?e.children.getContext(r):null:e,n)}),n.canDeactivateChecks.push(new Gh(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}const Zh=Symbol("INITIAL_VALUE");function Xh(){return Rl(t=>nl(...t.map(t=>t.pipe(Il(1),Ll(Zh)))).pipe(Fl((t,e)=>{let n=!1;return e.reduce((t,r,i)=>{if(t!==Zh)return t;if(r===Zh&&(n=!0),!n){if(!1===r)return r;if(i===e.length-1||Mh(r))return r}return t},t)},Zh),al(t=>t!==Zh),j(t=>Mh(t)?t:!0===t),Il(1)))}function Jh(t,e){return null!==t&&e&&e(new vc(t)),Za(!0)}function td(t,e){return null!==t&&e&&e(new gc(t)),Za(!0)}function ed(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;return r&&0!==r.length?Za(r.map(r=>ol(()=>{const i=$h(r,e,n);let o;if(function(t){return t&&Ph(t.canActivate)}(i))o=Fc(i.canActivate(e,t));else{if(!Ph(i))throw new Error("Invalid CanActivate guard");o=Fc(i(e,t))}return o.pipe(kl())}))).pipe(Xh()):Za(!0)}function nd(t,e,n){const r=e[e.length-1],i=e.slice(0,e.length-1).reverse().map(t=>(function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null})(t)).filter(t=>null!==t).map(e=>ol(()=>Za(e.guards.map(i=>{const o=$h(i,e.node,n);let s;if(function(t){return t&&Ph(t.canActivateChild)}(o))s=Fc(o.canActivateChild(r,t));else{if(!Ph(o))throw new Error("Invalid CanActivateChild guard");s=Fc(o(r,t))}return s.pipe(kl())})).pipe(Xh())));return Za(i).pipe(Xh())}class rd{}class id{constructor(t,e,n,r,i,o){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=i,this.relativeLinkResolution=o}recognize(){try{const e=ad(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,n=this.processSegmentGroup(this.config,e,Ec),r=new ph([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Ec,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new lh(r,n),o=new mh(this.url,i);return this.inheritParamsAndData(o._root),Za(o)}catch(t){return new w(e=>e.error(t))}}inheritParamsAndData(t){const e=t.value,n=fh(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=zc(e,(e,n)=>this.processSegmentGroup(t,e,n));return function(t){const e={};n.forEach(t=>{const n=e[t.value.outlet];if(n){const e=n.url.map(t=>t.toString()).join("/"),r=t.value.url.map(t=>t.toString()).join("/");throw new Error(`Two segments cannot have the same outlet name: '${e}' and '${r}'.`)}e[t.value.outlet]=t.value})}(),n.sort((t,e)=>t.value.outlet===Ec?-1:e.value.outlet===Ec?1:t.value.outlet.localeCompare(e.value.outlet)),n}processSegment(t,e,n,r){for(const o of t)try{return this.processSegmentAgainstRoute(o,e,n,r)}catch(i){if(!(i instanceof rd))throw i}if(this.noLeftoversInUrl(e,n,r))return[];throw new rd}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}processSegmentAgainstRoute(t,e,n,r){if(t.redirectTo)throw new rd;if((t.outlet||Ec)!==r)throw new rd;let i,o=[],s=[];if("**"===t.path){const o=n.length>0?Mc(n).parameters:{};i=new ph(n,o,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,cd(t),r,t.component,t,od(e),sd(e)+n.length,hd(t))}else{const a=function(t,e,n){if(""===e.path){if("full"===e.pathMatch&&(t.hasChildren()||n.length>0))throw new rd;return{consumedSegments:[],lastChild:0,parameters:{}}}const r=(e.matcher||xc)(n,t,e);if(!r)throw new rd;const i={};Lc(r.posParams,(t,e)=>{i[e]=t.path});const o=r.consumed.length>0?Object.assign({},i,r.consumed[r.consumed.length-1].parameters):i;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o}}(e,t,n);o=a.consumedSegments,s=n.slice(a.lastChild),i=new ph(o,a.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,cd(t),r,t.component,t,od(e),sd(e)+o.length,hd(t))}const a=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:l,slicedSegments:u}=ad(e,o,s,a,this.relativeLinkResolution);if(0===u.length&&l.hasChildren()){const t=this.processChildren(a,l);return[new lh(i,t)]}if(0===a.length&&0===u.length)return[new lh(i,[])];const c=this.processSegment(a,l,u,Ec);return[new lh(i,c)]}}function od(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function sd(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)n+=(e=e._sourceSegment)._segmentIndexShift?e._segmentIndexShift:0;return n-1}function ad(t,e,n,r,i){if(n.length>0&&function(t,e,n){return r.some(n=>ld(t,e,n)&&ud(n)!==Ec)}(t,n)){const i=new Uc(e,function(t,e,n,r){const i={};i[Ec]=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const o of n)if(""===o.path&&ud(o)!==Ec){const n=new Uc([],{});n._sourceSegment=t,n._segmentIndexShift=e.length,i[ud(o)]=n}return i}(t,e,r,new Uc(n,t.children)));return i._sourceSegment=t,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return r.some(n=>ld(t,e,n))}(t,n)){const o=new Uc(t.segments,function(t,e,n,r,i,o){const s={};for(const a of r)if(ld(t,n,a)&&!i[ud(a)]){const n=new Uc([],{});n._sourceSegment=t,n._segmentIndexShift="legacy"===o?t.segments.length:e.length,s[ud(a)]=n}return Object.assign({},i,s)}(t,e,n,r,t.children,i));return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}const o=new Uc(t.segments,t.children);return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}function ld(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function ud(t){return t.outlet||Ec}function cd(t){return t.data||{}}function hd(t){return t.resolve||{}}function dd(t,e,n,r){const i=$h(t,e,r);return Fc(i.resolve?i.resolve(e,n):i(e,n))}function fd(t){return function(e){return e.pipe(Rl(e=>{const n=t(e);return n?W(n).pipe(j(()=>e)):W([e])}))}}class pd{}class md{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}const gd=new xt("ROUTES");class yd{constructor(t,e,n,r){this.loader=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=r}load(t,e){return this.onLoadStartListener&&this.onLoadStartListener(e),this.loadModuleFactory(e.loadChildren).pipe(j(n=>{this.onLoadEndListener&&this.onLoadEndListener(e);const r=n.create(t);return new Ac(Pc(r.injector.get(gd)).map(Rc),r)}))}loadModuleFactory(t){return"string"==typeof t?W(this.loader.load(t)):Fc(t()).pipe(G(t=>t instanceof Qt?Za(t):W(this.compiler.compileModuleAsync(t))))}}class vd{}class _d{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function bd(t){throw t}function wd(t,e,n){return e.parse("/")}function Ed(t,e){return Za(null)}class Sd{constructor(t,e,n,r,i,o,s,a){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=n,this.location=r,this.config=a,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new x,this.errorHandler=bd,this.malformedUriErrorHandler=wd,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Ed,afterPreactivation:Ed},this.urlHandlingStrategy=new _d,this.routeReuseStrategy=new md,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=i.get(zt),this.console=i.get(Hi);const l=i.get(uo);this.isNgZoneEnabled=l instanceof uo,this.resetConfig(a),this.currentUrlTree=new Bc(new Uc([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new yd(o,s,t=>this.triggerEvent(new pc(t)),t=>this.triggerEvent(new mc(t))),this.routerState=hh(this.currentUrlTree,this.rootComponentType),this.transitions=new Xa({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe(al(t=>0!==t.id),j(t=>Object.assign({},t,{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),Rl(t=>{let n=!1,r=!1;return Za(t).pipe(ml(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign({},this.lastSuccessfulNavigation,{previousNavigation:null}):null}}),Rl(t=>{const n=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||n)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return Za(t).pipe(Rl(t=>{const n=this.transitions.getValue();return e.next(new oc(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),n!==this.transitions.getValue()?Ka:[t]}),Rl(t=>Promise.resolve(t)),function(t,e,n,r){return function(i){return i.pipe(Rl(i=>(function(t,e,n,r,o){return new qh(t,e,n,i.extractedUrl,o).apply()})(t,e,n,0,r).pipe(j(t=>Object.assign({},i,{urlAfterRedirects:t})))))}}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),ml(t=>{this.currentNavigation=Object.assign({},this.currentNavigation,{finalUrl:t.urlAfterRedirects})}),function(t,e,n,r,i){return function(o){return o.pipe(G(o=>(function(t,e,n,r,i="emptyOnly",o="legacy"){return new id(t,e,n,r,i,o).recognize()})(t,e,o.urlAfterRedirects,n(o.urlAfterRedirects),r,i).pipe(j(t=>Object.assign({},o,{targetSnapshot:t})))))}}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),ml(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),ml(t=>{const n=new uc(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(n)}));if(n&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:r,source:i,restoredState:o,extras:s}=t,a=new oc(n,this.serializeUrl(r),i,o);e.next(a);const l=hh(r,this.rootComponentType).snapshot;return Za(Object.assign({},t,{targetSnapshot:l,urlAfterRedirects:r,extras:Object.assign({},s,{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),Ka}),fd(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:o,replaceUrl:s}}=t;return this.hooks.beforePreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!o,replaceUrl:!!s})}),ml(t=>{const e=new cc(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),j(t=>Object.assign({},t,{guards:Kh(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return function(n){return n.pipe(G(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=n;return 0===s.length&&0===o.length?Za(Object.assign({},n,{guardsResult:!0})):function(t,e,n,r){return W(s).pipe(G(t=>(function(t,e,n,r,i){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?Za(o.map(o=>{const s=$h(o,e,i);let a;if(function(t){return t&&Ph(t.canDeactivate)}(s))a=Fc(s.canDeactivate(t,e,n,r));else{if(!Ph(s))throw new Error("Invalid CanDeactivate guard");a=Fc(s(t,e,n,r))}return a.pipe(kl())})).pipe(Xh()):Za(!0)})(t.component,t.route,n,e,r)),kl(t=>!0!==t,!0))}(0,r,i,t).pipe(G(n=>n&&function(t){return"boolean"==typeof n}()?function(t,e,n,r){return W(o).pipe(Ul(e=>W([td(e.route.parent,r),Jh(e.route,r),nd(t,e.path,n),ed(t,e.route,n)]).pipe(sl(),kl(t=>!0!==t,!0))),kl(t=>!0!==t,!0))}(r,0,t,e):Za(n)),j(t=>Object.assign({},n,{guardsResult:t})))}))}}(this.ngModule.injector,t=>this.triggerEvent(t)),ml(t=>{if(Mh(t.guardsResult)){const e=Ic(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}}),ml(t=>{const e=new hc(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),al(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const n=new ac(t.id,this.serializeUrl(t.extractedUrl),"");return e.next(n),t.resolve(!1),!1}return!0}),fd(t=>{if(t.guards.canActivateChecks.length)return Za(t).pipe(ml(t=>{const e=new dc(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),function(t,e){return function(n){return n.pipe(G(n=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=n;return i.length?W(i).pipe(Ul(n=>(function(t,e,n,i){return function(t,e,n,r){const i=Object.keys(t);if(0===i.length)return Za({});if(1===i.length){const o=i[0];return dd(t[o],e,n,r).pipe(j(t=>({[o]:t})))}const o={};return W(i).pipe(G(i=>dd(t[i],e,n,r).pipe(j(t=>(o[i]=t,t))))).pipe(El(),j(()=>o))}(t._resolve,t,r,i).pipe(j(e=>(t._resolvedData=e,t.data=Object.assign({},t.data,fh(t,n).resolve),null)))})(n.route,0,t,e)),function(t,e){return arguments.length>=2?function(n){return _(Fl(t,e),dl(1),_l(e))(n)}:function(e){return _(Fl((e,n,r)=>t(e,n,r+1)),dl(1))(e)}}((t,e)=>t),j(t=>n)):Za(n)}))}}(this.paramsInheritanceStrategy,this.ngModule.injector),ml(t=>{const e=new fc(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}))}),fd(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:o,replaceUrl:s}}=t;return this.hooks.afterPreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!o,replaceUrl:!!s})}),j(t=>{const e=function(t,e,n){const r=function t(e,n,r){if(r&&e.shouldReuseRoute(n.value,r.value.snapshot)){const i=r.value;i._futureSnapshot=n.value;const o=function(e,n,r){return n.children.map(n=>{for(const i of r.children)if(e.shouldReuseRoute(i.value.snapshot,n.value))return t(e,n,i);return t(e,n)})}(e,n,r);return new lh(i,o)}{const r=e.retrieve(n.value);if(r){const t=r.route;return function t(e,n){if(e.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=e.value;for(let r=0;r<e.children.length;++r)t(e.children[r],n.children[r])}(n,t),t}{const r=new dh(new Xa((i=n.value).url),new Xa(i.params),new Xa(i.queryParams),new Xa(i.fragment),new Xa(i.data),i.outlet,i.component,i),o=n.children.map(n=>t(e,n));return new lh(r,o)}}var i}(t,e._root,n?n._root:void 0);return new ch(r,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign({},t,{targetRouterState:e})}),ml(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),Nh(this.rootContexts,this.routeReuseStrategy,t=>this.triggerEvent(t)),ml({next(){n=!0},complete(){n=!0}}),function(t){return e=>e.lift(new ql(t))}(()=>{if(!n&&!r){this.resetUrlToCurrentUrlTree();const n=new ac(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);e.next(n),t.resolve(!1)}this.currentNavigation=null}),Sl(n=>{if(r=!0,function(t){return n&&n[Tc]}()){const r=Mh(n.url);r||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const i=new ac(t.id,this.serializeUrl(t.extractedUrl),n.message);e.next(i),t.resolve(!1),r&&this.navigateByUrl(n.url)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const r=new lc(t.id,this.serializeUrl(t.extractedUrl),n);e.next(r);try{t.resolve(this.errorHandler(n))}catch(i){t.reject(i)}}return Ka}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign({},this.getTransition(),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{let e=this.parseUrl(t.url);const n="popstate"===t.type?"popstate":"hashchange",r=t.state&&t.state.navigationId?t.state:null;setTimeout(()=>{this.scheduleNavigation(e,n,r,{replaceUrl:!0})},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){kc(t),this.config=t.map(Rc),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}createUrlTree(t,e={}){const{relativeTo:n,queryParams:r,fragment:i,preserveQueryParams:o,queryParamsHandling:s,preserveFragment:a}=e;ie()&&o&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");const l=n||this.routerState.root,u=a?this.currentUrlTree.fragment:i;let c=null;if(s)switch(s){case"merge":c=Object.assign({},this.currentUrlTree.queryParams,r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}else c=o?this.currentUrlTree.queryParams:r||null;return null!==c&&(c=this.removeEmptyProps(c)),function(t,e,n,r,i){if(0===n.length)return wh(e.root,e.root,e,r,i);const o=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new Eh(!0,0,t);let e=0,n=!1;const r=t.reduce((t,r,i)=>{if("object"==typeof r&&null!=r){if(r.outlets){const e={};return Lc(r.outlets,(t,n)=>{e[n]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(r.segmentPath)return[...t,r.segmentPath]}return"string"!=typeof r?[...t,r]:0===i?(r.split("/").forEach((r,i)=>{0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?e++:""!=r&&t.push(r))}),t):[...t,r]},[]);return new Eh(n,e,r)}(n);if(o.toRoot())return wh(e.root,new Uc([],{}),e,r,i);const s=function(t,n,r){if(t.isAbsolute)return new Sh(e.root,!0,0);if(-1===r.snapshot._lastPathIndex)return new Sh(r.snapshot._urlSegment,!0,0);const i=bh(t.commands[0])?0:1;return function(e,n,o){let s=r.snapshot._urlSegment,a=r.snapshot._lastPathIndex+i,l=t.numberOfDoubleDots;for(;l>a;){if(l-=a,!(s=s.parent))throw new Error("Invalid number of '../'");a=s.segments.length}return new Sh(s,!1,a-l)}()}(o,0,t),a=s.processChildren?Ih(s.segmentGroup,s.index,o.commands):Th(s.segmentGroup,s.index,o.commands);return wh(s.segmentGroup,a,e,r,i)}(l,this.currentUrlTree,t,c,u)}navigateByUrl(t,e={skipLocationChange:!1}){ie()&&this.isNgZoneEnabled&&!uo.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");const n=Mh(t)?t:this.parseUrl(t),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(n){e=this.malformedUriErrorHandler(n,this.urlSerializer,t)}return e}isActive(t,e){if(Mh(t))return Vc(this.currentUrlTree,t,e);const n=this.parseUrl(t);return Vc(this.currentUrlTree,n,e)}removeEmptyProps(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return null!=r&&(e[n]=r),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new sc(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,n,r){const i=this.getTransition();if(i&&"imperative"!==e&&"imperative"===i.source&&i.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(i&&"hashchange"==e&&"popstate"===i.source&&i.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(i&&"popstate"==e&&"hashchange"===i.source&&i.rawUrl.toString()===t.toString())return Promise.resolve(!0);let o=null,s=null;const a=new Promise((t,e)=>{o=t,s=e}),l=++this.navigationId;return this.setTransition({id:l,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:r,resolve:o,reject:s,promise:a,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),a.catch(t=>Promise.reject(t))}setBrowserUrl(t,e,n,r){const i=this.urlSerializer.serialize(t);r=r||{},this.location.isCurrentPathEqualTo(i)||e?this.location.replaceState(i,"",Object.assign({},r,{navigationId:n})):this.location.go(i,"",Object.assign({},r,{navigationId:n}))}resetStateAndUrl(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}class Cd{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Td,this.attachRef=null}}class Td{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new Cd,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class Id{constructor(t,e,n,r,i){this.parentContexts=t,this.location=e,this.resolver=n,this.changeDetector=i,this.activated=null,this._activatedRoute=null,this.activateEvents=new Pi,this.deactivateEvents=new Pi,this.name=r||Ec,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new xd(t,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}class xd{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===dh?this.route:t===Td?this.childContexts:this.parent.get(t,e)}}class Ad{}class kd{preload(t,e){return e().pipe(Sl(()=>Za(null)))}}class Dd{preload(t,e){return Za(null)}}class Nd{constructor(t,e,n,r,i){this.router=t,this.injector=r,this.preloadingStrategy=i,this.loader=new yd(e,n,e=>t.triggerEvent(new pc(e)),e=>t.triggerEvent(new mc(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(al(t=>t instanceof sc),Ul(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(zt);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription.unsubscribe()}processRoutes(t,e){const n=[];for(const r of e)if(r.loadChildren&&!r.canLoad&&r._loadedConfig){const t=r._loadedConfig;n.push(this.processRoutes(t.module,t.routes))}else r.loadChildren&&!r.canLoad?n.push(this.preloadConfig(t,r)):r.children&&n.push(this.processRoutes(t,r.children));return W(n).pipe(Z(),j(t=>void 0))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>this.loader.load(t.injector,e).pipe(G(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}class Rd{constructor(t,e,n={}){this.router=t,this.viewportScroller=e,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof oc?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof sc&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof bc&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new bc(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}const Od=new xt("ROUTER_CONFIGURATION"),Pd=new xt("ROUTER_FORROOT_GUARD"),Md=[Ia,{provide:Qc,useClass:Hc},{provide:Sd,useFactory:jd,deps:[Do,Qc,Td,Ia,Le,Ro,Ji,gd,Od,[vd,new ct],[pd,new ct]]},Td,{provide:dh,useFactory:zd,deps:[Sd]},{provide:Ro,useClass:Fo},Nd,Dd,kd,{provide:Od,useValue:{enableTracing:!1}}];function Ld(){return new To("Router",Sd)}class Fd{constructor(t,e){}static forRoot(t,e){return{ngModule:Fd,providers:[Md,qd(t),{provide:Pd,useFactory:Ud,deps:[[Sd,new ct,new dt]]},{provide:Od,useValue:e||{}},{provide:Ca,useFactory:Bd,deps:[Ea,[new ut(Ta),new ct],Od]},{provide:Rd,useFactory:Vd,deps:[Sd,Wa,Od]},{provide:Ad,useExisting:e&&e.preloadingStrategy?e.preloadingStrategy:Dd},{provide:To,multi:!0,useFactory:Ld},[Qd,{provide:Fi,multi:!0,useFactory:Hd,deps:[Qd]},{provide:Gd,useFactory:Wd,deps:[Qd]},{provide:Qi,multi:!0,useExisting:Gd}]]}}static forChild(t){return{ngModule:Fd,providers:[qd(t)]}}}function Vd(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new Rd(t,e,n)}function Bd(t,e,n={}){return n.useHash?new Aa(t,e):new ka(t,e)}function Ud(t){if(t)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function qd(t){return[{provide:He,multi:!0,useValue:t},{provide:gd,multi:!0,useValue:t}]}function jd(t,e,n,r,i,o,s,a,l={},u,c){const h=new Sd(null,e,n,r,i,o,s,Pc(a));if(u&&(h.urlHandlingStrategy=u),c&&(h.routeReuseStrategy=c),l.errorHandler&&(h.errorHandler=l.errorHandler),l.malformedUriErrorHandler&&(h.malformedUriErrorHandler=l.malformedUriErrorHandler),l.enableTracing){const t=Ql();h.events.subscribe(e=>{t.logGroup(`Router Event: ${e.constructor.name}`),t.log(e.toString()),t.log(e),t.logGroupEnd()})}return l.onSameUrlNavigation&&(h.onSameUrlNavigation=l.onSameUrlNavigation),l.paramsInheritanceStrategy&&(h.paramsInheritanceStrategy=l.paramsInheritanceStrategy),l.urlUpdateStrategy&&(h.urlUpdateStrategy=l.urlUpdateStrategy),l.relativeLinkResolution&&(h.relativeLinkResolution=l.relativeLinkResolution),h}function zd(t){return t.routerState.root}class Qd{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new x}appInitializer(){return this.injector.get(Sa,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),n=this.injector.get(Sd),r=this.injector.get(Od);if(this.isLegacyDisabled(r)||this.isLegacyEnabled(r))t(!0);else if("disabled"===r.initialNavigation)n.setUpLocationChangeListener(),t(!0);else{if("enabled"!==r.initialNavigation)throw new Error(`Invalid initialNavigation options: '${r.initialNavigation}'`);n.hooks.afterPreactivation=()=>this.initNavigation?Za(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),n.initialNavigation()}return e})}bootstrapListener(t){const e=this.injector.get(Od),n=this.injector.get(Nd),r=this.injector.get(Rd),i=this.injector.get(Sd),o=this.injector.get(Do);t===o.components[0]&&(this.isLegacyEnabled(e)?i.initialNavigation():this.isLegacyDisabled(e)&&i.setUpLocationChangeListener(),n.setUpPreloading(),r.init(),i.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}isLegacyEnabled(t){return"legacy_enabled"===t.initialNavigation||!0===t.initialNavigation||void 0===t.initialNavigation}isLegacyDisabled(t){return"legacy_disabled"===t.initialNavigation||!1===t.initialNavigation}}function Hd(t){return t.appInitializer.bind(t)}function Wd(t){return t.bootstrapListener.bind(t)}const Gd=new xt("Router Initializer");var Kd=nr({encapsulation:2,styles:[],data:{}});function $d(t){return fs(0,[(t()(),Xo(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),ci(1,212992,null,0,Id,[Td,Vn,ln,[8,null],Re],null,null)],function(t,e){t(e,1,0)},null)}function Yd(t){return fs(0,[(t()(),Xo(0,0,null,null,1,"ng-component",[],null,null,null,$d,Kd)),ci(1,49152,null,0,wc,[],null,null)],null,null)}var Zd=Ur("ng-component",wc,Yd,{},{},[]);class Xd{}class Jd{}const tf="*";function ef(t,e=null){return{type:2,steps:t,options:e}}function nf(t){return{type:6,styles:t,offset:null}}function rf(t){Promise.resolve(null).then(t)}class of{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){rf(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){}setPosition(t){}getPosition(){return 0}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class sf{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,r=0;const i=this.players.length;0==i?rf(()=>this._onFinish()):this.players.forEach(t=>{t.onDone(()=>{++e==i&&this._onFinish()}),t.onDestroy(()=>{++n==i&&this._onDestroy()}),t.onStart(()=>{++r==i&&this._onStart()})}),this.totalTime=this.players.reduce((t,e)=>Math.max(t,e.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(t=>{const n=t.totalTime?Math.min(1,e/t.totalTime):1;t.setPosition(n)})}getPosition(){let t=0;return this.players.forEach(e=>{const n=e.getPosition();t=Math.min(n,t)}),t}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}const af="!";function lf(t){return null!=t&&"false"!==`${t}`}function uf(t){return Array.isArray(t)?t:[t]}function cf(t){return null==t?"":"string"==typeof t?t:`${t}px`}function hf(t){return t instanceof dn?t.nativeElement:t}const df=new _n("8.1.4");let ff;try{ff="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(Ew){ff=!1}let pf,mf=(()=>{class t{constructor(t){this._platformId=t,this.isBrowser=this._platformId?this._platformId===za:"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!ff)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(zi,8))},token:t,providedIn:"root"}),t})();class gf{}const yf=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function vf(){if(pf)return pf;if("object"!=typeof document||!document)return pf=new Set(yf);let t=document.createElement("input");return pf=new Set(yf.filter(e=>(t.setAttribute("type",e),t.type===e)))}let _f;function bf(t){return function(){if(null==_f&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>_f=!0}))}finally{_f=_f||!1}return _f}()?t:!!t.capture}class wf extends d{constructor(t,e){super()}schedule(t,e=0){return this}}class Ef extends wf{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n=!1,r=void 0;try{this.work(t)}catch(i){n=!0,r=!!i&&i||new Error(i)}if(n)return this.unsubscribe(),r}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}let Sf=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class Cf extends Sf{constructor(t,e=Sf.now){super(t,()=>Cf.delegate&&Cf.delegate!==this?Cf.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return Cf.delegate&&Cf.delegate!==this?Cf.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}const Tf=new Cf(Ef);function If(t,e=Tf){return n=>n.lift(new xf(t,e))}class xf{constructor(t,e){this.dueTime=t,this.scheduler=e}call(t,e){return e.subscribe(new Af(t,this.dueTime,this.scheduler))}}class Af extends m{constructor(t,e,n){super(t),this.dueTime=e,this.scheduler=n,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(kf,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:t}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}clearDebounce(){const t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}function kf(t){t.debouncedNext()}const Df=new xt("liveAnnouncerElement",{providedIn:"root",factory:function(){return null}}),Nf=new xt("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let Rf=(()=>{class t{constructor(t,e,n,r){this._ngZone=e,this._defaultOptions=r,this._document=n,this._liveElement=t||this._createLiveElement()}announce(t,...e){const n=this._defaultOptions;let r,i;return 1===e.length&&"number"==typeof e[0]?i=e[0]:[r,i]=e,this.clear(),clearTimeout(this._previousTimeout),r||(r=n&&n.politeness?n.politeness:"polite"),null==i&&n&&(i=n.duration),this._liveElement.setAttribute("aria-live",r),this._ngZone.runOutsideAngular(()=>new Promise(e=>{clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=t,e(),"number"==typeof i&&(this._previousTimeout=setTimeout(()=>this.clear(),i))},100)}))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement&&this._liveElement.parentNode&&(this._liveElement.parentNode.removeChild(this._liveElement),this._liveElement=null)}_createLiveElement(){const t=this._document.getElementsByClassName("cdk-live-announcer-element"),e=this._document.createElement("div");for(let n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n]);return e.classList.add("cdk-live-announcer-element"),e.classList.add("cdk-visually-hidden"),e.setAttribute("aria-atomic","true"),e.setAttribute("aria-live","polite"),this._document.body.appendChild(e),e}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(Df,8),Bt(uo),Bt(ja),Bt(Nf,8))},token:t,providedIn:"root"}),t})();const Of=650,Pf=bf({passive:!0,capture:!0});let Mf=(()=>{class t{constructor(t,e){this._ngZone=t,this._platform=e,this._origin=null,this._windowFocused=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._documentKeydownListener=()=>{this._lastTouchTarget=null,this._setOriginForCurrentEventQueue("keyboard")},this._documentMousedownListener=()=>{this._lastTouchTarget||this._setOriginForCurrentEventQueue("mouse")},this._documentTouchstartListener=t=>{null!=this._touchTimeoutId&&clearTimeout(this._touchTimeoutId),this._lastTouchTarget=t.target,this._touchTimeoutId=setTimeout(()=>this._lastTouchTarget=null,Of)},this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)}}monitor(t,e=!1){if(!this._platform.isBrowser)return Za(null);const n=hf(t);if(this._elementInfo.has(n)){let t=this._elementInfo.get(n);return t.checkChildren=e,t.subject.asObservable()}let r={unlisten:()=>{},checkChildren:e,subject:new x};this._elementInfo.set(n,r),this._incrementMonitoredElementCount();let i=t=>this._onFocus(t,n),o=t=>this._onBlur(t,n);return this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",i,!0),n.addEventListener("blur",o,!0)}),r.unlisten=()=>{n.removeEventListener("focus",i,!0),n.removeEventListener("blur",o,!0)},r.subject.asObservable()}stopMonitoring(t){const e=hf(t),n=this._elementInfo.get(e);n&&(n.unlisten(),n.subject.complete(),this._setClasses(e),this._elementInfo.delete(e),this._decrementMonitoredElementCount())}focusVia(t,e,n){const r=hf(t);this._setOriginForCurrentEventQueue(e),"function"==typeof r.focus&&r.focus(n)}ngOnDestroy(){this._elementInfo.forEach((t,e)=>this.stopMonitoring(e))}_toggleClass(t,e,n){n?t.classList.add(e):t.classList.remove(e)}_setClasses(t,e){this._elementInfo.get(t)&&(this._toggleClass(t,"cdk-focused",!!e),this._toggleClass(t,"cdk-touch-focused","touch"===e),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===e),this._toggleClass(t,"cdk-mouse-focused","mouse"===e),this._toggleClass(t,"cdk-program-focused","program"===e))}_setOriginForCurrentEventQueue(t){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originTimeoutId=setTimeout(()=>this._origin=null,1)})}_wasCausedByTouch(t){let e=t.target;return this._lastTouchTarget instanceof Node&&e instanceof Node&&(e===this._lastTouchTarget||e.contains(this._lastTouchTarget))}_onFocus(t,e){const n=this._elementInfo.get(e);if(!n||!n.checkChildren&&e!==t.target)return;let r=this._origin;r||(r=this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:this._wasCausedByTouch(t)?"touch":"program"),this._setClasses(e,r),this._emitOrigin(n.subject,r),this._lastFocusOrigin=r}_onBlur(t,e){const n=this._elementInfo.get(e);!n||n.checkChildren&&t.relatedTarget instanceof Node&&e.contains(t.relatedTarget)||(this._setClasses(e),this._emitOrigin(n.subject,null))}_emitOrigin(t,e){this._ngZone.run(()=>t.next(e))}_incrementMonitoredElementCount(){1==++this._monitoredElementCount&&this._platform.isBrowser&&this._ngZone.runOutsideAngular(()=>{document.addEventListener("keydown",this._documentKeydownListener,Pf),document.addEventListener("mousedown",this._documentMousedownListener,Pf),document.addEventListener("touchstart",this._documentTouchstartListener,Pf),window.addEventListener("focus",this._windowFocusListener)})}_decrementMonitoredElementCount(){--this._monitoredElementCount||(document.removeEventListener("keydown",this._documentKeydownListener,Pf),document.removeEventListener("mousedown",this._documentMousedownListener,Pf),document.removeEventListener("touchstart",this._documentTouchstartListener,Pf),window.removeEventListener("focus",this._windowFocusListener),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._touchTimeoutId),clearTimeout(this._originTimeoutId))}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(uo),Bt(mf))},token:t,providedIn:"root"}),t})();const Lf=new _n("8.1.4"),Ff=new xt("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});class Vf{constructor(t,e){this._sanityChecksEnabled=t,this._hammerLoader=e,this._hasDoneGlobalChecks=!1,this._hasCheckedHammer=!1,this._document="object"==typeof document&&document?document:null,this._window="object"==typeof window&&window?window:null,this._areChecksEnabled()&&!this._hasDoneGlobalChecks&&(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_areChecksEnabled(){return this._sanityChecksEnabled&&ie()&&!this._isTestEnv()}_isTestEnv(){const t=this._window;return t&&(t.__karma__||t.jasmine)}_checkDoctypeIsDefined(){this._document&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._document||!this._document.body||"function"!=typeof getComputedStyle)return;const t=this._document.createElement("div");t.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(t);const e=getComputedStyle(t);e&&"none"!==e.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),this._document.body.removeChild(t)}_checkCdkVersionMatch(){Lf.full!==df.full&&console.warn("The Angular Material version ("+Lf.full+") does not match the Angular CDK version ("+df.full+").\nPlease ensure the versions of these two packages exactly match.")}_checkHammerIsAvailable(){!this._hasCheckedHammer&&this._window&&(!this._areChecksEnabled()||this._window.Hammer||this._hammerLoader||console.warn("Could not find HammerJS. Certain Angular Material components may not work correctly."),this._hasCheckedHammer=!0)}}function Bf(t){return class extends t{constructor(...t){super(...t),this._disabled=!1}get disabled(){return this._disabled}set disabled(t){this._disabled=lf(t)}}}function Uf(t,e){return class extends t{get color(){return this._color}set color(t){const n=t||e;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}constructor(...t){super(...t),this.color=e}}}function qf(t){return class extends t{constructor(...t){super(...t),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=lf(t)}}}function jf(t){return class extends t{constructor(...t){super(...t),this.errorState=!1,this.stateChanges=new x}updateErrorState(){const t=this.errorState,e=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);e!==t&&(this.errorState=e,this.stateChanges.next())}}}let zf;try{zf="undefined"!=typeof Intl}catch(Ew){zf=!1}let Qf=(()=>{class t{isErrorState(t,e){return!!(t&&t.invalid&&(t.touched||e&&e.submitted))}}return t.ngInjectableDef=mt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const Hf=function(){var t={FADING_IN:0,VISIBLE:1,FADING_OUT:2,HIDDEN:3};return t[t.FADING_IN]="FADING_IN",t[t.VISIBLE]="VISIBLE",t[t.FADING_OUT]="FADING_OUT",t[t.HIDDEN]="HIDDEN",t}();class Wf{constructor(t,e,n){this._renderer=t,this.element=e,this.config=n,this.state=Hf.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}}const Gf={enterDuration:450,exitDuration:400},Kf=800,$f=bf({passive:!0});class Yf{constructor(t,e,n,r){this._target=t,this._ngZone=e,this._isPointerDown=!1,this._triggerEvents=new Map,this._activeRipples=new Set,this._onMousedown=t=>{const e=function(t){return 0===t.buttons}(t),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+Kf;this._target.rippleDisabled||e||n||(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))},this._onTouchStart=t=>{if(!this._target.rippleDisabled){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let t=0;t<e.length;t++)this.fadeInRipple(e[t].clientX,e[t].clientY,this._target.rippleConfig)}},this._onPointerUp=()=>{this._isPointerDown&&(this._isPointerDown=!1,this._activeRipples.forEach(t=>{!t.config.persistent&&(t.state===Hf.VISIBLE||t.config.terminateOnPointerUp&&t.state===Hf.FADING_IN)&&t.fadeOut()}))},r.isBrowser&&(this._containerElement=n.nativeElement,this._triggerEvents.set("mousedown",this._onMousedown).set("mouseup",this._onPointerUp).set("mouseleave",this._onPointerUp).set("touchstart",this._onTouchStart).set("touchend",this._onPointerUp).set("touchcancel",this._onPointerUp))}fadeInRipple(t,e,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),i=Object.assign({},Gf,n.animation);n.centered&&(t=r.left+r.width/2,e=r.top+r.height/2);const o=n.radius||function(t,e,n){const r=Math.max(Math.abs(t-n.left),Math.abs(t-n.right)),i=Math.max(Math.abs(e-n.top),Math.abs(e-n.bottom));return Math.sqrt(r*r+i*i)}(t,e,r),s=t-r.left,a=e-r.top,l=i.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=`${s-o}px`,u.style.top=`${a-o}px`,u.style.height=`${2*o}px`,u.style.width=`${2*o}px`,u.style.backgroundColor=n.color||null,u.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(u),window.getComputedStyle(u).getPropertyValue("opacity"),u.style.transform="scale(1)";const c=new Wf(this,u,n);return c.state=Hf.FADING_IN,this._activeRipples.add(c),n.persistent||(this._mostRecentTransientRipple=c),this._runTimeoutOutsideZone(()=>{const t=c===this._mostRecentTransientRipple;c.state=Hf.VISIBLE,n.persistent||t&&this._isPointerDown||c.fadeOut()},l),c}fadeOutRipple(t){const e=this._activeRipples.delete(t);if(t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!e)return;const n=t.element,r=Object.assign({},Gf,t.config.animation);n.style.transitionDuration=`${r.exitDuration}ms`,n.style.opacity="0",t.state=Hf.FADING_OUT,this._runTimeoutOutsideZone(()=>{t.state=Hf.HIDDEN,n.parentNode.removeChild(n)},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(t=>t.fadeOut())}setupTriggerEvents(t){t&&t!==this._triggerElement&&(this._removeTriggerEvents(),this._ngZone.runOutsideAngular(()=>{this._triggerEvents.forEach((e,n)=>{t.addEventListener(n,e,$f)})}),this._triggerElement=t)}_runTimeoutOutsideZone(t,e=0){this._ngZone.runOutsideAngular(()=>setTimeout(t,e))}_removeTriggerEvents(){this._triggerElement&&this._triggerEvents.forEach((t,e)=>{this._triggerElement.removeEventListener(e,t,$f)})}}const Zf=new xt("mat-ripple-global-options");class Xf{constructor(t,e,n,r,i){this._elementRef=t,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=r||{},this._rippleRenderer=new Yf(this,e,t,n),"NoopAnimations"===i&&(this._globalOptions.animation={enterDuration:0,exitDuration:0})}get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign({},this._globalOptions.animation,this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,e=0,n){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,e,Object.assign({},this.rippleConfig,n)):this._rippleRenderer.fadeInRipple(0,0,Object.assign({},this.rippleConfig,t))}}class Jf{}const tp=new xt("mat-label-global-options");function ep(t,e,n,i){return r(n)&&(i=n,n=void 0),i?ep(t,e,n).pipe(j(t=>l(t)?i(...t):i(t))):new w(r=>{!function t(e,n,r,i,o){let s;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(e)){const t=e;e.addEventListener(n,r,o),s=()=>t.removeEventListener(n,r,o)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(e)){const t=e;e.on(n,r),s=()=>t.off(n,r)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(e)){const t=e;e.addListener(n,r),s=()=>t.removeListener(n,r)}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(let s=0,a=e.length;s<a;s++)t(e[s],n,r,i,o)}i.add(s)}(t,e,function(t){r.next(arguments.length>1?Array.prototype.slice.call(arguments):t)},r,n)})}function np(t){return e=>e.lift(new rp(t))}class rp{constructor(t){this.notifier=t}call(t,e){const n=new ip(t),r=U(n,this.notifier);return r&&!n.seenValue?(n.add(r),e.subscribe(n)):n}}class ip extends q{constructor(t){super(t),this.seenValue=!1}notifyNext(t,e,n,r,i){this.seenValue=!0,this.complete()}notifyComplete(){}}let op=0;class sp{constructor(){this.id=`mat-error-${op++}`}}class ap{}function lp(t){return Error(`A hint was already declared for 'align="${t}"'.`)}let up=0;const cp=.75,hp=5;class dp{constructor(t){this._elementRef=t}}const fp=Uf(dp,"primary"),pp=new xt("MAT_FORM_FIELD_DEFAULT_OPTIONS");class mp extends fp{constructor(t,e,n,r,i,o,s,a){super(t),this._elementRef=t,this._changeDetectorRef=e,this._dir=r,this._defaults=i,this._platform=o,this._ngZone=s,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new x,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId=`mat-hint-${up++}`,this._labelId=`mat-form-field-label-${up++}`,this._labelOptions=n||{},this.floatLabel=this._labelOptions.float||"auto",this._animationsEnabled="NoopAnimations"!==a,this.appearance=i&&i.appearance?i.appearance:"legacy"}get appearance(){return this._appearance}set appearance(t){const e=this._appearance;this._appearance=t||this._defaults&&this._defaults.appearance||"legacy","outline"===this._appearance&&e!==t&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(t){this._hideRequiredMarker=lf(t)}get _shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}get _canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(t){this._hintLabel=t,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(t){t!==this._floatLabel&&(this._floatLabel=t||this._labelOptions.float||"auto",this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(t){this._explicitFormFieldControl=t}get _labelChild(){return this._labelChildNonStatic||this._labelChildStatic}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const t=this._control;t.controlType&&this._elementRef.nativeElement.classList.add(`mat-form-field-type-${t.controlType}`),t.stateChanges.pipe(Ll(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),t.ngControl&&t.ngControl.valueChanges&&t.ngControl.valueChanges.pipe(np(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.asObservable().pipe(np(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),X(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe(Ll(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe(Ll(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe(np(this._destroyed)).subscribe(()=>this.updateOutlineGap())}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(t){const e=this._control?this._control.ngControl:null;return e&&e[t]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!!this._labelChild}_shouldLabelFloat(){return this._canLabelFloat&&(this._control.shouldLabelFloat||this._shouldAlwaysFloat)}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat&&(this._animationsEnabled&&(this._showAlwaysAnimate=!0,ep(this._label.nativeElement,"transitionend").pipe(Il(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){if(this._control.placeholder&&this._placeholderChild)throw Error("Placeholder attribute and child element were both specified.")}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){if(this._hintChildren){let t,e;this._hintChildren.forEach(n=>{if("start"===n.align){if(t||this.hintLabel)throw lp("start");t=n}else if("end"===n.align){if(e)throw lp("end");e=n}})}}_syncDescribedByIds(){if(this._control){let t=[];if("hint"===this._getDisplayedMessages()){const e=this._hintChildren?this._hintChildren.find(t=>"start"===t.align):null,n=this._hintChildren?this._hintChildren.find(t=>"end"===t.align):null;e?t.push(e.id):this._hintLabel&&t.push(this._hintLabelId),n&&t.push(n.id)}else this._errorChildren&&(t=this._errorChildren.map(t=>t.id));this._control.setDescribedByIds(t)}}_validateControlChild(){if(!this._control)throw Error("mat-form-field must contain a MatFormFieldControl.")}updateOutlineGap(){const t=this._label?this._label.nativeElement:null;if("outline"!==this.appearance||!t||!t.children.length||!t.textContent.trim())return;if(!this._platform.isBrowser)return;if(!document.documentElement.contains(this._elementRef.nativeElement))return void(this._outlineGapCalculationNeededImmediately=!0);let e=0,n=0;const r=this._connectionContainerRef.nativeElement,i=r.querySelectorAll(".mat-form-field-outline-start"),o=r.querySelectorAll(".mat-form-field-outline-gap");if(this._label&&this._label.nativeElement.children.length){const i=r.getBoundingClientRect();if(0===i.width&&0===i.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const o=this._getStartEnd(i),s=this._getStartEnd(t.children[0].getBoundingClientRect());let a=0;for(const e of t.children)a+=e.offsetWidth;e=s-o-hp,n=a>0?a*cp+2*hp:0}for(let s=0;s<i.length;s++)i.item(s).style.width=`${e}px`;for(let s=0;s<o.length;s++)o.item(s).style.width=`${n}px`;this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(t){return this._dir&&"rtl"===this._dir.value?t.right:t.left}}class gp{}class yp extends q{constructor(t,e){super(t),this.sources=e,this.completed=0,this.haveValues=0;const n=e.length;this.values=new Array(n);for(let r=0;r<n;r++){const t=U(this,e[r],null,r);t&&this.add(t)}}notifyNext(t,e,n,r,i){this.values[n]=e,i._hasValue||(i._hasValue=!0,this.haveValues++)}notifyComplete(t){const{destination:e,haveValues:n,values:r}=this,i=r.length;t._hasValue?(this.completed++,this.completed===i&&(n===i&&e.next(r),e.complete())):e.complete()}}const vp=new xt("NgValueAccessor"),_p=new xt("CompositionEventMode");class bp{constructor(t,e,n){this._renderer=t,this._elementRef=e,this._compositionMode=n,this.onChange=t=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=Ql()?Ql().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}class wp{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class Ep extends wp{get formDirective(){return null}get path(){return null}}function Sp(){throw new Error("unimplemented")}class Cp extends wp{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null,this._rawValidators=[],this._rawAsyncValidators=[]}get validator(){return Sp()}get asyncValidator(){return Sp()}}class Tp{constructor(t){this._cd=t}get ngClassUntouched(){return!!this._cd.control&&this._cd.control.untouched}get ngClassTouched(){return!!this._cd.control&&this._cd.control.touched}get ngClassPristine(){return!!this._cd.control&&this._cd.control.pristine}get ngClassDirty(){return!!this._cd.control&&this._cd.control.dirty}get ngClassValid(){return!!this._cd.control&&this._cd.control.valid}get ngClassInvalid(){return!!this._cd.control&&this._cd.control.invalid}get ngClassPending(){return!!this._cd.control&&this._cd.control.pending}}class Ip extends Tp{constructor(t){super(t)}}class xp extends Tp{constructor(t){super(t)}}function Ap(t){return null==t||0===t.length}const kp=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/;class Dp{static min(t){return e=>{if(Ap(e.value)||Ap(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}static max(t){return e=>{if(Ap(e.value)||Ap(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}static required(t){return Ap(t.value)?{required:!0}:null}static requiredTrue(t){return!0===t.value?null:{required:!0}}static email(t){return Ap(t.value)?null:kp.test(t.value)?null:{email:!0}}static minLength(t){return e=>{if(Ap(e.value))return null;const n=e.value?e.value.length:0;return n<t?{minlength:{requiredLength:t,actualLength:n}}:null}}static maxLength(t){return e=>{const n=e.value?e.value.length:0;return n>t?{maxlength:{requiredLength:t,actualLength:n}}:null}}static pattern(t){if(!t)return Dp.nullValidator;let e,n;return"string"==typeof t?(n="","^"!==t.charAt(0)&&(n+="^"),n+=t,"$"!==t.charAt(t.length-1)&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),t=>{if(Ap(t.value))return null;const r=t.value;return e.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}static nullValidator(t){return null}static compose(t){if(!t)return null;const e=t.filter(Np);return 0==e.length?null:function(t){return Op(function(t,n){return e.map(e=>e(t))}(t))}}static composeAsync(t){if(!t)return null;const e=t.filter(Np);return 0==e.length?null:function(t){return function t(...e){let n;return"function"==typeof e[e.length-1]&&(n=e.pop()),1===e.length&&l(e[0])&&(e=e[0]),0===e.length?Ka:n?t(e).pipe(j(t=>n(...t))):new w(t=>new yp(t,e))}(function(t,n){return e.map(e=>e(t))}(t).map(Rp)).pipe(j(Op))}}}function Np(t){return null!=t}function Rp(t){const e=Je(t)?W(t):t;if(!tn(e))throw new Error("Expected validator to return Promise or Observable.");return e}function Op(t){const e=t.reduce((t,e)=>null!=e?Object.assign({},t,e):t,{});return 0===Object.keys(e).length?null:e}function Pp(t){return t.validate?e=>t.validate(e):t}function Mp(t){return t.validate?e=>t.validate(e):t}class Lp{constructor(){this._accessors=[]}add(t,e){this._accessors.push([t,e])}remove(t){for(let e=this._accessors.length-1;e>=0;--e)if(this._accessors[e][1]===t)return void this._accessors.splice(e,1)}select(t){this._accessors.forEach(e=>{this._isSameGroup(e,t)&&e[1]!==t&&e[1].fireUncheck(t.value)})}_isSameGroup(t,e){return!!t[0].control&&t[0]._parent===e._control._parent&&t[1].name===e.name}}const Fp={formControlName:'\n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });',formGroupName:'\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',formArrayName:'\n    <div [formGroup]="myGroup">\n      <div formArrayName="cities">\n        <div *ngFor="let city of cityArray.controls; index as i">\n          <input [formControlName]="i">\n        </div>\n      </div>\n    </div>\n\n    In your class:\n\n    this.cityArray = new FormArray([new FormControl(\'SF\')]);\n    this.myGroup = new FormGroup({\n      cities: this.cityArray\n    });',ngModelGroup:'\n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>',ngModelWithFormGroup:'\n    <div [formGroup]="myGroup">\n       <input formControlName="firstName">\n       <input [(ngModel)]="showMoreControls" [ngModelOptions]="{standalone: true}">\n    </div>\n  '};class Vp{static controlParentException(){throw new Error(`formControlName must be used with a parent formGroup directive.  You'll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ${Fp.formControlName}`)}static ngModelGroupException(){throw new Error(`formControlName cannot be used with an ngModelGroup parent. It is only compatible with parents\n       that also have a "form" prefix: formGroupName, formArrayName, or formGroup.\n\n       Option 1:  Update the parent to be formGroupName (reactive form strategy)\n\n        ${Fp.formGroupName}\n\n        Option 2: Use ngModel instead of formControlName (template-driven strategy)\n\n        ${Fp.ngModelGroup}`)}static missingFormException(){throw new Error(`formGroup expects a FormGroup instance. Please pass one in.\n\n       Example:\n\n       ${Fp.formControlName}`)}static groupParentException(){throw new Error(`formGroupName must be used with a parent formGroup directive.  You'll want to add a formGroup\n      directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ${Fp.formGroupName}`)}static arrayParentException(){throw new Error(`formArrayName must be used with a parent formGroup directive.  You'll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n        Example:\n\n        ${Fp.formArrayName}`)}static disabledAttrWarning(){console.warn("\n      It looks like you're using the disabled attribute with a reactive form directive. If you set disabled to true\n      when you set up this control in your component class, the disabled attribute will actually be set in the DOM for\n      you. We recommend using this approach to avoid 'changed after checked' errors.\n       \n      Example: \n      form = new FormGroup({\n        first: new FormControl({value: 'Nancy', disabled: true}, Validators.required),\n        last: new FormControl('Drew', Validators.required)\n      });\n    ")}static ngModelWarning(t){console.warn(`\n    It looks like you're using ngModel on the same form field as ${t}. \n    Support for using the ngModel input property and ngModelChange event with \n    reactive form directives has been deprecated in Angular v6 and will be removed \n    in Angular v7.\n    \n    For more information on this, see our API docs here:\n    https://angular.io/api/forms/${"formControl"===t?"FormControlDirective":"FormControlName"}#use-with-ngmodel\n    `)}}function Bp(t,e){return[...e.path,t]}function Up(t,e){t||Qp(e,"Cannot find control with"),e.valueAccessor||Qp(e,"No value accessor for form control with"),t.validator=Dp.compose([t.validator,e.validator]),t.asyncValidator=Dp.composeAsync([t.asyncValidator,e.asyncValidator]),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&qp(t,e)})}(t,e),function(t,e){t.registerOnChange((t,n)=>{e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&qp(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),e.valueAccessor.setDisabledState&&t.registerOnDisabledChange(t=>{e.valueAccessor.setDisabledState(t)}),e._rawValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())}),e._rawAsyncValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())})}function qp(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function jp(t,e){null==t&&Qp(e,"Cannot find control with"),t.validator=Dp.compose([t.validator,e.validator]),t.asyncValidator=Dp.composeAsync([t.asyncValidator,e.asyncValidator])}function zp(t){return Qp(t,"There is no FormControl instance attached to form control element with")}function Qp(t,e){let n;throw n=t.path.length>1?`path: '${t.path.join(" -> ")}'`:t.path[0]?`name: '${t.path}'`:"unspecified name attribute",new Error(`${e} ${n}`)}function Hp(t){return null!=t?Dp.compose(t.map(Pp)):null}function Wp(t){return null!=t?Dp.composeAsync(t.map(Mp)):null}const Gp=[class{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"checked",t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}},class{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(t))}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}},class{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}},class{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Ke}set compareWith(t){if("function"!=typeof t)throw new Error(`compareWith must be a function, but received ${JSON.stringify(t)}`);this._compareWith=t}writeValue(t){this.value=t;const e=this._getOptionId(t);null==e&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const n=function(t,e){return null==t?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}(e,t);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}registerOnChange(t){this.onChange=e=>{this.value=this._getOptionValue(e),t(this.value)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e),t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t}},class{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Ke}set compareWith(t){if("function"!=typeof t)throw new Error(`compareWith must be a function, but received ${JSON.stringify(t)}`);this._compareWith=t}writeValue(t){let e;if(this.value=t,Array.isArray(t)){const n=t.map(t=>this._getOptionId(t));e=(t,e)=>{t._setSelected(n.indexOf(e.toString())>-1)}}else e=(t,e)=>{t._setSelected(!1)};this._optionMap.forEach(e)}registerOnChange(t){this.onChange=e=>{const n=[];if(e.hasOwnProperty("selectedOptions")){const t=e.selectedOptions;for(let e=0;e<t.length;e++){const r=t.item(e),i=this._getOptionValue(r.value);n.push(i)}}else{const t=e.options;for(let e=0;e<t.length;e++){const r=t.item(e);if(r.selected){const t=this._getOptionValue(r.value);n.push(t)}}}this.value=n,t(n)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(t){const e=(this._idCounter++).toString();return this._optionMap.set(e,t),e}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e)._value,t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t}},class{constructor(t,e,n,r){this._renderer=t,this._elementRef=e,this._registry=n,this._injector=r,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(Cp),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}fireUncheck(t){this.writeValue(t)}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_checkName(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}_throwNameError(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}];function Kp(t,e){t._syncPendingControls(),e.forEach(t=>{const e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)})}function $p(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Yp="VALID",Zp="INVALID",Xp="PENDING",Jp="DISABLED";function tm(t){const e=nm(t)?t.validators:t;return Array.isArray(e)?Hp(e):e||null}function em(t,e){const n=nm(e)?e.asyncValidators:t;return Array.isArray(n)?Wp(n):n||null}function nm(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class rm{constructor(t,e){this.validator=t,this.asyncValidator=e,this._onCollectionChange=()=>{},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}get parent(){return this._parent}get valid(){return this.status===Yp}get invalid(){return this.status===Zp}get pending(){return this.status==Xp}get disabled(){return this.status===Jp}get enabled(){return this.status!==Jp}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this.validator=tm(t)}setAsyncValidators(t){this.asyncValidator=em(t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=Xp,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Jp,this.errors=null,this._forEachChild(e=>{e.disable(Object.assign({},t,{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign({},t,{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Yp,this._forEachChild(e=>{e.enable(Object.assign({},t,{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign({},t,{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),this.status!==Yp&&this.status!==Xp||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Jp:Yp}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=Xp;const e=Rp(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>this.setErrors(e,{emitEvent:t}))}}_cancelExistingSubscription(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,n){return null==e?null:(e instanceof Array||(e=e.split(".")),e instanceof Array&&0===e.length?null:e.reduce((t,e)=>t instanceof om?t.controls.hasOwnProperty(e)?t.controls[e]:null:t instanceof sm&&t.at(e)||null,t))}(this,t)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Pi,this.statusChanges=new Pi}_calculateStatus(){return this._allControlsDisabled()?Jp:this.errors?Zp:this._anyControlsHaveStatus(Xp)?Xp:this._anyControlsHaveStatus(Zp)?Zp:Yp}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){nm(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}}class im extends rm{constructor(t=null,e,n){super(tm(e),em(n,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),this._initObservables()}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_clearChangeFns(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=()=>{}}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class om extends rm{constructor(t,e,n){super(tm(e),em(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){Object.keys(t).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t={},e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e instanceof im?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>t(this.controls[e],e))}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){let e=!1;return this._forEachChild((n,r)=>{e=e||this.contains(r)&&t(n)}),e}_reduceValue(){return this._reduceChildren({},(t,e,n)=>((e.enabled||this.disabled)&&(t[n]=e.value),t))}_reduceChildren(t,e){let n=t;return this._forEachChild((t,r)=>{n=e(n,t,r)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class sm extends rm{constructor(t,e,n){super(tm(e),em(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}at(t){return this.controls[t]}push(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()}insert(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity()}removeAt(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t.forEach((t,n)=>{this.at(n)&&this.at(n).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t=[],e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof im?t.value:t.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error(`Cannot find form control at index ${t}`)}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const am=(()=>Promise.resolve(null))();class lm extends Ep{constructor(t,e){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new Pi,this.form=new om({},Hp(t),Wp(e))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){am.then(()=>{const e=this._findContainer(t.path);t.control=e.registerControl(t.name,t.control),Up(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){am.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name),$p(this._directives,t)})}addFormGroup(t){am.then(()=>{const e=this._findContainer(t.path),n=new om({});jp(n,t),e.registerControl(t.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){am.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,e){am.then(()=>{this.form.get(t.path).setValue(e)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,Kp(this.form,this._directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}class um extends Ep{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return Bp(this.name,this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return Hp(this._validators)}get asyncValidator(){return Wp(this._asyncValidators)}_checkParentType(){}}class cm{}const hm=new xt("NgModelWithFormControlWarning");class dm extends Ep{constructor(t,e){super(),this._validators=t,this._asyncValidators=e,this.submitted=!1,this.directives=[],this.form=null,this.ngSubmit=new Pi}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations())}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const e=this.form.get(t.path);return Up(e,t),e.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),e}getControl(t){return this.form.get(t.path)}removeControl(t){$p(this.directives,t)}addFormGroup(t){const e=this.form.get(t.path);jp(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormGroup(t){}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){const e=this.form.get(t.path);jp(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormArray(t){}getFormArray(t){return this.form.get(t.path)}updateModel(t,e){this.form.get(t.path).setValue(e)}onSubmit(t){return this.submitted=!0,Kp(this.form,this.directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const e=this.form.get(t.path);t.control!==e&&(function(t,e){e.valueAccessor.registerOnChange(()=>zp(e)),e.valueAccessor.registerOnTouched(()=>zp(e)),e._rawValidators.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(null)}),e._rawAsyncValidators.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(null)}),t&&t._clearChangeFns()}(t.control,t),e&&Up(e,t),t.control=e)}),this.form._updateTreeValidity({emitEvent:!1})}_updateRegistrations(){this.form._registerOnCollectionChange(()=>this._updateDomValue()),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{}),this._oldForm=this.form}_updateValidators(){const t=Hp(this._validators);this.form.validator=Dp.compose([this.form.validator,t]);const e=Wp(this._asyncValidators);this.form.asyncValidator=Dp.composeAsync([this.form.asyncValidator,e])}_checkFormPresent(){this.form||Vp.missingFormException()}}class fm extends um{constructor(t,e,n){super(),this._parent=t,this._validators=e,this._asyncValidators=n}_checkParentType(){mm(this._parent)&&Vp.groupParentException()}}class pm extends Ep{constructor(t,e,n){super(),this._parent=t,this._validators=e,this._asyncValidators=n}ngOnInit(){this._checkParentType(),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return Bp(this.name,this._parent)}get validator(){return Hp(this._validators)}get asyncValidator(){return Wp(this._asyncValidators)}_checkParentType(){mm(this._parent)&&Vp.arrayParentException()}}function mm(t){return!(t instanceof fm||t instanceof dm||t instanceof pm)}let gm=(()=>{class t extends Cp{constructor(t,e,n,r,i){super(),this._ngModelWarningConfig=i,this._added=!1,this.update=new Pi,this._ngModelWarningSent=!1,this._parent=t,this._rawValidators=e||[],this._rawAsyncValidators=n||[],this.valueAccessor=function(t,e){if(!e)return null;Array.isArray(e)||Qp(t,"Value accessor was not provided as an array for form control with");let n=void 0,r=void 0,i=void 0;return e.forEach(e=>{e.constructor===bp?n=e:function(t){return Gp.some(e=>t.constructor===e)}(e)?(r&&Qp(t,"More than one built-in value accessor matches form control with"),r=e):(i&&Qp(t,"More than one custom value accessor matches form control with"),i=e)}),i||r||n||(Qp(t,"No valid value accessor for form control with"),null)}(this,r)}set isDisabled(t){Vp.disabledAttrWarning()}ngOnChanges(e){var n,r;this._added||this._setUpControl(),function(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Ke(e,n.currentValue)}(e,this.viewModel)&&("formControlName",n=t,this,r=this._ngModelWarningConfig,ie()&&"never"!==r&&((null!==r&&"once"!==r||n._ngModelWarningSentOnce)&&("always"!==r||this._ngModelWarningSent)||(Vp.ngModelWarning("formControlName"),n._ngModelWarningSentOnce=!0,this._ngModelWarningSent=!0)),this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return Bp(this.name,this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return Hp(this._rawValidators)}get asyncValidator(){return Wp(this._rawAsyncValidators)}_checkParentType(){!(this._parent instanceof fm)&&this._parent instanceof um?Vp.ngModelGroupException():this._parent instanceof fm||this._parent instanceof dm||this._parent instanceof pm||Vp.controlParentException()}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return t._ngModelWarningSentOnce=!1,t})();class ym{}class vm{group(t,e=null){const n=this._reduceControls(t);let r=null,i=null,o=void 0;return null!=e&&(function(t){return void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn}(e)?(r=null!=e.validators?e.validators:null,i=null!=e.asyncValidators?e.asyncValidators:null,o=null!=e.updateOn?e.updateOn:void 0):(r=null!=e.validator?e.validator:null,i=null!=e.asyncValidator?e.asyncValidator:null)),new om(n,{asyncValidators:i,updateOn:o,validators:r})}control(t,e,n){return new im(t,e,n)}array(t,e,n){const r=t.map(t=>this._createControl(t));return new sm(r,e,n)}_reduceControls(t){const e={};return Object.keys(t).forEach(n=>{e[n]=this._createControl(t[n])}),e}_createControl(t){return t instanceof im||t instanceof om||t instanceof sm?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}class _m{static withConfig(t){return{ngModule:_m,providers:[{provide:hm,useValue:t.warnOnNgModelWithFormControl}]}}}class bm{}class wm{}class Em{constructor(){this.align="start"}}class Sm{constructor(t){this._animationMode=t}}class Cm{}class Tm{}const Im=new xt("cdk-dir-doc",{providedIn:"root",factory:function(){return Ut(ja)}});let xm=(()=>{class t{constructor(t){if(this.value="ltr",this.change=new Pi,t){const e=t.documentElement?t.documentElement.dir:null,n=(t.body?t.body.dir:null)||e;this.value="ltr"===n||"rtl"===n?n:"ltr"}}ngOnDestroy(){this.change.complete()}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(Im,8))},token:t,providedIn:"root"}),t})();class Am{}function km(){return"undefined"!=typeof process}function Dm(t){switch(t.length){case 0:return new of;case 1:return t[0];default:return new sf(t)}}function Nm(t,e,n,r,i={},o={}){const s=[],a=[];let l=-1,u=null;if(r.forEach(t=>{const n=t.offset,r=n==l,c=r&&u||{};Object.keys(t).forEach(n=>{let r=n,a=t[n];if("offset"!==n)switch(r=e.normalizePropertyName(r,s),a){case af:a=i[n];break;case tf:a=o[n];break;default:a=e.normalizeStyleValue(n,r,a,s)}c[r]=a}),r||a.push(c),u=c,l=n}),s.length){const t="\n - ";throw new Error(`Unable to animate due to the following errors:${t}${s.join(t)}`)}return a}function Rm(t,e,n,r){switch(e){case"start":t.onStart(()=>r(n&&Om(n,"start",t)));break;case"done":t.onDone(()=>r(n&&Om(n,"done",t)));break;case"destroy":t.onDestroy(()=>r(n&&Om(n,"destroy",t)))}}function Om(t,e,n){const r=n.totalTime,i=Pm(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,null==r?t.totalTime:r,!!n.disabled),o=t._data;return null!=o&&(i._data=o),i}function Pm(t,e,n,r,i="",o=0,s){return{element:t,triggerName:e,fromState:n,toState:r,phaseName:i,totalTime:o,disabled:!!s}}function Mm(t,e,n){let r;return t instanceof Map?(r=t.get(e))||t.set(e,r=n):(r=t[e])||(r=t[e]=n),r}function Lm(t){const e=t.indexOf(":");return[t.substring(1,e),t.substr(e+1)]}let Fm=(t,e)=>!1,Vm=(t,e)=>!1,Bm=(t,e,n)=>[];const Um=km();(Um||"undefined"!=typeof Element)&&(Fm=(t,e)=>t.contains(e),Vm=(()=>{if(Um||Element.prototype.matches)return(t,e)=>t.matches(e);{const t=Element.prototype,e=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;return e?(t,n)=>e.apply(t,[n]):Vm}})(),Bm=(t,e,n)=>{let r=[];if(n)r.push(...t.querySelectorAll(e));else{const n=t.querySelector(e);n&&r.push(n)}return r});let qm=null,jm=!1;function zm(t){qm||(qm=("undefined"!=typeof document?document.body:null)||{},jm=!!qm.style&&"WebkitAppearance"in qm.style);let e=!0;return qm.style&&!function(t){return"ebkit"==t.substring(1,6)}(t)&&!(e=t in qm.style)&&jm&&(e="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in qm.style),e}const Qm=Vm,Hm=Fm,Wm=Bm;function Gm(t){const e={};return Object.keys(t).forEach(n=>{const r=n.replace(/([a-z])([A-Z])/g,"$1-$2");e[r]=t[n]}),e}class Km{validateStyleProperty(t){return zm(t)}matchesElement(t,e){return Qm(t,e)}containsElement(t,e){return Hm(t,e)}query(t,e,n){return Wm(t,e,n)}computeStyle(t,e,n){return n||""}animate(t,e,n,r,i,o=[],s){return new of(n,r)}}let $m=(()=>{class t{}return t.NOOP=new Km,t})();const Ym=1e3,Zm="{{",Xm="ng-enter",Jm="ng-leave",tg="ng-trigger",eg=".ng-trigger",ng="ng-animating",rg=".ng-animating";function ig(t){if("number"==typeof t)return t;const e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:og(parseFloat(e[1]),e[2])}function og(t,e){switch(e){case"s":return t*Ym;default:return t}}function sg(t,e,n){return t.hasOwnProperty("duration")?t:function(t,e,n){let r,i=0,o="";if("string"==typeof t){const n=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===n)return e.push(`The provided timing value "${t}" is invalid.`),{duration:0,delay:0,easing:""};r=og(parseFloat(n[1]),n[2]);const s=n[3];null!=s&&(i=og(parseFloat(s),n[4]));const a=n[5];a&&(o=a)}else r=t;if(!n){let n=!1,o=e.length;r<0&&(e.push("Duration values below 0 are not allowed for this animation step."),n=!0),i<0&&(e.push("Delay values below 0 are not allowed for this animation step."),n=!0),n&&e.splice(o,0,`The provided timing value "${t}" is invalid.`)}return{duration:r,delay:i,easing:o}}(t,e,n)}function ag(t,e={}){return Object.keys(t).forEach(n=>{e[n]=t[n]}),e}function lg(t,e,n={}){if(e)for(let r in t)n[r]=t[r];else ag(t,n);return n}function ug(t,e,n){return n?e+":"+n+";":""}function cg(t){let e="";for(let n=0;n<t.style.length;n++){const r=t.style.item(n);e+=ug(0,r,t.style.getPropertyValue(r))}for(const n in t.style)t.style.hasOwnProperty(n)&&!n.startsWith("_")&&(e+=ug(0,n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),t.style[n]));t.setAttribute("style",e)}function hg(t,e,n){t.style&&(Object.keys(e).forEach(r=>{const i=_g(r);n&&!n.hasOwnProperty(r)&&(n[r]=t.style[i]),t.style[i]=e[r]}),km()&&cg(t))}function dg(t,e){t.style&&(Object.keys(e).forEach(e=>{const n=_g(e);t.style[n]=""}),km()&&cg(t))}function fg(t){return Array.isArray(t)?1==t.length?t[0]:ef(t):t}const pg=new RegExp(`${Zm}\\s*(.+?)\\s*}}`,"g");function mg(t){let e=[];if("string"==typeof t){const n=t.toString();let r;for(;r=pg.exec(n);)e.push(r[1]);pg.lastIndex=0}return e}function gg(t,e,n){const r=t.toString(),i=r.replace(pg,(t,r)=>{let i=e[r];return e.hasOwnProperty(r)||(n.push(`Please provide a value for the animation param ${r}`),i=""),i.toString()});return i==r?t:i}function yg(t){const e=[];let n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e}const vg=/-+([a-z0-9])/g;function _g(t){return t.replace(vg,(...t)=>t[1].toUpperCase())}function bg(t,e){return 0===t||0===e}function wg(t,e,n){const r=Object.keys(n);if(r.length&&e.length){let o=e[0],s=[];if(r.forEach(t=>{o.hasOwnProperty(t)||s.push(t),o[t]=n[t]}),s.length)for(var i=1;i<e.length;i++){let n=e[i];s.forEach(function(e){n[e]=Sg(t,e)})}}return e}function Eg(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw new Error(`Unable to resolve animation metadata node #${e.type}`)}}function Sg(t,e){return window.getComputedStyle(t)[e]}const Cg="*";function Tg(t,e){const n=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(t=>(function(t,e,n){if(":"==t[0]){const r=function(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,e)=>parseFloat(e)>parseFloat(t);case":decrement":return(t,e)=>parseFloat(e)<parseFloat(t);default:return e.push(`The transition alias value "${t}" is not supported`),"* => *"}}(t,n);if("function"==typeof r)return void e.push(r);t=r}const r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(`The provided transition expression "${t}" is not supported`),e;const i=r[1],o=r[2],s=r[3];e.push(Ag(i,s)),"<"!=o[0]||i==Cg&&s==Cg||e.push(Ag(s,i))})(t,n,e)):n.push(t),n}const Ig=new Set(["true","1"]),xg=new Set(["false","0"]);function Ag(t,e){const n=Ig.has(t)||xg.has(t),r=Ig.has(e)||xg.has(e);return(i,o)=>{let s=t==Cg||t==i,a=e==Cg||e==o;return!s&&n&&"boolean"==typeof i&&(s=i?Ig.has(t):xg.has(t)),!a&&r&&"boolean"==typeof o&&(a=o?Ig.has(e):xg.has(e)),s&&a}}const kg=":self",Dg=new RegExp(`s*${kg}s*,?`,"g");function Ng(t,e,n){return new Og(t).build(e,n)}const Rg="";class Og{constructor(t){this._driver=t}build(t,e){const n=new Pg(e);return this._resetContextStyleTimingState(n),Eg(this,fg(t),n)}_resetContextStyleTimingState(t){t.currentQuerySelector=Rg,t.collectedStyles={},t.collectedStyles[Rg]={},t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,r=e.depCount=0;const i=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),t.definitions.forEach(t=>{if(this._resetContextStyleTimingState(e),0==t.type){const n=t,r=n.name;r.toString().split(/\s*,\s*/).forEach(t=>{n.name=t,i.push(this.visitState(n,e))}),n.name=r}else if(1==t.type){const i=this.visitTransition(t,e);n+=i.queryCount,r+=i.depCount,o.push(i)}else e.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:t.name,states:i,transitions:o,queryCount:n,depCount:r,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(n.containsDynamicStyles){const i=new Set,o=r||{};if(n.styles.forEach(t=>{if(Mg(t)){const e=t;Object.keys(e).forEach(t=>{mg(e[t]).forEach(t=>{o.hasOwnProperty(t)||i.add(t)})})}}),i.size){const n=yg(i.values());e.errors.push(`state("${t.name}", ...) must define default values for all the following style substitutions: ${n.join(", ")}`)}}return{type:0,name:t.name,style:n,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=Eg(this,fg(t.animation),e);return{type:1,matchers:Tg(t.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:Lg(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(t=>Eg(this,t,e)),options:Lg(t.options)}}visitGroup(t,e){const n=e.currentTime;let r=0;const i=t.steps.map(t=>{e.currentTime=n;const i=Eg(this,t,e);return r=Math.max(r,e.currentTime),i});return e.currentTime=r,{type:3,steps:i,options:Lg(t.options)}}visitAnimate(t,e){const n=function(t,e){let n=null;if(t.hasOwnProperty("duration"))n=t;else if("number"==typeof t)return Fg(sg(t,e).duration,0,"");const r=t;if(r.split(/\s+/).some(t=>"{"==t.charAt(0)&&"{"==t.charAt(1))){const t=Fg(0,0,"");return t.dynamic=!0,t.strValue=r,t}return Fg((n=n||sg(r,e)).duration,n.delay,n.easing)}(t.timings,e.errors);let r;e.currentAnimateTimings=n;let i=t.styles?t.styles:nf({});if(5==i.type)r=this.visitKeyframes(i,e);else{let i=t.styles,o=!1;if(!i){o=!0;const t={};n.easing&&(t.easing=n.easing),i=nf(t)}e.currentTime+=n.duration+n.delay;const s=this.visitStyle(i,e);s.isEmptyStep=o,r=s}return e.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[];Array.isArray(t.styles)?t.styles.forEach(t=>{"string"==typeof t?t==tf?n.push(t):e.errors.push(`The provided style string value ${t} is not allowed.`):n.push(t)}):n.push(t.styles);let r=!1,i=null;return n.forEach(t=>{if(Mg(t)){const e=t,n=e.easing;if(n&&(i=n,delete e.easing),!r)for(let t in e)if(e[t].toString().indexOf(Zm)>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let r=e.currentTime,i=e.currentTime;n&&i>0&&(i-=n.duration+n.delay),t.styles.forEach(t=>{"string"!=typeof t&&Object.keys(t).forEach(n=>{if(!this._driver.validateStyleProperty(n))return void e.errors.push(`The provided animation property "${n}" is not a supported CSS property for animations`);const o=e.collectedStyles[e.currentQuerySelector],s=o[n];let a=!0;s&&(i!=r&&i>=s.startTime&&r<=s.endTime&&(e.errors.push(`The CSS property "${n}" that exists between the times of "${s.startTime}ms" and "${s.endTime}ms" is also being animated in a parallel animation between the times of "${i}ms" and "${r}ms"`),a=!1),i=s.startTime),a&&(o[n]={startTime:i,endTime:r}),e.options&&function(r,i,o){const s=e.options.params||{},a=mg(t[n]);a.length&&a.forEach(t=>{s.hasOwnProperty(t)||o.push(`Unable to resolve the local animation param ${t} in the given list of values`)})}(0,0,e.errors)})})}visitKeyframes(t,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push("keyframes() must be placed inside of a call to animate()"),n;let r=0;const i=[];let o=!1,s=!1,a=0;const l=t.steps.map(t=>{const n=this._makeStyleAst(t,e);let l=null!=n.offset?n.offset:function(t){if("string"==typeof t)return null;let e=null;if(Array.isArray(t))t.forEach(t=>{if(Mg(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(Mg(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}return e}(n.styles),u=0;return null!=l&&(r++,u=n.offset=l),s=s||u<0||u>1,o=o||u<a,a=u,i.push(u),n});s&&e.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&e.errors.push("Please ensure that all keyframe offsets are in order");const u=t.steps.length;let c=0;r>0&&r<u?e.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==r&&(c=1/(u-1));const h=u-1,d=e.currentTime,f=e.currentAnimateTimings,p=f.duration;return l.forEach((t,r)=>{const o=c>0?r==h?1:c*r:i[r],s=o*p;e.currentTime=d+f.delay+s,f.duration=s,this._validateStyleAst(t,e),t.offset=o,n.styles.push(t)}),n}visitReference(t,e){return{type:8,animation:Eg(this,fg(t.animation),e),options:Lg(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:Lg(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:Lg(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[i,o]=function(t){const e=!!t.split(/\s*,\s*/).find(t=>t==kg);return e&&(t=t.replace(Dg,"")),[t=t.replace(/@\*/g,eg).replace(/@\w+/g,t=>eg+"-"+t.substr(1)).replace(/:animating/g,rg),e]}(t.selector);e.currentQuerySelector=n.length?n+" "+i:i,Mm(e.collectedStyles,e.currentQuerySelector,{});const s=Eg(this,fg(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:i,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:s,originalSelector:t.selector,options:Lg(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push("stagger() can only be used inside of query()");const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:sg(t.timings,e.errors,!0);return{type:12,animation:Eg(this,fg(t.animation),e),timings:n,options:null}}}class Pg{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function Mg(t){return!Array.isArray(t)&&"object"==typeof t}function Lg(t){var e;return t?(t=ag(t)).params&&(t.params=(e=t.params)?ag(e):null):t={},t}function Fg(t,e,n){return{duration:t,delay:e,easing:n}}function Vg(t,e,n,r,i,o,s=null,a=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:r,duration:i,delay:o,totalTime:i+o,easing:s,subTimeline:a}}class Bg{constructor(){this._map=new Map}consume(t){let e=this._map.get(t);return e?this._map.delete(t):e=[],e}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const Ug=1,qg=new RegExp(":enter","g"),jg=new RegExp(":leave","g");function zg(t,e,n,r,i,o={},s={},a,l,u=[]){return(new Qg).buildKeyframes(t,e,n,r,i,o,s,a,l,u)}class Qg{buildKeyframes(t,e,n,r,i,o,s,a,l,u=[]){l=l||new Bg;const c=new Wg(t,e,l,r,i,u,[]);c.options=a,c.currentTimeline.setStyles([o],null,c.errors,a),Eg(this,n,c);const h=c.timelines.filter(t=>t.containsAnimation());if(h.length&&Object.keys(s).length){const t=h[h.length-1];t.allowOnlyTimelineStyles()||t.setStyles([s],null,c.errors,a)}return h.length?h.map(t=>t.buildKeyframes()):[Vg(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.consume(e.element);if(n){const r=e.createSubContext(t.options),i=e.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);i!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,n){let r=e.currentTimeline.currentTime;const i=null!=n.duration?ig(n.duration):null,o=null!=n.delay?ig(n.delay):null;return 0!==i&&t.forEach(t=>{const n=e.appendInstructionToTimeline(t,i,o);r=Math.max(r,n.duration+n.delay)}),r}visitReference(t,e){e.updateOptions(t.options,!0),Eg(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let r=e;const i=t.options;if(i&&(i.params||i.delay)&&((r=e.createSubContext(i)).transformIntoNewTimeline(),null!=i.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Hg);const t=ig(i.delay);r.delayNextStep(t)}t.steps.length&&(t.steps.forEach(t=>Eg(this,t,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let r=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?ig(t.options.delay):0;t.steps.forEach(o=>{const s=e.createSubContext(t.options);i&&s.delayNextStep(i),Eg(this,o,s),r=Math.max(r,s.currentTimeline.currentTime),n.push(s.currentTimeline)}),n.forEach(t=>e.currentTimeline.mergeTimelineCollectedStyles(t)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return sg(e.params?gg(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(n.duration),this.visitStyle(i,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const i=r&&r.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(i):n.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,r=e.currentTimeline.duration,i=n.duration,o=e.createSubContext().currentTimeline;o.easing=n.easing,t.styles.forEach(t=>{o.forwardTime((t.offset||0)*i),o.setStyles(t.styles,t.easing,e.errors,e.options),o.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(o),e.transformIntoNewTimeline(r+i),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,r=t.options||{},i=r.delay?ig(r.delay):0;i&&(6===e.previousNode.type||0==n&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Hg);let o=n;const s=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=s.length;let a=null;s.forEach((n,r)=>{e.currentQueryIndex=r;const s=e.createSubContext(t.options,n);i&&s.delayNextStep(i),n===e.element&&(a=s.currentTimeline),Eg(this,t.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),a&&(e.currentTimeline.mergeTimelineCollectedStyles(a),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,r=e.currentTimeline,i=t.timings,o=Math.abs(i.duration),s=o*(e.currentQueryTotal-1);let a=o*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":a=s-a;break;case"full":a=n.currentStaggerTime}const l=e.currentTimeline;a&&l.delayNextStep(a);const u=l.currentTime;Eg(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=r.currentTime-u+(r.startTime-n.currentTimeline.startTime)}}const Hg={};class Wg{constructor(t,e,n,r,i,o,s,a){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=i,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Hg,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=a||new Gg(this._driver,e,0),s.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let r=this.options;null!=n.duration&&(r.duration=ig(n.duration)),null!=n.delay&&(r.delay=ig(n.delay));const i=n.params;if(i){let t=r.params;t||(t=this.options.params={}),Object.keys(i).forEach(n=>{e&&t.hasOwnProperty(n)||(t[n]=gg(i[n],t,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(t=>{n[t]=e[t]})}}return t}createSubContext(t=null,e,n){const r=e||this.element,i=new Wg(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=Hg,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const r={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+t.delay,easing:""},i=new Kg(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(i),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,r,i,o){let s=[];if(r&&s.push(this.element),t.length>0){t=(t=t.replace(qg,"."+this._enterClassName)).replace(jg,"."+this._leaveClassName);let e=this._driver.query(this.element,t,1!=n);0!==n&&(e=n<0?e.slice(e.length+n,e.length):e.slice(0,n)),s.push(...e)}return i||0!=s.length||o.push(`\`query("${e}")\` returned zero elements. (Use \`query("${e}", { optional: true })\` if you wish to allow this.)`),s}}class Gg{constructor(t,e,n,r){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new Gg(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=Ug,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||tf,this._currentKeyframe[t]=tf}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,r){e&&(this._previousKeyframe.easing=e);const i=r&&r.params||{},o=function(t,e){const n={};let r;return t.forEach(t=>{"*"===t?(r=r||Object.keys(e)).forEach(t=>{n[t]=tf}):lg(t,!1,n)}),n}(t,this._globalTimelineStyles);Object.keys(o).forEach(t=>{const e=gg(o[t],i,n);this._pendingStyles[t]=e,this._localTimelineStyles.hasOwnProperty(t)||(this._backFill[t]=this._globalTimelineStyles.hasOwnProperty(t)?this._globalTimelineStyles[t]:tf),this._updateStyle(t,e)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(e=>{this._currentKeyframe[e]=t[e]}),Object.keys(this._localTimelineStyles).forEach(t=>{this._currentKeyframe.hasOwnProperty(t)||(this._currentKeyframe[t]=this._localTimelineStyles[t])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const n=this._styleSummary[e],r=t._styleSummary[e];(!n||r.time>n.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((i,o)=>{const s=lg(i,!0);Object.keys(s).forEach(n=>{const r=s[n];r==af?t.add(n):r==tf&&e.add(n)}),n||(s.offset=o/this.duration),r.push(s)});const i=t.size?yg(t.values()):[],o=e.size?yg(e.values()):[];if(n){const t=r[0],e=ag(t);t.offset=0,e.offset=1,r=[t,e]}return Vg(this.element,r,i,o,this.duration,this.startTime,this.easing,!1)}}class Kg extends Gg{constructor(t,e,n,r,i,o,s=!1){super(t,e,o.delay),this.element=e,this.keyframes=n,this.preStyleProps=r,this.postStyleProps=i,this._stretchStartingKeyframe=s,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],o=n+e,s=e/o,a=lg(t[0],!1);a.offset=0,i.push(a);const l=lg(t[0],!1);l.offset=$g(s),i.push(l);const u=t.length-1;for(let r=1;r<=u;r++){let s=lg(t[r],!1);s.offset=$g((e+s.offset*n)/o),i.push(s)}n=o,e=0,r="",t=i}return Vg(this.element,t,this.preStyleProps,this.postStyleProps,n,e,r,!0)}}function $g(t,e=3){const n=Math.pow(10,e-1);return Math.round(t*n)/n}class Yg{}class Zg extends Yg{normalizePropertyName(t,e){return _g(t)}normalizeStyleValue(t,e,n,r){let i="";const o=n.toString().trim();if(Xg[e]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{const e=n.match(/^[+-]?[\d\.]+([a-z]*)$/);e&&0==e[1].length&&r.push(`Please provide a CSS unit value for ${t}:${n}`)}return o+i}}const Xg=(()=>(function(t){const e={};return t.forEach(t=>e[t]=!0),e})("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function Jg(t,e,n,r,i,o,s,a,l,u,c,h,d){return{type:0,element:t,triggerName:e,isRemovalTransition:i,fromState:n,fromStyles:o,toState:r,toStyles:s,timelines:a,queriedElements:l,preStyleProps:u,postStyleProps:c,totalTime:h,errors:d}}const ty={};class ey{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,r){return function(t,e,n,r,i){return t.some(t=>t(e,n,r,i))}(this.ast.matchers,t,e,n,r)}buildStyles(t,e,n){const r=this._stateStyles["*"],i=this._stateStyles[t],o=r?r.buildStyles(e,n):{};return i?i.buildStyles(e,n):o}build(t,e,n,r,i,o,s,a,l,u){const c=[],h=this.ast.options&&this.ast.options.params||ty,d=this.buildStyles(n,s&&s.params||ty,c),f=a&&a.params||ty,p=this.buildStyles(r,f,c),m=new Set,g=new Map,y=new Map,v="void"===r,_={params:Object.assign({},h,f)},b=u?[]:zg(t,e,this.ast.animation,i,o,d,p,_,l,c);let w=0;if(b.forEach(t=>{w=Math.max(t.duration+t.delay,w)}),c.length)return Jg(e,this._triggerName,n,r,v,d,p,[],[],g,y,w,c);b.forEach(t=>{const n=t.element,r=Mm(g,n,{});t.preStyleProps.forEach(t=>r[t]=!0);const i=Mm(y,n,{});t.postStyleProps.forEach(t=>i[t]=!0),n!==e&&m.add(n)});const E=yg(m.values());return Jg(e,this._triggerName,n,r,v,d,p,b,E,g,y,w)}}class ny{constructor(t,e){this.styles=t,this.defaultParams=e}buildStyles(t,e){const n={},r=ag(this.defaultParams);return Object.keys(t).forEach(e=>{const n=t[e];null!=n&&(r[e]=n)}),this.styles.styles.forEach(t=>{if("string"!=typeof t){const i=t;Object.keys(i).forEach(t=>{let o=i[t];o.length>1&&(o=gg(o,r,e)),n[t]=o})}}),n}}class ry{constructor(t,e){this.name=t,this.ast=e,this.transitionFactories=[],this.states={},e.states.forEach(t=>{this.states[t.name]=new ny(t.style,t.options&&t.options.params||{})}),iy(this.states,"true","1"),iy(this.states,"false","0"),e.transitions.forEach(e=>{this.transitionFactories.push(new ey(t,e,this.states))}),this.fallbackTransition=new ey(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(t,e)=>!0],options:null,queryCount:0,depCount:0},this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,r){return this.transitionFactories.find(i=>i.match(t,e,n,r))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function iy(t,e,n){t.hasOwnProperty(e)?t.hasOwnProperty(n)||(t[n]=t[e]):t.hasOwnProperty(n)&&(t[e]=t[n])}const oy=new Bg;class sy{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(t,e){const n=[],r=Ng(this._driver,e,n);if(n.length)throw new Error(`Unable to build the animation due to the following errors: ${n.join("\n")}`);this._animations[t]=r}_buildPlayer(t,e,n){const r=t.element,i=Nm(0,this._normalizer,0,t.keyframes,e,n);return this._driver.animate(r,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const r=[],i=this._animations[t];let o;const s=new Map;if(i?(o=zg(this._driver,e,i,Xm,Jm,{},{},n,oy,r)).forEach(t=>{const e=Mm(s,t.element,{});t.postStyleProps.forEach(t=>e[t]=null)}):(r.push("The requested animation doesn't exist or has already been destroyed"),o=[]),r.length)throw new Error(`Unable to create the animation due to the following errors: ${r.join("\n")}`);s.forEach((t,e)=>{Object.keys(t).forEach(n=>{t[n]=this._driver.computeStyle(e,n,tf)})});const a=Dm(o.map(t=>{const e=s.get(t.element);return this._buildPlayer(t,{},e)}));return this._playersById[t]=a,a.onDestroy(()=>this.destroy(t)),this.players.push(a),a}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw new Error(`Unable to find the timeline player referenced by ${t}`);return e}listen(t,e,n,r){const i=Pm(e,"","","");return Rm(this._getPlayer(t),n,i,r),()=>{}}command(t,e,n,r){if("register"==n)return void this.register(t,r[0]);if("create"==n)return void this.create(t,e,r[0]||{});const i=this._getPlayer(t);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const ay="ng-animate-queued",ly=".ng-animate-queued",uy="ng-animate-disabled",cy=".ng-animate-disabled",hy="ng-star-inserted",dy=".ng-star-inserted",fy=[],py={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},my={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},gy="__ng_removed";class yy{constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=function(t){return null!=t?t:null}(n?t.value:t),n){const e=ag(t);delete e.value,this.options=e}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const t=this.options.params;Object.keys(e).forEach(n=>{null==t[n]&&(t[n]=e[n])})}}}const vy="void",_y=new yy(vy);class by{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Ay(e,this._hostClassName)}listen(t,e,n,r){if(!this._triggers.hasOwnProperty(e))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${e}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${e}" because the provided event is undefined!`);if("start"!=(i=n)&&"done"!=i)throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${e}" is not supported!`);var i;const o=Mm(this._elementListeners,t,[]),s={name:e,phase:n,callback:r};o.push(s);const a=Mm(this._engine.statesByElement,t,{});return a.hasOwnProperty(e)||(Ay(t,tg),Ay(t,tg+"-"+e),a[e]=_y),()=>{this._engine.afterFlush(()=>{const t=o.indexOf(s);t>=0&&o.splice(t,1),this._triggers[e]||delete a[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw new Error(`The provided animation trigger "${t}" has not been registered!`);return e}trigger(t,e,n,r=!0){const i=this._getTrigger(e),o=new Ey(this.id,e,t);let s=this._engine.statesByElement.get(t);s||(Ay(t,tg),Ay(t,tg+"-"+e),this._engine.statesByElement.set(t,s={}));let a=s[e];const l=new yy(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&a&&l.absorbOptions(a.options),s[e]=l,a||(a=_y),l.value!==vy&&a.value===l.value){if(!function(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){const r=n[i];if(!e.hasOwnProperty(r)||t[r]!==e[r])return!1}return!0}(a.params,l.params)){const e=[],n=i.matchStyles(a.value,a.params,e),r=i.matchStyles(l.value,l.params,e);e.length?this._engine.reportError(e):this._engine.afterFlush(()=>{dg(t,n),hg(t,r)})}return}const u=Mm(this._engine.playersByElement,t,[]);u.forEach(t=>{t.namespaceId==this.id&&t.triggerName==e&&t.queued&&t.destroy()});let c=i.matchTransition(a.value,l.value,t,l.params),h=!1;if(!c){if(!r)return;c=i.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:c,fromState:a,toState:l,player:o,isFallbackTransition:h}),h||(Ay(t,ay),o.onStart(()=>{ky(t,ay)})),o.onDone(()=>{let e=this.players.indexOf(o);e>=0&&this.players.splice(e,1);const n=this._engine.playersByElement.get(t);if(n){let t=n.indexOf(o);t>=0&&n.splice(t,1)}}),this.players.push(o),u.push(o),o}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,n)=>{delete e[t]}),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(e=>e.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(t=>t.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e,n=!1){this._engine.driver.query(t,eg,!0).forEach(t=>{if(t[gy])return;const n=this._engine.fetchNamespacesByElement(t);n.size?n.forEach(n=>n.triggerLeaveAnimation(t,e,!1,!0)):this.clearElementCache(t)})}triggerLeaveAnimation(t,e,n,r){const i=this._engine.statesByElement.get(t);if(i){const o=[];if(Object.keys(i).forEach(e=>{if(this._triggers[e]){const n=this.trigger(t,e,vy,r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,t,!0,e),n&&Dm(o).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t);if(e){const n=new Set;e.forEach(e=>{const r=e.name;if(n.has(r))return;n.add(r);const i=this._triggers[r].fallbackTransition,o=this._engine.statesByElement.get(t)[r]||_y,s=new yy(vy),a=new Ey(this.id,r,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:r,transition:i,fromState:o,toState:s,player:a,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e,!0),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(n.totalAnimations){const e=n.players.length?n.playersByQueriedElement.get(t):[];if(e&&e.length)r=!0;else{let e=t;for(;e=e.parentNode;)if(n.statesByElement.get(e)){r=!0;break}}}this.prepareLeaveAnimationListeners(t),r?n.markElementAsRemoved(this.id,t,!1,e):(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}insertNode(t,e){Ay(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const i=n.element,o=this._elementListeners.get(i);o&&o.forEach(e=>{if(e.name==n.triggerName){const r=Pm(i,n.triggerName,n.fromState.value,n.toState.value);r._data=t,Rm(n.player,e.phase,r,e.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(n)}),this._queue=[],e.sort((t,e)=>{const n=t.transition.ast.depCount,r=e.transition.ast.depCount;return 0==n||0==r?n-r:this._engine.driver.containsElement(t.element,e.element)?1:-1})}destroy(t){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),!!this._queue.find(e=>e.element===t)||e}}class wy{constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(t,e)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(e=>{e.queued&&t.push(e)})}),t}createNamespace(t,e){const n=new by(t,e,this);return e.parentNode?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList.length-1;if(n>=0){let r=!1;for(let i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,e)){this._namespaceList.splice(i+1,0,t),r=!0;break}r||this._namespaceList.splice(0,0,t)}else this._namespaceList.push(t);return this.namespacesByHostElement.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let r=this._namespaceLookup[t];r&&r.register(e,n)&&this.totalAnimations++}destroy(t,e){if(!t)return;const n=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[t];const e=this._namespaceList.indexOf(n);e>=0&&this._namespaceList.splice(e,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n){const t=Object.keys(n);for(let r=0;r<t.length;r++){const i=n[t[r]].namespaceId;if(i){const t=this._fetchNamespace(i);t&&e.add(t)}}}return e}trigger(t,e,n,r){if(Sy(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,n,r),!0}return!1}insertNode(t,e,n,r){if(!Sy(e))return;const i=e[gy];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const t=this.collectedLeaveElements.indexOf(e);t>=0&&this.collectedLeaveElements.splice(t,1)}if(t){const r=this._fetchNamespace(t);r&&r.insertNode(e,n)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Ay(t,uy)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),ky(t,uy))}removeNode(t,e,n,r){if(Sy(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),n){const n=this.namespacesByHostElement.get(e);n&&n.id!==t&&n.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,n,r){this.collectedLeaveElements.push(e),e[gy]={namespaceId:t,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}listen(t,e,n,r,i){return Sy(e)?this._fetchNamespace(t).listen(e,n,r,i):()=>{}}_buildInstruction(t,e,n,r,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,r,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,eg,!0);e.forEach(t=>this.destroyActiveAnimationsForElement(t)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,rg,!0)).forEach(t=>this.finishActiveQueriedAnimationOnElement(t))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(t=>{t.queued?t.markedForDestroy=!0:t.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(t=>t.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Dm(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[gy];if(e&&e.setForRemoval){if(t[gy]=py,e.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}this.driver.matchesElement(t,cy)&&this.markElementAsDisabled(t,!1),this.driver.query(t,cy,!0).forEach(t=>{this.markElementAsDisabled(t,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((t,e)=>this._balanceNamespaceList(t,e)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Ay(this.collectedEnterElements[n],hy);if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let t=0;t<n.length;t++)n[t]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(t=>t()),this._flushFns=[],this._whenQuietFns.length){const t=this._whenQuietFns;this._whenQuietFns=[],e.length?Dm(e).onDone(()=>{t.forEach(t=>t())}):t.forEach(t=>t())}}reportError(t){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${t.join("\n")}`)}_flushAnimations(t,e){const n=new Bg,r=[],i=new Map,o=[],s=new Map,a=new Map,l=new Map,u=new Set;this.disabledNodes.forEach(t=>{u.add(t);const e=this.driver.query(t,ly,!0);for(let n=0;n<e.length;n++)u.add(e[n])});const c=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=Iy(h,this.collectedEnterElements),f=new Map;let p=0;d.forEach((t,e)=>{const n=Xm+p++;f.set(e,n),t.forEach(t=>Ay(t,n))});const m=[],g=new Set,y=new Set;for(let D=0;D<this.collectedLeaveElements.length;D++){const t=this.collectedLeaveElements[D],e=t[gy];e&&e.setForRemoval&&(m.push(t),g.add(t),e.hasAnimation?this.driver.query(t,dy,!0).forEach(t=>g.add(t)):y.add(t))}const v=new Map,_=Iy(h,Array.from(g));_.forEach((t,e)=>{const n=Jm+p++;v.set(e,n),t.forEach(t=>Ay(t,n))}),t.push(()=>{d.forEach((t,e)=>{const n=f.get(e);t.forEach(t=>ky(t,n))}),_.forEach((t,e)=>{const n=v.get(e);t.forEach(t=>ky(t,n))}),m.forEach(t=>{this.processLeaveNode(t)})});const b=[],w=[];for(let D=this._namespaceList.length-1;D>=0;D--)this._namespaceList[D].drainQueuedTransitions(e).forEach(t=>{const e=t.player,i=t.element;if(b.push(e),this.collectedEnterElements.length){const t=i[gy];if(t&&t.setForMove)return void e.destroy()}const u=!c||!this.driver.containsElement(c,i),h=v.get(i),d=f.get(i),p=this._buildInstruction(t,n,d,h,u);if(!p.errors||!p.errors.length)return u?(e.onStart(()=>dg(i,p.fromStyles)),e.onDestroy(()=>hg(i,p.toStyles)),void r.push(e)):t.isFallbackTransition?(e.onStart(()=>dg(i,p.fromStyles)),e.onDestroy(()=>hg(i,p.toStyles)),void r.push(e)):(p.timelines.forEach(t=>t.stretchStartingKeyframe=!0),n.append(i,p.timelines),o.push({instruction:p,player:e,element:i}),p.queriedElements.forEach(t=>Mm(s,t,[]).push(e)),p.preStyleProps.forEach((t,e)=>{const n=Object.keys(t);if(n.length){let t=a.get(e);t||a.set(e,t=new Set),n.forEach(e=>t.add(e))}}),void p.postStyleProps.forEach((t,e)=>{const n=Object.keys(t);let r=l.get(e);r||l.set(e,r=new Set),n.forEach(t=>r.add(t))}));w.push(p)});if(w.length){const t=[];w.forEach(e=>{t.push(`@${e.triggerName} has failed due to:\n`),e.errors.forEach(e=>t.push(`- ${e}\n`))}),b.forEach(t=>t.destroy()),this.reportError(t)}const E=new Map,S=new Map;o.forEach(t=>{const e=t.element;n.has(e)&&(S.set(e,e),this._beforeAnimationBuild(t.player.namespaceId,t.instruction,E))}),r.forEach(t=>{const e=t.element;this._getPreviousPlayers(e,!1,t.namespaceId,t.triggerName,null).forEach(t=>{Mm(E,e,[]).push(t),t.destroy()})});const C=m.filter(t=>Ny(t,a,l)),T=new Map;Ty(T,this.driver,y,l,tf).forEach(t=>{Ny(t,a,l)&&C.push(t)});const I=new Map;d.forEach((t,e)=>{Ty(I,this.driver,new Set(t),a,af)}),C.forEach(t=>{const e=T.get(t),n=I.get(t);T.set(t,Object.assign({},e,n))});const x=[],A=[],k={};o.forEach(t=>{const{element:e,player:o,instruction:s}=t;if(n.has(e)){if(u.has(e))return o.onDestroy(()=>hg(e,s.toStyles)),o.disabled=!0,o.overrideTotalTime(s.totalTime),void r.push(o);let t=k;if(S.size>1){let n=e;const r=[];for(;n=n.parentNode;){const e=S.get(n);if(e){t=e;break}r.push(n)}r.forEach(e=>S.set(e,t))}const n=this._buildAnimation(o.namespaceId,s,E,i,I,T);if(o.setRealPlayer(n),t===k)x.push(o);else{const e=this.playersByElement.get(t);e&&e.length&&(o.parentPlayer=Dm(e)),r.push(o)}}else dg(e,s.fromStyles),o.onDestroy(()=>hg(e,s.toStyles)),A.push(o),u.has(e)&&r.push(o)}),A.forEach(t=>{const e=i.get(t.element);if(e&&e.length){const n=Dm(e);t.setRealPlayer(n)}}),r.forEach(t=>{t.parentPlayer?t.syncPlayerEvents(t.parentPlayer):t.destroy()});for(let D=0;D<m.length;D++){const t=m[D],e=t[gy];if(ky(t,Jm),e&&e.hasAnimation)continue;let n=[];if(s.size){let e=s.get(t);e&&e.length&&n.push(...e);let r=this.driver.query(t,rg,!0);for(let t=0;t<r.length;t++){let e=s.get(r[t]);e&&e.length&&n.push(...e)}}const r=n.filter(t=>!t.destroyed);r.length?Dy(this,t,r):this.processLeaveNode(t)}return m.length=0,x.forEach(t=>{this.players.push(t),t.onDone(()=>{t.destroy();const e=this.players.indexOf(t);this.players.splice(e,1)}),t.play()}),x}elementContainsData(t,e){let n=!1;const r=e[gy];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,r,i){let o=[];if(e){const e=this.playersByQueriedElement.get(t);e&&(o=e)}else{const e=this.playersByElement.get(t);if(e){const t=!i||i==vy;e.forEach(e=>{e.queued||(t||e.triggerName==r)&&o.push(e)})}}return(n||r)&&(o=o.filter(t=>!(n&&n!=t.namespaceId||r&&r!=t.triggerName))),o}_beforeAnimationBuild(t,e,n){const r=e.element,i=e.isRemovalTransition?void 0:t,o=e.isRemovalTransition?void 0:e.triggerName;for(const s of e.timelines){const t=s.element,a=t!==r,l=Mm(n,t,[]);this._getPreviousPlayers(t,a,i,o,e.toState).forEach(t=>{const e=t.getRealPlayer();e.beforeDestroy&&e.beforeDestroy(),t.destroy(),l.push(t)})}dg(r,e.fromStyles)}_buildAnimation(t,e,n,r,i,o){const s=e.triggerName,a=e.element,l=[],u=new Set,c=new Set,h=e.timelines.map(e=>{const h=e.element;u.add(h);const d=h[gy];if(d&&d.removedBeforeQueried)return new of(e.duration,e.delay);const f=h!==a,p=function(t){const e=[];return function t(e,n){for(let r=0;r<e.length;r++){const i=e[r];i instanceof sf?t(i.players,n):n.push(i)}}((n.get(h)||fy).map(t=>t.getRealPlayer()),e),e}().filter(t=>!!t.element&&t.element===h),m=i.get(h),g=o.get(h),y=Nm(0,this._normalizer,0,e.keyframes,m,g),v=this._buildPlayer(e,y,p);if(e.subTimeline&&r&&c.add(h),f){const e=new Ey(t,s,h);e.setRealPlayer(v),l.push(e)}return v});l.forEach(t=>{Mm(this.playersByQueriedElement,t.element,[]).push(t),t.onDone(()=>(function(t,e,n){let r;if(t instanceof Map){if(r=t.get(e)){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&t.delete(e)}}else if(r=t[e]){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&delete t[e]}return r})(this.playersByQueriedElement,t.element,t))}),u.forEach(t=>Ay(t,ng));const d=Dm(h);return d.onDestroy(()=>{u.forEach(t=>ky(t,ng)),hg(a,e.toStyles)}),c.forEach(t=>{Mm(r,t,[]).push(d)}),d}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new of(t.duration,t.delay)}}class Ey{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new of,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(n=>Rm(t,e,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){Mm(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function Sy(t){return t&&1===t.nodeType}function Cy(t,e){const n=t.style.display;return t.style.display=null!=e?e:"none",n}function Ty(t,e,n,r,i){const o=[];n.forEach(t=>o.push(Cy(t)));const s=[];r.forEach((n,r)=>{const o={};n.forEach(t=>{const n=o[t]=e.computeStyle(r,t,i);n&&0!=n.length||(r[gy]=my,s.push(r))}),t.set(r,o)});let a=0;return n.forEach(t=>Cy(t,o[a++])),s}function Iy(t,e){const n=new Map;if(t.forEach(t=>n.set(t,[])),0==e.length)return n;const r=new Set(e),i=new Map;return e.forEach(t=>{const e=function t(e){if(!e)return 1;let o=i.get(e);if(o)return o;const s=e.parentNode;return o=n.has(s)?s:r.has(s)?1:t(s),i.set(e,o),o}(t);1!==e&&n.get(e).push(t)}),n}const xy="$$classes";function Ay(t,e){if(t.classList)t.classList.add(e);else{let n=t[xy];n||(n=t[xy]={}),n[e]=!0}}function ky(t,e){if(t.classList)t.classList.remove(e);else{let n=t[xy];n&&delete n[e]}}function Dy(t,e,n){Dm(n).onDone(()=>t.processLeaveNode(e))}function Ny(t,e,n){const r=n.get(t);if(!r)return!1;let i=e.get(t);return i?r.forEach(t=>i.add(t)):e.set(t,r),n.delete(t),!0}class Ry{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._triggerCache={},this.onRemovalComplete=(t,e)=>{},this._transitionEngine=new wy(t,e,n),this._timelineEngine=new sy(t,e,n),this._transitionEngine.onRemovalComplete=(t,e)=>this.onRemovalComplete(t,e)}registerTrigger(t,e,n,r,i){const o=t+"-"+r;let s=this._triggerCache[o];if(!s){const t=[],e=Ng(this._driver,i,t);if(t.length)throw new Error(`The animation trigger "${r}" has failed to build due to the following errors:\n - ${t.join("\n - ")}`);s=function(t,e){return new ry(t,e)}(r,e),this._triggerCache[o]=s}this._transitionEngine.registerTrigger(e,r,s)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,r){this._transitionEngine.insertNode(t,e,n,r)}onRemove(t,e,n,r){this._transitionEngine.removeNode(t,e,r||!1,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,r){if("@"==n.charAt(0)){const[t,i]=Lm(n);this._timelineEngine.command(t,e,i,r)}else this._transitionEngine.trigger(t,e,n,r)}listen(t,e,n,r,i){if("@"==n.charAt(0)){const[t,r]=Lm(n);return this._timelineEngine.listen(t,e,r,i)}return this._transitionEngine.listen(t,e,n,r,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function Oy(t,e){let n=null,r=null;return Array.isArray(e)&&e.length?(n=My(e[0]),e.length>1&&(r=My(e[e.length-1]))):e&&(n=My(e)),n||r?new Py(t,n,r):null}let Py=(()=>{class t{constructor(e,n,r){this._element=e,this._startStyles=n,this._endStyles=r,this._state=0;let i=t.initialStylesByElement.get(e);i||t.initialStylesByElement.set(e,i={}),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&hg(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(hg(this._element,this._initialStyles),this._endStyles&&(hg(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(dg(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(dg(this._element,this._endStyles),this._endStyles=null),hg(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function My(t){let e=null;const n=Object.keys(t);for(let r=0;r<n.length;r++){const i=n[r];Ly(i)&&((e=e||{})[i]=t[i])}return e}function Ly(t){return"display"===t||"position"===t}const Fy=3,Vy="animation",By="animationend",Uy=1e3;class qy{constructor(t,e,n,r,i,o,s){this._element=t,this._name=e,this._duration=n,this._delay=r,this._easing=i,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=t=>this._handleCallback(t)}apply(){!function(t,e){const n=Gy(t,"").trim();n.length&&(function(t,e){let n=0;for(let r=0;r<t.length;r++)","===t.charAt(r)&&n++}(n),e=`${n}, ${e}`),Wy(t,"",e)}(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),Hy(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){jy(this._element,this._name,"paused")}resume(){jy(this._element,this._name,"running")}setPosition(t){const e=zy(this._element,this._name);this._position=t*this._duration,Wy(this._element,"Delay",`-${this._position}ms`,e)}getPosition(){return this._position}_handleCallback(t){const e=t._ngTestManualTimestamp||Date.now(),n=parseFloat(t.elapsedTime.toFixed(Fy))*Uy;t.animationName==this._name&&Math.max(e-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),Hy(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(t,e){const n=Gy(t,"").split(","),r=Qy(n,e);r>=0&&(n.splice(r,1),Wy(t,"",n.join(",")))}(this._element,this._name))}}function jy(t,e,n){Wy(t,"PlayState",n,zy(t,e))}function zy(t,e){const n=Gy(t,"");return n.indexOf(",")>0?Qy(n.split(","),e):Qy([n],e)}function Qy(t,e){for(let n=0;n<t.length;n++)if(t[n].indexOf(e)>=0)return n;return-1}function Hy(t,e,n){n?t.removeEventListener(By,e):t.addEventListener(By,e)}function Wy(t,e,n,r){const i=Vy+e;if(null!=r){const e=t.style[i];if(e.length){const t=e.split(",");t[r]=n,n=t.join(",")}}t.style[i]=n}function Gy(t,e){return t.style[Vy+e]}const Ky="forwards",$y="linear";class Yy{constructor(t,e,n,r,i,o,s,a){this.element=t,this.keyframes=e,this.animationName=n,this._duration=r,this._delay=i,this._finalStyles=s,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=o||$y,this.totalTime=r+i,this._buildStyler()}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}destroy(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(t=>t()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}finish(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(t){this._styler.setPosition(t)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new qy(this.element,this.animationName,this._duration,this._delay,this.easing,Ky,()=>this.finish())}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}beforeDestroy(){this.init();const t={};if(this.hasStarted()){const e=this._state>=3;Object.keys(this._finalStyles).forEach(n=>{"offset"!=n&&(t[n]=e?this._finalStyles[n]:Sg(this.element,n))})}this.currentSnapshot=t}}class Zy extends of{constructor(t,e){super(),this.element=t,this._startingStyles={},this.__initialized=!1,this._styles=Gm(e)}init(){!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(t=>{this._startingStyles[t]=this.element.style[t]}),super.init())}play(){this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(t=>this.element.style.setProperty(t,this._styles[t])),super.play())}destroy(){this._startingStyles&&(Object.keys(this._startingStyles).forEach(t=>{const e=this._startingStyles[t];e?this.element.style.setProperty(t,e):this.element.style.removeProperty(t)}),this._startingStyles=null,super.destroy())}}const Xy="gen_css_kf_",Jy=" ";class tv{constructor(){this._count=0,this._head=document.querySelector("head"),this._warningIssued=!1}validateStyleProperty(t){return zm(t)}matchesElement(t,e){return Qm(t,e)}containsElement(t,e){return Hm(t,e)}query(t,e,n){return Wm(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}buildKeyframeElement(t,e,n){n=n.map(t=>Gm(t));let r=`@keyframes ${e} {\n`,i="";n.forEach(t=>{i=Jy;const e=parseFloat(t.offset);r+=`${i}${100*e}% {\n`,i+=Jy,Object.keys(t).forEach(e=>{const n=t[e];switch(e){case"offset":return;case"easing":return void(n&&(r+=`${i}animation-timing-function: ${n};\n`));default:return void(r+=`${i}${e}: ${n};\n`)}}),r+=`${i}}\n`}),r+="}\n";const o=document.createElement("style");return o.innerHTML=r,o}animate(t,e,n,r,i,o=[],s){s&&this._notifyFaultyScrubber();const a=o.filter(t=>t instanceof Yy),l={};bg(n,r)&&a.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>l[t]=e[t])});const u=function(t){let e={};return t&&(Array.isArray(t)?t:[t]).forEach(t=>{Object.keys(t).forEach(n=>{"offset"!=n&&"easing"!=n&&(e[n]=t[n])})}),e}(e=wg(t,e,l));if(0==n)return new Zy(t,u);const c=`${Xy}${this._count++}`,h=this.buildKeyframeElement(t,c,e);document.querySelector("head").appendChild(h);const d=Oy(t,e),f=new Yy(t,e,c,n,r,i,u,d);return f.onDestroy(()=>(function(t){h.parentNode.removeChild(h)})()),f}_notifyFaultyScrubber(){this._warningIssued||(console.warn("@angular/animations: please load the web-animations.js polyfill to allow programmatic access...\n","  visit http://bit.ly/IWukam to learn more about using the web-animation-js polyfill."),this._warningIssued=!0)}}class ev{constructor(t,e,n,r){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,n){return t.animate(e,n)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(e=>{"offset"!=e&&(t[e]=this._finished?this._finalKeyframe[e]:Sg(this.element,e))}),this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class nv{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(rv().toString()),this._cssKeyframesDriver=new tv}validateStyleProperty(t){return zm(t)}matchesElement(t,e){return Qm(t,e)}containsElement(t,e){return Hm(t,e)}query(t,e,n){return Wm(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}overrideWebAnimationsSupport(t){this._isNativeImpl=t}animate(t,e,n,r,i,o=[],s){if(!s&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(t,e,n,r,i,o);const a={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(a.easing=i);const l={},u=o.filter(t=>t instanceof ev);bg(n,r)&&u.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>l[t]=e[t])});const c=Oy(t,e=wg(t,e=e.map(t=>lg(t,!1)),l));return new ev(t,e,a,c)}}function rv(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}class iv extends Xd{constructor(t,e){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(e.body,{id:"0",encapsulation:Gt.None,styles:[],data:{animation:[]}})}build(t){const e=this._nextAnimationId.toString();this._nextAnimationId++;const n=Array.isArray(t)?ef(t):t;return av(this._renderer,null,e,"register",[n]),new ov(e,this._renderer)}}class ov extends Jd{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new sv(this._id,t,e||{},this._renderer)}}class sv{constructor(t,e,n,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return av(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset")}setPosition(t){this._command("setPosition",t)}getPosition(){return 0}}function av(t,e,n,r,i){return t.setProperty(e,`@@${n}:${r}`,i)}const lv="@",uv="@.disabled";class cv{constructor(t,e,n){this.delegate=t,this.engine=e,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),e.onRemovalComplete=(t,e)=>{e&&e.parentNode(t)&&e.removeChild(t.parentNode,t)}}createRenderer(t,e){const n=this.delegate.createRenderer(t,e);if(!(t&&e&&e.data&&e.data.animation)){let t=this._rendererCache.get(n);return t||(t=new hv("",n,this.engine),this._rendererCache.set(n,t)),t}const r=e.id,i=e.id+"-"+this._currentId;return this._currentId++,this.engine.register(i,t),e.data.animation.forEach(e=>this.engine.registerTrigger(r,i,t,e.name,e)),new dv(this,i,n,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,n){t>=0&&t<this._microtaskId?this._zone.run(()=>e(n)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(t=>{const[e,n]=t;e(n)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([e,n]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}class hv{constructor(t,e,n){this.namespaceId=t,this.delegate=e,this.engine=n,this.destroyNode=this.delegate.destroyNode?t=>e.destroyNode(t):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,!0)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,r){this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,r){this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){e.charAt(0)==lv&&e==uv?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class dv extends hv{constructor(t,e,n,r){super(e,n,r),this.factory=t,this.namespaceId=e}setProperty(t,e,n){e.charAt(0)==lv?"."==e.charAt(1)&&e==uv?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.substr(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if(e.charAt(0)==lv){const r=function(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(t);let i=e.substr(1),o="";return i.charAt(0)!=lv&&([i,o]=function(t){const e=t.indexOf(".");return[t.substring(0,e),t.substr(e+1)]}(i)),this.engine.listen(this.namespaceId,r,i,o,t=>{this.factory.scheduleListenerCallback(t._data||-1,n,t)})}return this.delegate.listen(t,e,n)}}class fv extends Ry{constructor(t,e,n){super(t.body,e,n)}}function pv(){return"function"==typeof rv()?new nv:new tv}function mv(){return new Zg}function gv(t,e,n){return new cv(t,e,n)}const yv=new xt("AnimationModuleType");class vv{}var _v=nr({encapsulation:2,styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(.4,0,.2,1);display:block;position:relative;padding:16px;border-radius:4px}._mat-animation-noopable.mat-card{transition:none;animation:none}.mat-card .mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card .mat-divider-horizontal{left:auto;right:0}.mat-card .mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card .mat-divider-horizontal.mat-divider-inset{margin-right:0}@media (-ms-high-contrast:active){.mat-card{outline:solid 1px}}.mat-card-actions,.mat-card-content,.mat-card-subtitle{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media (max-width:599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card-content>:first-child,.mat-card>:first-child{margin-top:0}.mat-card-content>:last-child:not(.mat-card-footer),.mat-card>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions .mat-button:first-child,.mat-card-actions .mat-raised-button:first-child{margin-left:0;margin-right:0}.mat-card-subtitle:not(:first-child),.mat-card-title:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}"],data:{}});function bv(t){return fs(2,[ls(null,0),ls(null,1)],null,null)}var wv=nr({encapsulation:2,styles:[],data:{}});function Ev(t){return fs(2,[ls(null,0),(t()(),Xo(1,0,null,null,1,"div",[["class","mat-card-header-text"]],null,null,null,null,null)),ls(null,1),ls(null,2)],null,null)}let Sv=(()=>{class t{create(t){return"undefined"==typeof MutationObserver?null:new MutationObserver(t)}}return t.ngInjectableDef=mt({factory:function(){return new t},token:t,providedIn:"root"}),t})(),Cv=(()=>{class t{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,e)=>this._cleanupObserver(e))}observe(t){const e=hf(t);return new w(t=>{const n=this._observeElement(e).subscribe(t);return()=>{n.unsubscribe(),this._unobserveElement(e)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const e=new x,n=this._mutationObserverFactory.create(t=>e.next(t));n&&n.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:n,stream:e,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:e,stream:n}=this._observedElements.get(t);e&&e.disconnect(),n.complete(),this._observedElements.delete(t)}}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(Sv))},token:t,providedIn:"root"}),t})();class Tv{constructor(t,e,n){this._contentObserver=t,this._elementRef=e,this._ngZone=n,this.event=new Pi,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=lf(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=function(t,e=0){return function(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}(t)?Number(t):e}(t),this._subscribe()}ngAfterContentInit(){this._currentSubscription||this.disabled||this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(If(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){this._currentSubscription&&this._currentSubscription.unsubscribe()}}class Iv{}var xv=nr({encapsulation:2,styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}@media (-ms-high-contrast:active){.mat-form-field-infix{border-image:linear-gradient(transparent,transparent)}}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform .4s cubic-bezier(.25,.8,.25,1),color .4s cubic-bezier(.25,.8,.25,1),width .4s cubic-bezier(.25,.8,.25,1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label,.mat-form-field-empty.mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scaleY(1.0001)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(.5);opacity:0;transition:background-color .3s cubic-bezier(.55,0,.55,.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:scaleX(1);transition:transform .3s cubic-bezier(.25,.8,.25,1),opacity .1s cubic-bezier(.25,.8,.25,1),background-color .3s cubic-bezier(.25,.8,.25,1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-label-wrapper .mat-icon,.mat-form-field-subscript-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}",".mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}@media (-ms-high-contrast:active){.mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:'';display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}@media (-ms-high-contrast:active){.mat-form-field-appearance-fill .mat-form-field-ripple{height:0;border-top:solid 2px}}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity .6s cubic-bezier(.25,.8,.25,1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}",".mat-input-element{font:inherit;background:0 0;color:currentColor;border:none;outline:0;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element::-ms-clear,.mat-input-element::-ms-reveal{display:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=month]::after,.mat-input-element[type=time]::after,.mat-input-element[type=week]::after{content:' ';white-space:pre;width:1px}.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button,.mat-input-element::-webkit-inner-spin-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color .4s .133s cubic-bezier(.25,.8,.25,1)}.mat-input-element::placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-moz-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color .4s .133s cubic-bezier(.25,.8,.25,1)}.mat-input-element::-moz-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color .4s .133s cubic-bezier(.25,.8,.25,1)}.mat-input-element::-webkit-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color .4s .133s cubic-bezier(.25,.8,.25,1)}.mat-input-element:-ms-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:transparent!important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:transparent!important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:transparent!important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:transparent!important;-webkit-text-fill-color:transparent;transition:none}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:transparent;display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-ms-expand{display:none}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}select.mat-input-element::-ms-value{color:inherit;background:0 0}@media (-ms-high-contrast:active){.mat-focused select.mat-input-element::-ms-value{color:inherit}}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:'';width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}",".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px);-ms-transform:none}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}@media (-ms-high-contrast:active){.mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}@media (-ms-high-contrast:active){.mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}@media (-ms-high-contrast:active){.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-start{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:transparent}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start{border-width:2px;transition:border-color .3s cubic-bezier(.25,.8,.25,1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity .1s cubic-bezier(.25,.8,.25,1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity .6s cubic-bezier(.25,.8,.25,1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline{transition:none}",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}@media (-ms-high-contrast:active){.mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}@media (-ms-high-contrast:active){.mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:2px}}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}@media (-ms-high-contrast:active){.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity .6s cubic-bezier(.25,.8,.25,1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}"],data:{animation:[{type:7,name:"transitionMessages",definitions:[{type:0,name:"enter",styles:{type:6,styles:{opacity:1,transform:"translateY(0%)"},offset:null},options:void 0},{type:1,expr:"void => enter",animation:[{type:6,styles:{opacity:0,transform:"translateY(-100%)"},offset:null},{type:4,styles:null,timings:"300ms cubic-bezier(0.55, 0, 0.55, 0.2)"}],options:null}],options:{}}]}});function Av(t){return fs(0,[(t()(),Xo(0,0,null,null,8,null,null,null,null,null,null,null)),(t()(),Xo(1,0,null,null,3,"div",[["class","mat-form-field-outline"]],null,null,null,null,null)),(t()(),Xo(2,0,null,null,0,"div",[["class","mat-form-field-outline-start"]],null,null,null,null,null)),(t()(),Xo(3,0,null,null,0,"div",[["class","mat-form-field-outline-gap"]],null,null,null,null,null)),(t()(),Xo(4,0,null,null,0,"div",[["class","mat-form-field-outline-end"]],null,null,null,null,null)),(t()(),Xo(5,0,null,null,3,"div",[["class","mat-form-field-outline mat-form-field-outline-thick"]],null,null,null,null,null)),(t()(),Xo(6,0,null,null,0,"div",[["class","mat-form-field-outline-start"]],null,null,null,null,null)),(t()(),Xo(7,0,null,null,0,"div",[["class","mat-form-field-outline-gap"]],null,null,null,null,null)),(t()(),Xo(8,0,null,null,0,"div",[["class","mat-form-field-outline-end"]],null,null,null,null,null))],null,null)}function kv(t){return fs(0,[(t()(),Xo(0,0,null,null,1,"div",[["class","mat-form-field-prefix"]],null,null,null,null,null)),ls(null,0)],null,null)}function Dv(t){return fs(0,[(t()(),Xo(0,0,null,null,3,null,null,null,null,null,null,null)),ls(null,2),(t()(),Xo(2,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),cs(3,null,["",""]))],null,function(t,e){t(e,3,0,e.component._control.placeholder)})}function Nv(t){return fs(0,[ls(null,3),(t()(),Zo(0,null,null,0))],null,null)}function Rv(t){return fs(0,[(t()(),Xo(0,0,null,null,1,"span",[["aria-hidden","true"],["class","mat-placeholder-required mat-form-field-required-marker"]],null,null,null,null,null)),(t()(),cs(-1,null,[" *"]))],null,null)}function Ov(t){return fs(0,[(t()(),Xo(0,0,[[4,0],["label",1]],null,8,"label",[["class","mat-form-field-label"]],[[8,"id",0],[1,"for",0],[1,"aria-owns",0],[2,"mat-empty",null],[2,"mat-form-field-empty",null],[2,"mat-accent",null],[2,"mat-warn",null]],[[null,"cdkObserveContent"]],function(t,e,n){var r=!0;return"cdkObserveContent"===e&&(r=!1!==t.component.updateOutlineGap()&&r),r},null,null)),ci(1,16384,null,0,Ba,[],{ngSwitch:[0,"ngSwitch"]},null),ci(2,1196032,null,0,Tv,[Cv,dn,uo],{disabled:[0,"disabled"]},{event:"cdkObserveContent"}),(t()(),Zo(16777216,null,null,1,null,Dv)),ci(4,278528,null,0,Ua,[Vn,Ln,Ba],{ngSwitchCase:[0,"ngSwitchCase"]},null),(t()(),Zo(16777216,null,null,1,null,Nv)),ci(6,278528,null,0,Ua,[Vn,Ln,Ba],{ngSwitchCase:[0,"ngSwitchCase"]},null),(t()(),Zo(16777216,null,null,1,null,Rv)),ci(8,16384,null,0,Ma,[Vn,Ln],{ngIf:[0,"ngIf"]},null)],function(t,e){var n=e.component;t(e,1,0,n._hasLabel()),t(e,2,0,"outline"!=n.appearance),t(e,4,0,!1),t(e,6,0,!0),t(e,8,0,!n.hideRequiredMarker&&n._control.required&&!n._control.disabled)},function(t,e){var n=e.component;t(e,0,0,n._labelId,n._control.id,n._control.id,n._control.empty&&!n._shouldAlwaysFloat,n._control.empty&&!n._shouldAlwaysFloat,"accent"==n.color,"warn"==n.color)})}function Pv(t){return fs(0,[(t()(),Xo(0,0,null,null,1,"div",[["class","mat-form-field-suffix"]],null,null,null,null,null)),ls(null,4)],null,null)}function Mv(t){return fs(0,[(t()(),Xo(0,0,[[1,0],["underline",1]],null,1,"div",[["class","mat-form-field-underline"]],null,null,null,null,null)),(t()(),Xo(1,0,null,null,0,"span",[["class","mat-form-field-ripple"]],[[2,"mat-accent",null],[2,"mat-warn",null]],null,null,null,null))],null,function(t,e){var n=e.component;t(e,1,0,"accent"==n.color,"warn"==n.color)})}function Lv(t){return fs(0,[(t()(),Xo(0,0,null,null,1,"div",[],[[24,"@transitionMessages",0]],null,null,null,null)),ls(null,5)],null,function(t,e){t(e,0,0,e.component._subscriptAnimationState)})}function Fv(t){return fs(0,[(t()(),Xo(0,0,null,null,1,"div",[["class","mat-hint"]],[[8,"id",0]],null,null,null,null)),(t()(),cs(1,null,["",""]))],null,function(t,e){var n=e.component;t(e,0,0,n._hintLabelId),t(e,1,0,n.hintLabel)})}function Vv(t){return fs(0,[(t()(),Xo(0,0,null,null,5,"div",[["class","mat-form-field-hint-wrapper"]],[[24,"@transitionMessages",0]],null,null,null,null)),(t()(),Zo(16777216,null,null,1,null,Fv)),ci(2,16384,null,0,Ma,[Vn,Ln],{ngIf:[0,"ngIf"]},null),ls(null,6),(t()(),Xo(4,0,null,null,0,"div",[["class","mat-form-field-hint-spacer"]],null,null,null,null,null)),ls(null,7)],function(t,e){t(e,2,0,e.component.hintLabel)},function(t,e){t(e,0,0,e.component._subscriptAnimationState)})}function Bv(t){return fs(2,[rs(671088640,1,{underlineRef:0}),rs(402653184,2,{_connectionContainerRef:0}),rs(671088640,3,{_inputContainerRef:0}),rs(671088640,4,{_label:0}),(t()(),Xo(4,0,null,null,20,"div",[["class","mat-form-field-wrapper"]],null,null,null,null,null)),(t()(),Xo(5,0,[[2,0],["connectionContainer",1]],null,11,"div",[["class","mat-form-field-flex"]],null,[[null,"click"]],function(t,e,n){var r=!0,i=t.component;return"click"===e&&(r=!1!==(i._control.onContainerClick&&i._control.onContainerClick(n))&&r),r},null,null)),(t()(),Zo(16777216,null,null,1,null,Av)),ci(7,16384,null,0,Ma,[Vn,Ln],{ngIf:[0,"ngIf"]},null),(t()(),Zo(16777216,null,null,1,null,kv)),ci(9,16384,null,0,Ma,[Vn,Ln],{ngIf:[0,"ngIf"]},null),(t()(),Xo(10,0,[[3,0],["inputContainer",1]],null,4,"div",[["class","mat-form-field-infix"]],null,null,null,null,null)),ls(null,1),(t()(),Xo(12,0,null,null,2,"span",[["class","mat-form-field-label-wrapper"]],null,null,null,null,null)),(t()(),Zo(16777216,null,null,1,null,Ov)),ci(14,16384,null,0,Ma,[Vn,Ln],{ngIf:[0,"ngIf"]},null),(t()(),Zo(16777216,null,null,1,null,Pv)),ci(16,16384,null,0,Ma,[Vn,Ln],{ngIf:[0,"ngIf"]},null),(t()(),Zo(16777216,null,null,1,null,Mv)),ci(18,16384,null,0,Ma,[Vn,Ln],{ngIf:[0,"ngIf"]},null),(t()(),Xo(19,0,null,null,5,"div",[["class","mat-form-field-subscript-wrapper"]],null,null,null,null,null)),ci(20,16384,null,0,Ba,[],{ngSwitch:[0,"ngSwitch"]},null),(t()(),Zo(16777216,null,null,1,null,Lv)),ci(22,278528,null,0,Ua,[Vn,Ln,Ba],{ngSwitchCase:[0,"ngSwitchCase"]},null),(t()(),Zo(16777216,null,null,1,null,Vv)),ci(24,278528,null,0,Ua,[Vn,Ln,Ba],{ngSwitchCase:[0,"ngSwitchCase"]},null)],function(t,e){var n=e.component;t(e,7,0,"outline"==n.appearance),t(e,9,0,n._prefixChildren.length),t(e,14,0,n._hasFloatingLabel()),t(e,16,0,n._suffixChildren.length),t(e,18,0,"outline"!=n.appearance),t(e,20,0,n._getDisplayedMessages()),t(e,22,0,"error"),t(e,24,0,"hint")},null)}class Uv{constructor(t){this.durationSelector=t}call(t,e){return e.subscribe(new qv(t,this.durationSelector))}}class qv extends q{constructor(t,e){super(t),this.durationSelector=e,this.hasValue=!1}_next(t){if(this.value=t,this.hasValue=!0,!this.throttled){let n;try{const{durationSelector:r}=this;n=r(t)}catch(e){return this.destination.error(e)}const r=U(this,n);!r||r.closed?this.clearThrottle():this.add(this.throttled=r)}}clearThrottle(){const{value:t,hasValue:e,throttled:n}=this;n&&(this.remove(n),this.throttled=null,n.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))}notifyNext(t,e,n,r){this.clearThrottle()}notifyComplete(){this.clearThrottle()}}function jv(t){return!l(t)&&t-parseFloat(t)+1>=0}function zv(t){const{index:e,period:n,subscriber:r}=t;if(r.next(e),!r.closed){if(-1===n)return r.complete();t.index=e+1,this.schedule(t,n)}}function Qv(t,e=Tf){return n=()=>(function(t=0,e,n){let r=-1;return jv(e)?r=Number(e)<1?1:Number(e):k(e)&&(n=e),k(n)||(n=Tf),new w(e=>{const i=jv(t)?t:+t-n.now();return n.schedule(zv,i,{index:0,period:r,subscriber:e})})})(t,e),function(t){return t.lift(new Uv(n))};var n}const Hv=bf({passive:!0});let Wv=(()=>{class t{constructor(t,e){this._platform=t,this._ngZone=e,this._monitoredElements=new Map}monitor(t){if(!this._platform.isBrowser)return Ka;const e=hf(t),n=this._monitoredElements.get(e);if(n)return n.subject.asObservable();const r=new x,i="cdk-text-field-autofilled",o=t=>{"cdk-text-field-autofill-start"!==t.animationName||e.classList.contains(i)?"cdk-text-field-autofill-end"===t.animationName&&e.classList.contains(i)&&(e.classList.remove(i),this._ngZone.run(()=>r.next({target:t.target,isAutofilled:!1}))):(e.classList.add(i),this._ngZone.run(()=>r.next({target:t.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{e.addEventListener("animationstart",o,Hv),e.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(e,{subject:r,unlisten:()=>{e.removeEventListener("animationstart",o,Hv)}}),r.asObservable()}stopMonitoring(t){const e=hf(t),n=this._monitoredElements.get(e);n&&(n.unlisten(),n.subject.complete(),e.classList.remove("cdk-text-field-autofill-monitored"),e.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(e))}ngOnDestroy(){this._monitoredElements.forEach((t,e)=>this.stopMonitoring(e))}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(mf),Bt(uo))},token:t,providedIn:"root"}),t})();class Gv{}const Kv=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let $v=0;class Yv{constructor(t,e,n,r){this._defaultErrorStateMatcher=t,this._parentForm=e,this._parentFormGroup=n,this.ngControl=r}}const Zv=jf(Yv);class Xv extends Zv{constructor(t,e,n,r,i,o,s,a,l){super(o,r,i,n),this._elementRef=t,this._platform=e,this.ngControl=n,this._autofillMonitor=a,this._uid=`mat-input-${$v++}`,this._isServer=!1,this._isNativeSelect=!1,this.focused=!1,this.stateChanges=new x,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._required=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(t=>vf().has(t));const u=this._elementRef.nativeElement;this._inputValueAccessor=s||u,this._previousNativeValue=this.value,this.id=this.id,e.IOS&&l.runOutsideAngular(()=>{t.nativeElement.addEventListener("keyup",t=>{let e=t.target;e.value||e.selectionStart||e.selectionEnd||(e.setSelectionRange(1,1),e.setSelectionRange(0,0))})}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===u.nodeName.toLowerCase(),this._isNativeSelect&&(this.controlType=u.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(t){this._disabled=lf(t),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(t){this._id=t||this._uid}get required(){return this._required}set required(t){this._required=lf(t)}get type(){return this._type}set type(t){this._type=t||"text",this._validateType(),!this._isTextarea()&&vf().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(t){t!==this.value&&(this._inputValueAccessor.value=t,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(t){this._readonly=lf(t)}ngOnInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(t=>{this.autofilled=t.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue()}focus(t){this._elementRef.nativeElement.focus(t)}_focusChanged(t){t===this.focused||this.readonly&&t||(this.focused=t,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){const t=this._elementRef.nativeElement.value;this._previousNativeValue!==t&&(this._previousNativeValue=t,this.stateChanges.next())}_validateType(){if(Kv.indexOf(this._type)>-1)throw Error(`Input type "${this._type}" isn't supported by matInput.`)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let t=this._elementRef.nativeElement.validity;return t&&t.badInput}_isTextarea(){return"textarea"===this._elementRef.nativeElement.nodeName.toLowerCase()}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const t=this._elementRef.nativeElement,e=t.options[0];return this.focused||t.multiple||!this.empty||!!(t.selectedIndex>-1&&e&&e.label)}return this.focused||!this.empty}setDescribedByIds(t){this._ariaDescribedby=t.join(" ")}onContainerClick(){this.focused||this.focus()}}class Jv{}const t_="accent",e_=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"];class n_{constructor(t){this._elementRef=t}}const r_=Uf(Bf(qf(n_)));class i_ extends r_{constructor(t,e,n){super(t),this._focusMonitor=e,this._animationMode=n,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const r of e_)this._hasHostAttributes(r)&&this._getHostElement().classList.add(r);t.nativeElement.classList.add("mat-button-base"),this._focusMonitor.monitor(this._elementRef,!0),this.isRoundButton&&(this.color=t_)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t,e){this._getHostElement().focus(e)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...t){return t.some(t=>this._getHostElement().hasAttribute(t))}}class o_{}var s_=nr({encapsulation:2,styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:.04}@media (hover:none){.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-flat-button,.mat-icon-button,.mat-stroked-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner{border:0}.mat-button[disabled],.mat-flat-button[disabled],.mat-icon-button[disabled],.mat-stroked-button[disabled]{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button[disabled]{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-focus-overlay,.mat-stroked-button .mat-button-ripple.mat-ripple{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab[disabled]{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab[disabled]{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button .mat-icon,.mat-icon-button i{line-height:24px}.mat-button-focus-overlay,.mat-button-ripple.mat-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity .2s cubic-bezier(.35,0,.25,1),background-color .2s cubic-bezier(.35,0,.25,1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}@media (-ms-high-contrast:active){.mat-button-focus-overlay{background-color:#fff}}@media (-ms-high-contrast:black-on-white){.mat-button-focus-overlay{background-color:#000}}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}@media (-ms-high-contrast:active){.mat-button,.mat-fab,.mat-flat-button,.mat-icon-button,.mat-mini-fab,.mat-raised-button{outline:solid 1px}}"],data:{}});function a_(t){return fs(2,[rs(671088640,1,{ripple:0}),(t()(),Xo(1,0,null,null,1,"span",[["class","mat-button-wrapper"]],null,null,null,null,null)),ls(null,0),(t()(),Xo(3,0,null,null,1,"div",[["class","mat-button-ripple mat-ripple"],["matRipple",""]],[[2,"mat-button-ripple-round",null],[2,"mat-ripple-unbounded",null]],null,null,null,null)),ci(4,212992,[[1,4]],0,Xf,[dn,uo,mf,[2,Zf],[2,yv]],{centered:[0,"centered"],disabled:[1,"disabled"],trigger:[2,"trigger"]},null),(t()(),Xo(5,0,null,null,0,"div",[["class","mat-button-focus-overlay"]],null,null,null,null,null))],function(t,e){var n=e.component;t(e,4,0,n.isIconButton,n._isRippleDisabled(),n._getHostElement())},function(t,e){var n=e.component;t(e,3,0,n.isRoundButton||n.isIconButton,Zr(e,4).unbounded)})}class l_{constructor(t,e,n,r){this.authService=t,this.formBuilder=e,this.snackbar=n,this.router=r}ngOnInit(){this.registerForm()}registerForm(){this.authForm=this.formBuilder.group({member:new im("",[Dp.required])})}onSubmit(){this.authForm.valid?(this.authForm.disable(),this.validateMember(this.authForm.value.member)):console.log("Emburrao")}validateMember(t){this.authService.getMembers(t).subscribe(e=>{console.log("members",e),e.length>0?this.router.navigate(["lovenfriendship",t]):(this.displaySnackbar("El usuario no es v\xe1lido",5e3),this.authForm.enable())},t=>this.displaySnackbar(t,5e3))}displaySnackbar(t,e){this.snackbar.open(t,"",{duration:e})}}function u_(t){return function(t){return new w(e=>({unsubscribe:t.onSnapshot(e)}))}(t).pipe(st())}function c_(t){return u_(t).pipe(j(t=>({payload:t,type:"query"})))}function h_(t){return c_(t).pipe(j(t=>t.payload.docChanges().map(t=>({type:t.type,payload:t}))))}function d_(t,e){return c_(t).pipe(j(t=>t.payload.docChanges()),Fl((t,n)=>(function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)||t.splice(e.newIndex,0,e);break;case"modified":(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))&&(e.oldIndex!==e.newIndex?(t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e)):t.splice(e.newIndex,1,e));break;case"removed":t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref)&&t.splice(e.oldIndex,1)}return t}(t,e))}),t})(t,n,e),[]),j(t=>t.map(t=>({type:t.type,payload:t}))))}n("mrSG");class f_ extends Ef{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,n=0){return null!==n&&n>0||null===n&&this.delay>0?super.requestAsyncId(t,e,n):t.flush(this)}}class p_ extends Cf{}const m_=new p_(f_);class g_{constructor(t,e){this.zone=t,this.platformId=e}schedule(...t){return this.zone.runGuarded(function(){return m_.schedule.apply(m_,t)})}keepUnstableUntilFirst(t){return Ha(this.platformId)?new w(e=>{const n=()=>{},r=Zone.current.scheduleMacroTask("firebaseZoneBlock",n,{},n,n);t.subscribe(t=>{"scheduled"===r.state&&r.invoke(),e.next(t)},t=>{"scheduled"===r.state&&r.invoke(),e.error(t)},()=>{"scheduled"===r.state&&r.invoke(),e.complete()})}):t}runOutsideAngular(t){return new w(e=>this.zone.runOutsideAngular(()=>t.subscribe(t=>this.zone.run(()=>e.next(t)),t=>this.zone.run(()=>e.error(t)),()=>this.zone.run(()=>e.complete()))))}}const y_=t=>e=>new w(n=>e.subscribe(e=>t.run(()=>n.next(e)),e=>t.run(()=>n.error(e)),()=>t.run(()=>n.complete())));function v_(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class __{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){return t&&0!==t.length?this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(h_(this.query))).pipe(j(e=>e.filter(e=>t.indexOf(e.type)>-1)),al(t=>t.length>0)):this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(h_(this.query)))}auditTrail(t){return this.stateChanges(t).pipe(Fl((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=v_(t),n=d_(this.query,e),r=this.afs.scheduler.runOutsideAngular(n);return this.afs.scheduler.keepUnstableUntilFirst(r)}valueChanges(t={}){const e=c_(this.query),n=this.afs.scheduler.runOutsideAngular(e);return this.afs.scheduler.keepUnstableUntilFirst(n).pipe(j(e=>e.payload.docs.map(e=>t.idField?Object.assign({},e.data(),{[t.idField]:e.id}):e.data())))}get(t){return W(this.query.get(t)).pipe(y_(this.afs.scheduler.zone))}add(t){return this.ref.add(t)}doc(t){return new b_(this.ref.doc(t),this.afs)}}class b_{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=M_(n,e);return new __(r,i,this.afs)}snapshotChanges(){const t=u_(this.ref).pipe(j(t=>({payload:t,type:"value"}))),e=this.afs.scheduler.runOutsideAngular(t);return this.afs.scheduler.keepUnstableUntilFirst(e)}valueChanges(){return this.snapshotChanges().pipe(j(t=>t.payload.data()))}get(t){return W(this.ref.get(t)).pipe(y_(this.afs.scheduler.zone))}}class w_{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(h_(this.query))).pipe(j(e=>e.filter(e=>t.indexOf(e.type)>-1)),al(t=>t.length>0)):this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(h_(this.query)))}auditTrail(t){return this.stateChanges(t).pipe(Fl((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=v_(t),n=d_(this.query,e),r=this.afs.scheduler.runOutsideAngular(n);return this.afs.scheduler.keepUnstableUntilFirst(r)}valueChanges(){const t=c_(this.query),e=this.afs.scheduler.runOutsideAngular(t);return this.afs.scheduler.keepUnstableUntilFirst(e).pipe(j(t=>t.payload.docs.map(t=>t.data())))}get(t){return W(this.query.get(t)).pipe(y_(this.afs.scheduler.zone))}}var E_,S_=n("Wcq6"),C_=n.n(S_);const T_=new xt("angularfire2.app.options"),I_=new xt("angularfire2.app.nameOrConfig");class x_{}function A_(t,e){const n="object"==typeof e&&e||{};return n.name=n.name||"string"==typeof e&&e||"[DEFAULT]",C_.a.apps.filter(t=>t&&t.name===n.name)[0]||C_.a.initializeApp(t,n)}let k_=E_=class{static initializeApp(t,e){return{ngModule:E_,providers:[{provide:T_,useValue:t},{provide:I_,useValue:e}]}}};const D_=new xt("angularfire2.enableFirestorePersistence"),N_=new xt("angularfire2.firestore.persistenceSettings"),R_=new xt("angularfire2.firestore.settings"),O_=parseInt(C_.a.SDK_VERSION.split(".")[0]),P_=O_<5||5==O_&&parseInt(C_.a.SDK_VERSION.split(".")[1])<8?{timestampsInSnapshots:!0}:{};function M_(t,e=(t=>t)){return{query:e(t),ref:t}}let L_=class{constructor(t,e,n,r,i,o,s){this.scheduler=new g_(o,i),this.firestore=o.runOutsideAngular(()=>{const n=A_(t,e).firestore();return n.settings(r||P_),n}),this.persistenceEnabled$=n&&!Ha(i)?o.runOutsideAngular(()=>{try{return W(this.firestore.enablePersistence(s||void 0).then(()=>!0,()=>!1))}catch(t){return Za(!1)}}):Za(!1)}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=M_(n,e);return new __(r,i,this)}collectionGroup(t,e){if(O_<6)throw"collection group queries require Firebase JS SDK >= 6.0";const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new w_(n(r),this)}doc(t){let e;return e="string"==typeof t?this.firestore.doc(t):t,new b_(e,this)}createId(){return this.firestore.collection("_").doc().id}},F_=(()=>{class t{constructor(t){this.firestore=t}getMembers(t){return this.firestore.collection("members",e=>e.where("name","==",t)).valueChanges()}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(L_))},token:t,providedIn:"root"}),t})();function V_(){throw Error("Host already has a portal attached")}class B_{attach(t){return null==t&&function(){throw Error("Attempting to attach a portal to a null PortalOutlet")}(),t.hasAttached()&&V_(),this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null==t?function(){throw Error("Attempting to detach a portal that is not attached to a host")}():(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class U_ extends B_{constructor(t,e,n,r){super(),this.component=t,this.viewContainerRef=e,this.injector=n,this.componentFactoryResolver=r}}class q_ extends B_{constructor(t,e,n){super(),this.templateRef=t,this.viewContainerRef=e,this.context=n}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class j_{constructor(){this._isDisposed=!1}hasAttached(){return!!this._attachedPortal}attach(t){return t||function(){throw Error("Must provide a portal to attach")}(),this.hasAttached()&&V_(),this._isDisposed&&function(){throw Error("This PortalOutlet has already been disposed")}(),t instanceof U_?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof q_?(this._attachedPortal=t,this.attachTemplatePortal(t)):void function(){throw Error("Attempting to attach an unknown Portal type. BasePortalOutlet accepts either a ComponentPortal or a TemplatePortal.")}()}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class z_ extends j_{constructor(t,e,n,r){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=n,this._defaultInjector=r}attachComponentPortal(t){const e=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let n;return t.viewContainerRef?(n=t.viewContainerRef.createComponent(e,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector),this.setDisposeFn(()=>n.destroy())):(n=e.create(t.injector||this._defaultInjector),this._appRef.attachView(n.hostView),this.setDisposeFn(()=>{this._appRef.detachView(n.hostView),n.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(n)),n}attachTemplatePortal(t){let e=t.viewContainerRef,n=e.createEmbeddedView(t.templateRef,t.context);return n.detectChanges(),n.rootNodes.forEach(t=>this.outletElement.appendChild(t)),this.setDisposeFn(()=>{let t=e.indexOf(n);-1!==t&&e.remove(t)}),n}dispose(){super.dispose(),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}class Q_ extends j_{constructor(t,e){super(),this._componentFactoryResolver=t,this._viewContainerRef=e,this._isInitialized=!1,this.attached=new Pi}get portal(){return this._attachedPortal}set portal(t){(!this.hasAttached()||t||this._isInitialized)&&(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(t){t.setAttachedHost(this);const e=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,n=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),r=e.createComponent(n,e.length,t.injector||e.injector);return super.setDisposeFn(()=>r.destroy()),this._attachedPortal=t,this._attachedRef=r,this.attached.emit(r),r}attachTemplatePortal(t){t.setAttachedHost(this);const e=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=e,this.attached.emit(e),e}}class H_{}class W_{constructor(t,e){this._parentInjector=t,this._customTokens=e}get(t,e){const n=this._customTokens.get(t);return void 0!==n?n:this._parentInjector.get(t,e)}}const G_=20;let K_=(()=>{class t{constructor(t,e){this._ngZone=t,this._platform=e,this._scrolled=new x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const e=this.scrollContainers.get(t);e&&(e.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=G_){return this._platform.isBrowser?new w(e=>{this._globalSubscription||this._addGlobalListener();const n=t>0?this._scrolled.pipe(Qv(t)).subscribe(e):this._scrolled.subscribe(e);return this._scrolledCount++,()=>{n.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Za()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,e)=>this.deregister(e)),this._scrolled.complete()}ancestorScrolled(t,e){const n=this.getAncestorScrollContainers(t);return this.scrolled(e).pipe(al(t=>!t||n.indexOf(t)>-1))}getAncestorScrollContainers(t){const e=[];return this.scrollContainers.forEach((n,r)=>{this._scrollableContainsElement(r,t)&&e.push(r)}),e}_scrollableContainsElement(t,e){let n=e.nativeElement,r=t.getElementRef().nativeElement;do{if(n==r)return!0}while(n=n.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>ep(window.document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(uo),Bt(mf))},token:t,providedIn:"root"}),t})();class $_{}const Y_=20;let Z_=(()=>{class t{constructor(t,e){this._platform=t,e.runOutsideAngular(()=>{this._change=t.isBrowser?X(ep(window,"resize"),ep(window,"orientationchange")):Za(),this._invalidateCache=this.change().subscribe(()=>this._updateViewportSize())})}ngOnDestroy(){this._invalidateCache.unsubscribe()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:e,height:n}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+n,right:t.left+e,height:n,width:e}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=document.documentElement,e=t.getBoundingClientRect();return{top:-e.top||document.body.scrollTop||window.scrollY||t.scrollTop||0,left:-e.left||document.body.scrollLeft||window.scrollX||t.scrollLeft||0}}change(t=Y_){return t>0?this._change.pipe(Qv(t)):this._change}_updateViewportSize(){this._viewportSize=this._platform.isBrowser?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0}}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(mf),Bt(uo))},token:t,providedIn:"root"}),t})();class X_{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=cf(-this._previousScrollPosition.left),t.style.top=cf(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,e=t.style,n=this._document.body.style,r=e.scrollBehavior||"",i=n.scrollBehavior||"";this._isEnabled=!1,e.left=this._previousHTMLStyles.left,e.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),e.scrollBehavior=n.scrollBehavior="auto",window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),e.scrollBehavior=r,n.scrollBehavior=i}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,e=this._viewportRuler.getViewportSize();return t.scrollHeight>e.height||t.scrollWidth>e.width}}function J_(){return Error("Scroll strategy has already been attached.")}class tb{constructor(t,e,n,r){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){if(this._overlayRef)throw J_();this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class eb{enable(){}disable(){}attach(){}}function nb(t,e){return e.some(e=>t.bottom<e.top||t.top>e.bottom||t.right<e.left||t.left>e.right)}function rb(t,e){return e.some(e=>t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right)}class ib{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(t){if(this._overlayRef)throw J_();this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:e,height:n}=this._viewportRuler.getViewportSize();nb(t,[{width:e,height:n,bottom:n,right:e,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let ob=(()=>{class t{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this.noop=()=>new eb,this.close=t=>new tb(this._scrollDispatcher,this._ngZone,this._viewportRuler,t),this.block=()=>new X_(this._viewportRuler,this._document),this.reposition=t=>new ib(this._scrollDispatcher,this._viewportRuler,this._ngZone,t),this._document=r}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(K_),Bt(Z_),Bt(uo),Bt(ja))},token:t,providedIn:"root"}),t})();class sb{constructor(t){if(this.scrollStrategy=new eb,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const n of e)void 0!==t[n]&&(this[n]=t[n])}}}class ab{constructor(t,e,n,r,i){this.offsetX=n,this.offsetY=r,this.panelClass=i,this.originX=t.originX,this.originY=t.originY,this.overlayX=e.overlayX,this.overlayY=e.overlayY}}class lb{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}function ub(t,e){if("top"!==e&&"bottom"!==e&&"center"!==e)throw Error(`ConnectedPosition: Invalid ${t} "${e}". `+'Expected "top", "bottom" or "center".')}function cb(t,e){if("start"!==e&&"end"!==e&&"center"!==e)throw Error(`ConnectedPosition: Invalid ${t} "${e}". `+'Expected "start", "end" or "center".')}let hb=(()=>{class t{constructor(t){this._attachedOverlays=[],this._keydownListener=t=>{const e=this._attachedOverlays;for(let n=e.length-1;n>-1;n--)if(e[n]._keydownEventSubscriptions>0){e[n]._keydownEvents.next(t);break}},this._document=t}ngOnDestroy(){this._detach()}add(t){this.remove(t),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0),this._attachedOverlays.push(t)}remove(t){const e=this._attachedOverlays.indexOf(t);e>-1&&this._attachedOverlays.splice(e,1),0===this._attachedOverlays.length&&this._detach()}_detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(ja))},token:t,providedIn:"root"}),t})(),db=(()=>{class t{constructor(t){this._document=t}ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t=this._document.getElementsByClassName("cdk-overlay-container");for(let n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n]);const e=this._document.createElement("div");e.classList.add("cdk-overlay-container"),this._document.body.appendChild(e),this._containerElement=e}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(ja))},token:t,providedIn:"root"}),t})();class fb{constructor(t,e,n,r,i,o,s,a){this._portalOutlet=t,this._host=e,this._pane=n,this._config=r,this._ngZone=i,this._keyboardDispatcher=o,this._document=s,this._location=a,this._backdropElement=null,this._backdropClick=new x,this._attachments=new x,this._detachments=new x,this._locationChanges=d.EMPTY,this._backdropClickHandler=t=>this._backdropClick.next(t),this._keydownEventsObservable=new w(t=>{const e=this._keydownEvents.subscribe(t);return this._keydownEventSubscriptions++,()=>{e.unsubscribe(),this._keydownEventSubscriptions--}}),this._keydownEvents=new x,this._keydownEventSubscriptions=0,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){let e=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.asObservable().pipe(Il(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&this._location&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this.detachBackdrop(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._host&&this._host.parentNode&&(this._host.parentNode.removeChild(this._host),this._host=null),this._previousHostParent=this._pane=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick.asObservable()}attachments(){return this._attachments.asObservable()}detachments(){return this._detachments.asObservable()}keydownEvents(){return this._keydownEventsObservable}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config=Object.assign({},this._config,t),this._updateElementSize()}setDirection(t){this._config=Object.assign({},this._config,{direction:t}),this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=cf(this._config.width),t.height=cf(this._config.height),t.minWidth=cf(this._config.minWidth),t.minHeight=cf(this._config.minHeight),t.maxWidth=cf(this._config.maxWidth),t.maxHeight=cf(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"auto":"none"}_attachBackdrop(){this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add("cdk-overlay-backdrop-showing")})}):this._backdropElement.classList.add("cdk-overlay-backdrop-showing")}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let t,e=this._backdropElement;if(!e)return;let n=()=>{e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",n),e.parentNode&&e.parentNode.removeChild(e)),this._backdropElement==e&&(this._backdropElement=null),this._config.backdropClass&&this._toggleClasses(e,this._config.backdropClass,!1),clearTimeout(t)};e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",n)}),e.style.pointerEvents="none",t=this._ngZone.runOutsideAngular(()=>setTimeout(n,500))}_toggleClasses(t,e,n){const r=t.classList;uf(e).forEach(t=>{n?r.add(t):r.remove(t)})}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.asObservable().pipe(np(X(this._attachments,this._detachments))).subscribe(()=>{this._pane&&this._host&&0!==this._pane.children.length||(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._previousHostParent.removeChild(this._host)),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}}const pb="cdk-overlay-connected-position-bounding-box";class mb{constructor(t,e,n,r,i){this._viewportRuler=e,this._document=n,this._platform=r,this._overlayContainer=i,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new x,this._resizeSubscription=d.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges.asObservable(),this.setOrigin(t)}get positions(){return this._preferredPositions}attach(t){if(this._overlayRef&&t!==this._overlayRef)throw Error("This position strategy is already attached to an overlay");this._validatePositions(),t.hostElement.classList.add(pb),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();const t=this._originRect,e=this._overlayRect,n=this._viewportRect,r=[];let i;for(let o of this._preferredPositions){let s=this._getOriginPoint(t,o),a=this._getOverlayPoint(s,e,o),l=this._getOverlayFit(a,e,n,o);if(l.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(o,s);this._canFitWithFlexibleDimensions(l,a,n)?r.push({position:o,origin:s,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(s,o)}):(!i||i.overlayFit.visibleArea<l.visibleArea)&&(i={overlayFit:l,overlayPoint:a,originPoint:s,position:o,overlayRect:e})}if(r.length){let t=null,e=-1;for(const n of r){const r=n.boundingBoxRect.width*n.boundingBoxRect.height*(n.position.weight||1);r>e&&(e=r,t=n)}return this._isPushed=!1,void this._applyPosition(t.position,t.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(i.position,i.originPoint);this._applyPosition(i.position,i.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&gb(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(pb),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();const t=this._lastPosition||this._preferredPositions[0],e=this._getOriginPoint(this._originRect,t);this._applyPosition(t,e)}}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e){let n,r;if("center"==e.originX)n=t.left+t.width/2;else{const r=this._isRtl()?t.right:t.left,i=this._isRtl()?t.left:t.right;n="start"==e.originX?r:i}return{x:n,y:r="center"==e.originY?t.top+t.height/2:"top"==e.originY?t.top:t.bottom}}_getOverlayPoint(t,e,n){let r,i;return r="center"==n.overlayX?-e.width/2:"start"===n.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,{x:t.x+r,y:t.y+(i="center"==n.overlayY?-e.height/2:"top"==n.overlayY?0:-e.height)}}_getOverlayFit(t,e,n,r){let{x:i,y:o}=t,s=this._getOffset(r,"x"),a=this._getOffset(r,"y");s&&(i+=s),a&&(o+=a);let l=0-o,u=o+e.height-n.height,c=this._subtractOverflows(e.width,0-i,i+e.width-n.width),h=this._subtractOverflows(e.height,l,u),d=c*h;return{visibleArea:d,isCompletelyWithinViewport:e.width*e.height===d,fitsInViewportVertically:h===e.height,fitsInViewportHorizontally:c==e.width}}_canFitWithFlexibleDimensions(t,e,n){if(this._hasFlexibleDimensions){const r=n.bottom-e.y,i=n.right-e.x,o=this._overlayRef.getConfig().minHeight,s=this._overlayRef.getConfig().minWidth,a=t.fitsInViewportHorizontally||null!=s&&s<=i;return(t.fitsInViewportVertically||null!=o&&o<=r)&&a}return!1}_pushOverlayOnScreen(t,e,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const r=this._viewportRect,i=Math.max(t.x+e.width-r.right,0),o=Math.max(t.y+e.height-r.bottom,0),s=Math.max(r.top-n.top-t.y,0),a=Math.max(r.left-n.left-t.x,0);let l=0,u=0;return this._previousPushAmount={x:l=e.width<=r.width?a||-i:t.x<this._viewportMargin?r.left-n.left-t.x:0,y:u=e.height<=r.height?s||-o:t.y<this._viewportMargin?r.top-n.top-t.y:0},{x:t.x+l,y:t.y+u}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const e=this._getScrollVisibility(),n=new lb(t,e);this._positionChanges.next(n)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,r=t.overlayY;n="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let i=0;i<e.length;i++)e[i].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(t,e){const n=this._viewportRect,r=this._isRtl();let i,o,s,a,l,u;if("top"===e.overlayY)i=n.height-(o=t.y)+this._viewportMargin;else if("bottom"===e.overlayY)i=n.height-(s=n.height-t.y+2*this._viewportMargin)+this._viewportMargin;else{const e=Math.min(n.bottom-t.y+n.top,t.y),r=this._lastBoundingBoxSize.height;o=t.y-e,(i=2*e)>r&&!this._isInitialRender&&!this._growAfterOpen&&(o=t.y-r/2)}if("end"===e.overlayX&&!r||"start"===e.overlayX&&r)u=n.width-t.x+this._viewportMargin,a=t.x-this._viewportMargin;else if("start"===e.overlayX&&!r||"end"===e.overlayX&&r)l=t.x,a=n.right-t.x;else{const e=Math.min(n.right-t.x+n.left,t.x),r=this._lastBoundingBoxSize.width;l=t.x-e,(a=2*e)>r&&!this._isInitialRender&&!this._growAfterOpen&&(l=t.x-r/2)}return{top:o,left:l,bottom:s,right:u,width:a,height:i}}_setBoundingBoxStyles(t,e){const n=this._calculateBoundingBoxRect(t,e);this._isInitialRender||this._growAfterOpen||(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right="",r.width=r.height="100%";else{const t=this._overlayRef.getConfig().maxHeight,i=this._overlayRef.getConfig().maxWidth;r.height=cf(n.height),r.top=cf(n.top),r.bottom=cf(n.bottom),r.width=cf(n.width),r.left=cf(n.left),r.right=cf(n.right),r.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",r.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",t&&(r.maxHeight=cf(t)),i&&(r.maxWidth=cf(i))}this._lastBoundingBoxSize=n,gb(this._boundingBox.style,r)}_resetBoundingBoxStyles(){gb(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){gb(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const n={};if(this._hasExactPosition()){const r=this._viewportRuler.getViewportScrollPosition();gb(n,this._getExactOverlayY(e,t,r)),gb(n,this._getExactOverlayX(e,t,r))}else n.position="static";let r="",i=this._getOffset(e,"x"),o=this._getOffset(e,"y");i&&(r+=`translateX(${i}px) `),o&&(r+=`translateY(${o}px)`),n.transform=r.trim(),this._hasFlexibleDimensions&&this._overlayRef.getConfig().maxHeight&&(n.maxHeight=""),this._hasFlexibleDimensions&&this._overlayRef.getConfig().maxWidth&&(n.maxWidth=""),gb(this._pane.style,n)}_getExactOverlayY(t,e,n){let r={top:null,bottom:null},i=this._getOverlayPoint(e,this._overlayRect,t);this._isPushed&&(i=this._pushOverlayOnScreen(i,this._overlayRect,n));let o=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return i.y-=o,"bottom"===t.overlayY?r.bottom=`${this._document.documentElement.clientHeight-(i.y+this._overlayRect.height)}px`:r.top=cf(i.y),r}_getExactOverlayX(t,e,n){let r,i={left:null,right:null},o=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,n)),"right"==(r=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left")?i.right=`${this._document.documentElement.clientWidth-(o.x+this._overlayRect.width)}px`:i.left=cf(o.x),i}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),n=this._scrollables.map(t=>t.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:rb(t,n),isOriginOutsideView:nb(t,n),isOverlayClipped:rb(e,n),isOverlayOutsideView:nb(e,n)}}_subtractOverflows(t,...e){return e.reduce((t,e)=>t-Math.max(e,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){if(!this._preferredPositions.length)throw Error("FlexibleConnectedPositionStrategy: At least one position is required.");this._preferredPositions.forEach(t=>{cb("originX",t.originX),ub("originY",t.originY),cb("overlayX",t.overlayX),ub("overlayY",t.overlayY)})}_addPanelClasses(t){this._pane&&uf(t).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;return t instanceof dn?t.nativeElement.getBoundingClientRect():t instanceof HTMLElement?t.getBoundingClientRect():{top:t.y,bottom:t.y,left:t.x,right:t.x,height:0,width:0}}}function gb(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}class yb{constructor(t,e,n,r,i,o,s){this._preferredPositions=[],this._positionStrategy=new mb(n,r,i,o,s).withFlexibleDimensions(!1).withPush(!1).withViewportMargin(0),this.withFallbackPosition(t,e)}get _isRtl(){return"rtl"===this._overlayRef.getDirection()}get onPositionChange(){return this._positionStrategy.positionChanges}get positions(){return this._preferredPositions}attach(t){this._overlayRef=t,this._positionStrategy.attach(t),this._direction&&(t.setDirection(this._direction),this._direction=null)}dispose(){this._positionStrategy.dispose()}detach(){this._positionStrategy.detach()}apply(){this._positionStrategy.apply()}recalculateLastPosition(){this._positionStrategy.reapplyLastPosition()}withScrollableContainers(t){this._positionStrategy.withScrollableContainers(t)}withFallbackPosition(t,e,n,r){const i=new ab(t,e,n,r);return this._preferredPositions.push(i),this._positionStrategy.withPositions(this._preferredPositions),this}withDirection(t){return this._overlayRef?this._overlayRef.setDirection(t):this._direction=t,this}withOffsetX(t){return this._positionStrategy.withDefaultOffsetX(t),this}withOffsetY(t){return this._positionStrategy.withDefaultOffsetY(t),this}withLockedPosition(t){return this._positionStrategy.withLockedPosition(t),this}withPositions(t){return this._preferredPositions=t.slice(),this._positionStrategy.withPositions(this._preferredPositions),this}setOrigin(t){return this._positionStrategy.setOrigin(t),this}}const vb="cdk-global-overlay-wrapper";class _b{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(vb),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._rightOffset="",this._leftOffset=t,this._justifyContent="flex-start",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._leftOffset="",this._rightOffset=t,this._justifyContent="flex-end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._justifyContent="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig();t.position=this._cssPosition,t.marginLeft="100%"===n.width?"0":this._leftOffset,t.marginTop="100%"===n.height?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=this._rightOffset,"100%"===n.width?e.justifyContent="flex-start":"center"===this._justifyContent?e.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?e.justifyContent="flex-end":"flex-end"===this._justifyContent&&(e.justifyContent="flex-start"):e.justifyContent=this._justifyContent,e.alignItems="100%"===n.height?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,n=e.style;e.classList.remove(vb),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let bb=(()=>{class t{constructor(t,e,n,r){this._viewportRuler=t,this._document=e,this._platform=n,this._overlayContainer=r}global(){return new _b}connectedTo(t,e,n){return new yb(e,n,t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}flexibleConnectedTo(t){return new mb(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(Z_),Bt(ja),Bt(mf),Bt(db))},token:t,providedIn:"root"}),t})(),wb=0;class Eb{constructor(t,e,n,r,i,o,s,a,l,u){this.scrollStrategies=t,this._overlayContainer=e,this._componentFactoryResolver=n,this._positionBuilder=r,this._keyboardDispatcher=i,this._injector=o,this._ngZone=s,this._document=a,this._directionality=l,this._location=u}create(t){const e=this._createHostElement(),n=this._createPaneElement(e),r=this._createPortalOutlet(n),i=new sb(t);return i.direction=i.direction||this._directionality.value,new fb(r,e,n,i,this._ngZone,this._keyboardDispatcher,this._document,this._location)}position(){return this._positionBuilder}_createPaneElement(t){const e=this._document.createElement("div");return e.id=`cdk-overlay-${wb++}`,e.classList.add("cdk-overlay-pane"),t.appendChild(e),e}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(Do)),new z_(t,this._componentFactoryResolver,this._appRef,this._injector)}}const Sb=new xt("cdk-connected-overlay-scroll-strategy");function Cb(t){return()=>t.scrollStrategies.reposition()}class Tb{}class Ib{constructor(t){this.total=t}call(t,e){return e.subscribe(new xb(t,this.total))}}class xb extends m{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){++this.count>this.total&&this.destination.next(t)}}const Ab=new Set;let kb,Db=(()=>{class t{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Nb}matchMedia(t){return this._platform.WEBKIT&&function(t){if(!Ab.has(t))try{kb||((kb=document.createElement("style")).setAttribute("type","text/css"),document.head.appendChild(kb)),kb.sheet&&(kb.sheet.insertRule(`@media ${t} {.fx-query-test{ }}`,0),Ab.add(t))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(mf))},token:t,providedIn:"root"}),t})();function Nb(t){return{matches:"all"===t||""===t,media:t,addListener:()=>{},removeListener:()=>{}}}let Rb=(()=>{class t{constructor(t,e){this._mediaMatcher=t,this._zone=e,this._queries=new Map,this._destroySubject=new x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return Ob(uf(t)).some(t=>this._registerQuery(t).mql.matches)}observe(t){let e=nl(Ob(uf(t)).map(t=>this._registerQuery(t).observable));return(e=Ml(e.pipe(Il(1)),e.pipe(t=>t.lift(new Ib(1)),If(0)))).pipe(j(t=>{const e={matches:!1,breakpoints:{}};return t.forEach(t=>{e.matches=e.matches||t.matches,e.breakpoints[t.query]=t.matches}),e}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const e=this._mediaMatcher.matchMedia(t),n={observable:new w(t=>{const n=e=>this._zone.run(()=>t.next(e));return e.addListener(n),()=>{e.removeListener(n)}}).pipe(Ll(e),j(e=>({query:t,matches:e.matches})),np(this._destroySubject)),mql:e};return this._queries.set(t,n),n}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(Db),Bt(uo))},token:t,providedIn:"root"}),t})();function Ob(t){return t.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}const Pb={XSmall:"(max-width: 599.99px)",Small:"(min-width: 600px) and (max-width: 959.99px)",Medium:"(min-width: 960px) and (max-width: 1279.99px)",Large:"(min-width: 1280px) and (max-width: 1919.99px)",XLarge:"(min-width: 1920px)",Handset:"(max-width: 599.99px) and (orientation: portrait), (max-width: 959.99px) and (orientation: landscape)",Tablet:"(min-width: 600px) and (max-width: 839.99px) and (orientation: portrait), (min-width: 960px) and (max-width: 1279.99px) and (orientation: landscape)",Web:"(min-width: 840px) and (orientation: portrait), (min-width: 1280px) and (orientation: landscape)",HandsetPortrait:"(max-width: 599.99px) and (orientation: portrait)",TabletPortrait:"(min-width: 600px) and (max-width: 839.99px) and (orientation: portrait)",WebPortrait:"(min-width: 840px) and (orientation: portrait)",HandsetLandscape:"(max-width: 959.99px) and (orientation: landscape)",TabletLandscape:"(min-width: 960px) and (max-width: 1279.99px) and (orientation: landscape)",WebLandscape:"(min-width: 1280px) and (orientation: landscape)"};class Mb{constructor(t,e){this._overlayRef=e,this._afterDismissed=new x,this._afterOpened=new x,this._onAction=new x,this._dismissedByAction=!1,this.containerInstance=t,this.onAction().subscribe(()=>this.dismiss()),t._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete())}closeWithAction(){this.dismissWithAction()}_dismissAfter(t){this._durationTimeoutId=setTimeout(()=>this.dismiss(),t)}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed.asObservable()}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction.asObservable()}}const Lb=new xt("MatSnackBarData");class Fb{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}class Vb{constructor(t,e){this.snackBarRef=t,this.data=e}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}}class Bb extends j_{constructor(t,e,n,r){super(),this._ngZone=t,this._elementRef=e,this._changeDetectorRef=n,this.snackBarConfig=r,this._destroyed=!1,this._onExit=new x,this._onEnter=new x,this._animationState="void",this._role="assertive"!==r.politeness||r.announcementMessage?"off"===r.politeness?null:"status":"alert"}attachComponentPortal(t){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachComponentPortal(t)}attachTemplatePortal(t){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachTemplatePortal(t)}onAnimationEnd(t){const{fromState:e,toState:n}=t;if(("void"===n&&"void"!==e||"hidden"===n)&&this._completeExit(),"visible"===n){const t=this._onEnter;this._ngZone.run(()=>{t.next(),t.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges())}exit(){return this._animationState="hidden",this._onExit}ngOnDestroy(){this._destroyed=!0,this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.asObservable().pipe(Il(1)).subscribe(()=>{this._onExit.next(),this._onExit.complete()})}_applySnackBarClasses(){const t=this._elementRef.nativeElement,e=this.snackBarConfig.panelClass;e&&(Array.isArray(e)?e.forEach(e=>t.classList.add(e)):t.classList.add(e)),"center"===this.snackBarConfig.horizontalPosition&&t.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&t.classList.add("mat-snack-bar-top")}_assertNotAttached(){if(this._portalOutlet.hasAttached())throw Error("Attempting to attach snack bar content after content is already attached")}}class Ub{}const qb=new xt("mat-snack-bar-default-options",{providedIn:"root",factory:function(){return new Fb}});let jb=(()=>{class t{constructor(t,e,n,r,i,o){this._overlay=t,this._live=e,this._injector=n,this._breakpointObserver=r,this._parentSnackBar=i,this._defaultConfig=o,this._snackBarRefAtThisLevel=null}get _openedSnackBarRef(){const t=this._parentSnackBar;return t?t._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(t){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=t:this._snackBarRefAtThisLevel=t}openFromComponent(t,e){return this._attach(t,e)}openFromTemplate(t,e){return this._attach(t,e)}open(t,e="",n){const r=Object.assign({},this._defaultConfig,n);return r.data={message:t,action:e},r.announcementMessage||(r.announcementMessage=t),this.openFromComponent(Vb,r)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(t,e){const n=new W_(e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,new WeakMap([[Fb,e]])),r=new U_(Bb,e.viewContainerRef,n),i=t.attach(r);return i.instance.snackBarConfig=e,i.instance}_attach(t,e){const n=Object.assign({},new Fb,this._defaultConfig,e),r=this._createOverlay(n),i=this._attachSnackBarContainer(r,n),o=new Mb(i,r);if(t instanceof Ln){const e=new q_(t,null,{$implicit:n.data,snackBarRef:o});o.instance=i.attachTemplatePortal(e)}else{const e=this._createInjector(n,o),r=new U_(t,void 0,e),s=i.attachComponentPortal(r);o.instance=s.instance}return this._breakpointObserver.observe(Pb.Handset).pipe(np(r.detachments().pipe(Il(1)))).subscribe(t=>{t.matches?r.overlayElement.classList.add("mat-snack-bar-handset"):r.overlayElement.classList.remove("mat-snack-bar-handset")}),this._animateSnackBar(o,n),this._openedSnackBarRef=o,this._openedSnackBarRef}_animateSnackBar(t,e){t.afterDismissed().subscribe(()=>{this._openedSnackBarRef==t&&(this._openedSnackBarRef=null),e.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{t.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):t.containerInstance.enter(),e.duration&&e.duration>0&&t.afterOpened().subscribe(()=>t._dismissAfter(e.duration)),e.announcementMessage&&this._live.announce(e.announcementMessage,e.politeness)}_createOverlay(t){const e=new sb;e.direction=t.direction;let n=this._overlay.position().global();const r="rtl"===t.direction,i="left"===t.horizontalPosition||"start"===t.horizontalPosition&&!r||"end"===t.horizontalPosition&&r,o=!i&&"center"!==t.horizontalPosition;return i?n.left("0"):o?n.right("0"):n.centerHorizontally(),"top"===t.verticalPosition?n.top("0"):n.bottom("0"),e.positionStrategy=n,this._overlay.create(e)}_createInjector(t,e){return new W_(t&&t.viewContainerRef&&t.viewContainerRef.injector||this._injector,new WeakMap([[Mb,e],[Lb,t.data]]))}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(Eb),Bt(Rf),Bt(At),Bt(Rb),Bt(t,12),Bt(qb))},token:t,providedIn:Ub}),t})();var zb=nr({encapsulation:0,styles:[['.authentication-container[_ngcontent-%COMP%]{display:flex;width:100vw;height:100vh;background:#d31027;background:linear-gradient(to right,#d31027,#ea384d)}.authentication-container__form[_ngcontent-%COMP%]{align-self:center;margin-left:auto;margin-right:auto}.authentication-container__form__card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;padding:30px}.authentication-container__form__card__logo[_ngcontent-%COMP%]{width:30vw;height:20vh}.authentication-container__form__card__button[_ngcontent-%COMP%], .authentication-container__form__card__input[_ngcontent-%COMP%], .authentication-container__form__card__title[_ngcontent-%COMP%]{font-family:"Gloria Hallelujah",cursive}.authentication-container__form__card__title[_ngcontent-%COMP%]{font-size:24px}']],data:{}});function Qb(t){return fs(0,[(t()(),Xo(0,0,null,null,4,"mat-error",[["class","mat-error"],["role","alert"]],[[1,"id",0]],null,null,null,null)),ci(1,16384,null,0,sp,[],null,null),(t()(),cs(-1,null,[" Usuario "])),(t()(),Xo(3,0,null,null,1,"strong",[],null,null,null,null,null)),(t()(),cs(-1,null,["requerido"]))],null,function(t,e){t(e,0,0,Zr(e,1).id)})}function Hb(t){return fs(0,[(t()(),Xo(0,0,null,null,41,"div",[["class","authentication-container"]],null,null,null,null,null)),(t()(),Xo(1,0,null,null,40,"form",[["class","authentication-container__form"],["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],function(t,e,n){var r=!0,i=t.component;return"submit"===e&&(r=!1!==Zr(t,3).onSubmit(n)&&r),"reset"===e&&(r=!1!==Zr(t,3).onReset()&&r),"ngSubmit"===e&&(r=!1!==i.onSubmit()&&r),r},null,null)),ci(2,16384,null,0,cm,[],null,null),ci(3,540672,null,0,dm,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),hi(2048,null,Ep,null,[dm]),ci(5,16384,null,0,xp,[[4,Ep]],null,null),(t()(),Xo(6,0,null,null,35,"mat-card",[["class","authentication-container__form__card mat-card"]],[[2,"_mat-animation-noopable",null]],null,null,bv,_v)),ci(7,49152,null,0,Sm,[[2,yv]],null,null),(t()(),Xo(8,0,null,0,0,"img",[["class","authentication-container__form__card__logo"],["src","../../assets/love.svg"]],null,null,null,null,null)),(t()(),Xo(9,0,null,0,4,"mat-card-header",[["class","mat-card-header"]],null,null,null,Ev,wv)),ci(10,49152,null,0,Cm,[],null,null),(t()(),Xo(11,0,null,1,2,"mat-card-title",[["class","authentication-container__form__card__title mat-card-title"]],null,null,null,null,null)),ci(12,16384,null,0,wm,[],null,null),(t()(),cs(-1,null,["Love & Friendship"])),(t()(),Xo(14,0,null,0,22,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),ci(15,16384,null,0,bm,[],null,null),(t()(),Xo(16,0,null,null,18,"mat-form-field",[["class","authentication-container__form__card__input mat-form-field"]],[[2,"mat-form-field-appearance-standard",null],[2,"mat-form-field-appearance-fill",null],[2,"mat-form-field-appearance-outline",null],[2,"mat-form-field-appearance-legacy",null],[2,"mat-form-field-invalid",null],[2,"mat-form-field-can-float",null],[2,"mat-form-field-should-float",null],[2,"mat-form-field-has-label",null],[2,"mat-form-field-hide-placeholder",null],[2,"mat-form-field-disabled",null],[2,"mat-form-field-autofilled",null],[2,"mat-focused",null],[2,"mat-accent",null],[2,"mat-warn",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null],[2,"_mat-animation-noopable",null]],null,null,Bv,xv)),ci(17,7520256,null,9,mp,[dn,Re,[2,tp],[2,xm],[2,pp],mf,uo,[2,yv]],null,null),rs(603979776,1,{_controlNonStatic:0}),rs(335544320,2,{_controlStatic:0}),rs(603979776,3,{_labelChildNonStatic:0}),rs(335544320,4,{_labelChildStatic:0}),rs(603979776,5,{_placeholderChild:0}),rs(603979776,6,{_errorChildren:1}),rs(603979776,7,{_hintChildren:1}),rs(603979776,8,{_prefixChildren:1}),rs(603979776,9,{_suffixChildren:1}),(t()(),Xo(27,0,null,1,7,"input",[["class","mat-input-element mat-form-field-autofill-control"],["formControlName","member"],["matInput",""],["placeholder","Ingresar Usuario"]],[[2,"mat-input-server",null],[1,"id",0],[1,"placeholder",0],[8,"disabled",0],[8,"required",0],[1,"readonly",0],[1,"aria-describedby",0],[1,"aria-invalid",0],[1,"aria-required",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"focus"]],function(t,e,n){var r=!0;return"input"===e&&(r=!1!==Zr(t,28)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==Zr(t,28).onTouched()&&r),"compositionstart"===e&&(r=!1!==Zr(t,28)._compositionStart()&&r),"compositionend"===e&&(r=!1!==Zr(t,28)._compositionEnd(n.target.value)&&r),"blur"===e&&(r=!1!==Zr(t,32)._focusChanged(!1)&&r),"focus"===e&&(r=!1!==Zr(t,32)._focusChanged(!0)&&r),"input"===e&&(r=!1!==Zr(t,32)._onInput()&&r),r},null,null)),ci(28,16384,null,0,bp,[yn,dn,[2,_p]],null,null),hi(1024,null,vp,function(t){return[t]},[bp]),ci(30,671744,null,0,gm,[[3,Ep],[8,null],[8,null],[6,vp],[2,hm]],{name:[0,"name"]},null),hi(2048,null,Cp,null,[gm]),ci(32,999424,null,0,Xv,[dn,mf,[6,Cp],[2,lm],[2,dm],Qf,[8,null],Wv,uo],{placeholder:[0,"placeholder"]},null),ci(33,16384,null,0,Ip,[[4,Cp]],null,null),hi(2048,[[1,4],[2,4]],ap,null,[Xv]),(t()(),Zo(16777216,null,null,1,null,Qb)),ci(36,16384,null,0,Ma,[Vn,Ln],{ngIf:[0,"ngIf"]},null),(t()(),Xo(37,0,null,0,4,"mat-card-actions",[["class","mat-card-actions"]],[[2,"mat-card-actions-align-end",null]],null,null,null,null)),ci(38,16384,null,0,Em,[],null,null),(t()(),Xo(39,0,null,null,2,"button",[["class","authentication-container__form__card__button"],["color","warn"],["mat-raised-button",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],null,null,a_,s_)),ci(40,180224,null,0,i_,[dn,Mf,[2,yv]],{disabled:[0,"disabled"],color:[1,"color"]},null),(t()(),cs(-1,0,["Ingresar"]))],function(t,e){var n=e.component;t(e,3,0,n.authForm),t(e,30,0,"member"),t(e,32,0,"Ingresar Usuario"),t(e,36,0,n.authForm.controls.member.dirty&&n.authForm.controls.member.hasError("required")),t(e,40,0,!n.authForm.valid,"warn")},function(t,e){t(e,1,0,Zr(e,5).ngClassUntouched,Zr(e,5).ngClassTouched,Zr(e,5).ngClassPristine,Zr(e,5).ngClassDirty,Zr(e,5).ngClassValid,Zr(e,5).ngClassInvalid,Zr(e,5).ngClassPending),t(e,6,0,"NoopAnimations"===Zr(e,7)._animationMode),t(e,16,1,["standard"==Zr(e,17).appearance,"fill"==Zr(e,17).appearance,"outline"==Zr(e,17).appearance,"legacy"==Zr(e,17).appearance,Zr(e,17)._control.errorState,Zr(e,17)._canLabelFloat,Zr(e,17)._shouldLabelFloat(),Zr(e,17)._hasFloatingLabel(),Zr(e,17)._hideControlPlaceholder(),Zr(e,17)._control.disabled,Zr(e,17)._control.autofilled,Zr(e,17)._control.focused,"accent"==Zr(e,17).color,"warn"==Zr(e,17).color,Zr(e,17)._shouldForward("untouched"),Zr(e,17)._shouldForward("touched"),Zr(e,17)._shouldForward("pristine"),Zr(e,17)._shouldForward("dirty"),Zr(e,17)._shouldForward("valid"),Zr(e,17)._shouldForward("invalid"),Zr(e,17)._shouldForward("pending"),!Zr(e,17)._animationsEnabled]),t(e,27,1,[Zr(e,32)._isServer,Zr(e,32).id,Zr(e,32).placeholder,Zr(e,32).disabled,Zr(e,32).required,Zr(e,32).readonly&&!Zr(e,32)._isNativeSelect||null,Zr(e,32)._ariaDescribedby||null,Zr(e,32).errorState,Zr(e,32).required.toString(),Zr(e,33).ngClassUntouched,Zr(e,33).ngClassTouched,Zr(e,33).ngClassPristine,Zr(e,33).ngClassDirty,Zr(e,33).ngClassValid,Zr(e,33).ngClassInvalid,Zr(e,33).ngClassPending]),t(e,37,0,"end"===Zr(e,38).align),t(e,39,0,Zr(e,40).disabled||null,"NoopAnimations"===Zr(e,40)._animationMode)})}function Wb(t){return fs(0,[(t()(),Xo(0,0,null,null,1,"app-authentication",[],null,null,null,Hb,zb)),ci(1,114688,null,0,l_,[F_,vm,jb,Sd],null,null)],function(t,e){t(e,1,0)},null)}var Gb=Ur("app-authentication",l_,Wb,{},{},[]);class Kb{constructor(t,e,n,r){this.activatedRoute=t,this.paper=e,this.auth=n,this.router=r,this.alreadyGenerated=!1,this.generatedPaper=!1}ngOnInit(){this.member=this.activatedRoute.snapshot.params.member,this.validateMember(this.member)}validateMember(t){this.auth.getMembers(t).pipe(Il(1)).subscribe(t=>{0===t.length?this.router.navigate(["auth"]):this.getMembers(this.member)})}getMembers(t){this.paper.getMemberPaper(t).pipe(Il(1)).subscribe(t=>(this.alreadyGenerated=t.length>0,t))}updatePaper(){this.validateMember(this.member),setTimeout(()=>{this.alreadyGenerated||this.paper.getAvailablePapers(this.member).pipe(Il(1)).subscribe(t=>{console.log("generatedPaper",this.generatedPaper),this.generatedPaper||(this.takePaper(t),this.generatedPaper=!0)})},1e3)}takePaper(t){const e=t[Math.floor(Math.random()*t.length+1)-1];console.log(e),this.paper.updatePaper(this.member,e).then(t=>{this.paperName=e.payload.doc.data().paper,this.generatedPaper=!0,console.log("generatedPaperfwef",this.generatedPaper)},t=>{console.log("error",t),this.generatedPaper=!1})}}let $b=(()=>{class t{constructor(t){this.firestore=t}getMemberPaper(t){return this.firestore.collection("papersSorted",e=>e.where("member","==",t)).valueChanges()}getAvailablePapers(t){return this.firestore.collection("papersSorted",t=>t.where("choosen","==",!1)).snapshotChanges().pipe(j(e=>e.map(e=>{if(e.payload.doc.data().member!==t)return e})))}updatePaper(t,e){return this.firestore.collection("papersSorted").doc(e.payload.doc.id).set({member:t,choosen:!0},{merge:!0})}}return t.ngInjectableDef=mt({factory:function(){return new t(Bt(L_))},token:t,providedIn:"root"}),t})();var Yb=nr({encapsulation:0,styles:[['.home-container[_ngcontent-%COMP%]{display:flex;width:100vw;height:100vh;background:#d31027;background:linear-gradient(to right,#d31027,#ea384d)}.home-container__form[_ngcontent-%COMP%]{align-self:center;margin-left:auto;margin-right:auto}.home-container__form__card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;padding:30px}.home-container__form__card__logo[_ngcontent-%COMP%]{width:30vw;height:20vh}.home-container__form__card__button[_ngcontent-%COMP%], .home-container__form__card__input[_ngcontent-%COMP%], .home-container__form__card__title[_ngcontent-%COMP%]{font-family:"Gloria Hallelujah",cursive}.home-container__form__card__title[_ngcontent-%COMP%]{font-size:24px}.home-container__generated__card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;padding:30px;margin:30px}.home-container__generated__card__text[_ngcontent-%COMP%]{text-align:center}']],data:{}});function Zb(t){return fs(0,[(t()(),Xo(0,0,null,null,3,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),ci(1,16384,null,0,bm,[],null,null),(t()(),Xo(2,0,null,null,1,"h1",[["class","home-container__generated__card__text"]],null,null,null,null,null)),(t()(),cs(-1,null,[" Su papel ya ha sido asignado "]))],null,null)}function Xb(t){return fs(0,[(t()(),Xo(0,0,null,null,3,"mat-card",[["class","home-container__generated__card mat-card"]],[[2,"_mat-animation-noopable",null]],null,null,bv,_v)),ci(1,49152,null,0,Sm,[[2,yv]],null,null),(t()(),Zo(16777216,null,0,1,null,Zb)),ci(3,16384,null,0,Ma,[Vn,Ln],{ngIf:[0,"ngIf"]},null)],function(t,e){t(e,3,0,e.component.alreadyGenerated)},function(t,e){t(e,0,0,"NoopAnimations"===Zr(e,1)._animationMode)})}function Jb(t){return fs(0,[(t()(),Xo(0,0,null,null,3,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),ci(1,16384,null,0,bm,[],null,null),(t()(),Xo(2,0,null,null,1,"h1",[],null,null,null,null,null)),(t()(),cs(3,null,[" ",""]))],null,function(t,e){t(e,3,0,e.component.paperName)})}function tw(t){return fs(0,[(t()(),Xo(0,0,null,null,13,"mat-card",[["class","home-container__form__card mat-card"]],[[2,"_mat-animation-noopable",null]],null,null,bv,_v)),ci(1,49152,null,0,Sm,[[2,yv]],null,null),(t()(),Xo(2,0,null,0,4,"mat-card-header",[["class","mat-card-header"]],null,null,null,Ev,wv)),ci(3,49152,null,0,Cm,[],null,null),(t()(),Xo(4,0,null,1,2,"mat-card-title",[["class","home-container__form__card__title mat-card-title"]],null,null,null,null,null)),ci(5,16384,null,0,wm,[],null,null),(t()(),cs(-1,null,["Sortear Nombre"])),(t()(),Zo(16777216,null,0,1,null,Jb)),ci(8,16384,null,0,Ma,[Vn,Ln],{ngIf:[0,"ngIf"]},null),(t()(),Xo(9,0,null,0,4,"mat-card-actions",[["class","mat-card-actions"]],[[2,"mat-card-actions-align-end",null]],null,null,null,null)),ci(10,16384,null,0,Em,[],null,null),(t()(),Xo(11,0,null,null,2,"button",[["class","home-container__form__card__button"],["color","warn"],["mat-raised-button",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==t.component.updatePaper()&&r),r},a_,s_)),ci(12,180224,null,0,i_,[dn,Mf,[2,yv]],{disabled:[0,"disabled"],color:[1,"color"]},null),(t()(),cs(-1,0,["Sacar Papel"]))],function(t,e){var n=e.component;t(e,8,0,n.generatedPaper),t(e,12,0,n.generatedPaper,"warn")},function(t,e){t(e,0,0,"NoopAnimations"===Zr(e,1)._animationMode),t(e,9,0,"end"===Zr(e,10).align),t(e,11,0,Zr(e,12).disabled||null,"NoopAnimations"===Zr(e,12)._animationMode)})}function ew(t){return fs(0,[(t()(),Xo(0,0,null,null,5,"div",[["class","home-container"]],null,null,null,null,null)),(t()(),Xo(1,0,null,null,4,"div",[["class","home-container__form"]],null,null,null,null,null)),(t()(),Zo(16777216,null,null,1,null,Xb)),ci(3,16384,null,0,Ma,[Vn,Ln],{ngIf:[0,"ngIf"]},null),(t()(),Zo(16777216,null,null,1,null,tw)),ci(5,16384,null,0,Ma,[Vn,Ln],{ngIf:[0,"ngIf"]},null)],function(t,e){var n=e.component;t(e,3,0,n.alreadyGenerated&&!n.generatedPaper),t(e,5,0,!n.alreadyGenerated||n.generatedPaper)},null)}function nw(t){return fs(0,[(t()(),Xo(0,0,null,null,1,"app-home",[],null,null,null,ew,Yb)),ci(1,114688,null,0,Kb,[dh,$b,F_,Sd],null,null)],function(t,e){t(e,1,0)},null)}var rw=Ur("app-home",Kb,nw,{},{},[]),iw=nr({encapsulation:2,styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}@media (-ms-high-contrast:active){.mat-snack-bar-container{border:solid 1px}}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}"],data:{animation:[{type:7,name:"state",definitions:[{type:0,name:"void, hidden",styles:{type:6,styles:{transform:"scale(0.8)",opacity:0},offset:null},options:void 0},{type:0,name:"visible",styles:{type:6,styles:{transform:"scale(1)",opacity:1},offset:null},options:void 0},{type:1,expr:"* => visible",animation:{type:4,styles:null,timings:"150ms cubic-bezier(0, 0, 0.2, 1)"},options:null},{type:1,expr:"* => void, * => hidden",animation:{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"75ms cubic-bezier(0.4, 0.0, 1, 1)"},options:null}],options:{}}]}});function ow(t){return fs(0,[(t()(),Zo(0,null,null,0))],null,null)}function sw(t){return fs(0,[rs(402653184,1,{_portalOutlet:0}),(t()(),Zo(16777216,null,null,1,null,ow)),ci(2,212992,[[1,4]],0,Q_,[ln,Vn],{portal:[0,"portal"]},null)],function(t,e){t(e,2,0,"")},null)}function aw(t){return fs(0,[(t()(),Xo(0,0,null,null,1,"snack-bar-container",[["class","mat-snack-bar-container"]],[[1,"role",0],[40,"@state",0]],[["component","@state.done"]],function(t,e,n){var r=!0;return"component:@state.done"===e&&(r=!1!==Zr(t,1).onAnimationEnd(n)&&r),r},sw,iw)),ci(1,180224,null,0,Bb,[uo,dn,Re,Fb],null,null)],null,function(t,e){t(e,0,0,Zr(e,1)._role,Zr(e,1)._animationState)})}var lw=Ur("snack-bar-container",Bb,aw,{},{},[]),uw=nr({encapsulation:2,styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;height:100%;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}"],data:{}});function cw(t){return fs(0,[(t()(),Xo(0,0,null,null,3,"div",[["class","mat-simple-snackbar-action"]],null,null,null,null,null)),(t()(),Xo(1,0,null,null,2,"button",[["mat-button",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==t.component.action()&&r),r},a_,s_)),ci(2,180224,null,0,i_,[dn,Mf,[2,yv]],null,null),(t()(),cs(3,0,["",""]))],null,function(t,e){var n=e.component;t(e,1,0,Zr(e,2).disabled||null,"NoopAnimations"===Zr(e,2)._animationMode),t(e,3,0,n.data.action)})}function hw(t){return fs(2,[(t()(),Xo(0,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),cs(1,null,["",""])),(t()(),Zo(16777216,null,null,1,null,cw)),ci(3,16384,null,0,Ma,[Vn,Ln],{ngIf:[0,"ngIf"]},null)],function(t,e){t(e,3,0,e.component.hasAction)},function(t,e){t(e,1,0,e.component.data.message)})}function dw(t){return fs(0,[(t()(),Xo(0,0,null,null,1,"simple-snack-bar",[["class","mat-simple-snackbar"]],null,null,null,hw,uw)),ci(1,49152,null,0,Vb,[Mb,Lb],null,null)],null,null)}var fw=Ur("simple-snack-bar",Vb,dw,{},{},[]),pw=nr({encapsulation:0,styles:[[""]],data:{}});function mw(t){return fs(0,[(t()(),Xo(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),ci(1,212992,null,0,Id,[Td,Vn,ln,[8,null],Re],null,null)],function(t,e){t(e,1,0)},null)}function gw(t){return fs(0,[(t()(),Xo(0,0,null,null,1,"app-root",[],null,null,null,mw,pw)),ci(1,49152,null,0,wa,[],null,null)],null,null)}var yw,vw=Ur("app-root",wa,gw,{},{},[]);n("6Joi");let _w=yw=class{static enablePersistence(t){return{ngModule:yw,providers:[{provide:D_,useValue:!0},{provide:N_,useValue:t}]}}};class bw{}var ww=va(ba,[wa],function(t){return function(t){const e={},n=[];let r=!1;for(let i=0;i<t.length;i++){const o=t[i];o.token===Pe&&!0===o.value&&(r=!0),1073741824&o.flags&&n.push(o.token),o.index=i,e[Jn(o.token)]=o}return{factory:null,providersByKey:e,providers:t,modules:n,isRoot:r}}([Or(512,ln,un,[[8,[Zd,Gb,rw,lw,fw,vw]],[3,ln],zt]),Or(5120,Wi,Ko,[[3,Wi]]),Or(4608,Oa,Pa,[Wi,[2,Ra]]),Or(5120,Ii,$o,[uo]),Or(5120,Bi,Ui,[]),Or(5120,Nn,Wo,[]),Or(5120,Rn,Go,[]),Or(4608,Gu,Ku,[ja]),Or(6144,xe,null,[Gu]),Or(4608,Uu,ju,[]),Or(5120,lu,function(t,e,n,r,i,o,s,a){return[new Vu(t,e,n),new Wu(r),new zu(i,o,s,a)]},[ja,uo,zi,ja,ja,Uu,Hi,[2,qu]]),Or(4608,uu,uu,[lu,uo]),Or(135680,du,du,[ja]),Or(4608,_u,_u,[uu,du,Bi]),Or(5120,$m,pv,[]),Or(5120,Yg,mv,[]),Or(4608,Ry,fv,[ja,$m,Yg]),Or(5120,mn,gv,[_u,Ry,uo]),Or(6144,hu,null,[du]),Or(4608,yo,yo,[uo]),Or(5120,dh,zd,[Sd]),Or(4608,Dd,Dd,[]),Or(6144,Ad,null,[Dd]),Or(135680,Nd,Nd,[Sd,Ro,Ji,Le,Ad]),Or(4608,kd,kd,[]),Or(5120,Rd,Vd,[Sd,Wa,Od]),Or(5120,Gd,Wd,[Qd]),Or(5120,Qi,function(t){return[t]},[Gd]),Or(4608,Xd,iv,[mn,ja]),Or(4608,Sv,Sv,[]),Or(4608,Qf,Qf,[]),Or(5120,x_,A_,[T_,[2,I_]]),Or(4608,L_,L_,[T_,[2,I_],[2,D_],[2,R_],zi,uo,[2,N_]]),Or(4608,vm,vm,[]),Or(4608,Lp,Lp,[]),Or(4608,Eb,Eb,[ob,db,ln,bb,hb,Le,uo,ja,xm,[2,Ia]]),Or(5120,Sb,Cb,[Eb]),Or(1073742336,qa,qa,[]),Or(1024,ee,nc,[]),Or(1024,To,function(){return[Ld()]},[]),Or(512,Qd,Qd,[Le]),Or(1024,Fi,function(t,e){return[(n=t,ou("probe",au),ou("coreTokens",Object.assign({},su,(n||[]).reduce((t,e)=>(t[e.name]=e.token,t),{}))),()=>au),Hd(e)];var n},[[2,To],Qd]),Or(512,Vi,Vi,[[2,Fi]]),Or(131584,Do,Do,[uo,Hi,Le,ee,ln,Vi]),Or(1073742336,Yo,Yo,[Do]),Or(1073742336,rc,rc,[[3,rc]]),Or(1024,Pd,Ud,[[3,Sd]]),Or(512,Qc,Hc,[]),Or(512,Td,Td,[]),Or(256,Od,{},[]),Or(1024,Ca,Bd,[Ea,[2,Ta],Od]),Or(512,Ia,Ia,[Ca,Ea]),Or(512,Ji,Ji,[]),Or(512,Ro,Fo,[Ji,[2,Mo]]),Or(1024,gd,function(){return[[{path:"auth",component:l_},{path:"lovenfriendship/:member",component:Kb},{path:"",redirectTo:"/auth",pathMatch:"full"},{path:"**",component:l_}]]},[]),Or(1024,Sd,jd,[Do,Qc,Td,Ia,Le,Ro,Ji,gd,Od,[2,vd],[2,pd]]),Or(1073742336,Fd,Fd,[[2,Pd],[2,Sd]]),Or(1073742336,bw,bw,[]),Or(1073742336,vv,vv,[]),Or(1073742336,gf,gf,[]),Or(1073742336,Gv,Gv,[]),Or(1073742336,Iv,Iv,[]),Or(1073742336,gp,gp,[]),Or(1073742336,Jv,Jv,[]),Or(1073742336,Am,Am,[]),Or(1073742336,Vf,Vf,[[2,Ff],[2,qu]]),Or(1073742336,Tm,Tm,[]),Or(1073742336,Jf,Jf,[]),Or(1073742336,o_,o_,[]),Or(1073742336,k_,k_,[]),Or(1073742336,_w,_w,[]),Or(1073742336,ym,ym,[]),Or(1073742336,_m,_m,[]),Or(1073742336,H_,H_,[]),Or(1073742336,$_,$_,[]),Or(1073742336,Tb,Tb,[]),Or(1073742336,Ub,Ub,[]),Or(1073742336,ba,ba,[]),Or(256,Pe,!0,[]),Or(256,yv,"BrowserAnimations",[]),Or(256,T_,{apiKey:"AIzaSyCwE_mWKIXrgeVXwyoSVjBNRmzj_v5EY3c",authDomain:"lovenfriendship-88ca5.firebaseapp.com",databaseURL:"https://lovenfriendship-88ca5.firebaseio.com",projectId:"lovenfriendship-88ca5",storageBucket:"",messagingSenderId:"775679582144",appId:"1:775679582144:web:f6877697fe1a713a35f225"},[]),Or(256,I_,void 0,[])])});(function(){if(re)throw new Error("Cannot enable prod mode after platform setup.");ne=!1})(),ec().bootstrapModuleFactory(ww).catch(t=>console.error(t))},zVF4:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mrSG"),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw s(e)},s=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},a=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},l={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,c=(15&a)<<2|u>>6,h=63&u;l||(h=64,s||(c=64)),r.push(n[o>>2],n[(3&o)<<4|a>>4],n[c],n[h])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(a(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,l=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==l)throw Error();r.push(o<<2|s>>4),64!==a&&(r.push(s<<4&240|a>>2),64!==l&&r.push(a<<6&192|l))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},u=function(t){try{return l.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function c(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=c(t[n],e[n]));return t}var h=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}();function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var f="FirebaseError",p=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=f,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,m.prototype.create),i}return r.__extends(e,t),e}(Error),m=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?g(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",l=new p(i,a),u=0,c=Object.keys(r);u<c.length;u++){var h=c[u];"_"!==h.slice(-1)&&(h in l&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),l[h]=r[h])}return l},t}();function g(t,e){return t.replace(y,function(t,n){var r=e[n];return null!=r?r.toString():"<"+n+"?>"})}var y=/\{\$([^}]+)}/g;function v(t){return JSON.parse(t)}var _=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=v(u(o[0])||""),n=v(u(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(s){}return{header:e,claims:n,data:r,signature:i}},b=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++)n[r]=4294967295&((h=n[r-3]^n[r-8]^n[r-14]^n[r-16])<<1|h>>>31);var i,o,s=this.chain_[0],a=this.chain_[1],l=this.chain_[2],u=this.chain_[3],c=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(i=u^a&(l^u),o=1518500249):(i=a^l^u,o=1859775393):r<60?(i=a&l|u&(a|l),o=2400959708):(i=a^l^u,o=3395469782);var h=(s<<5|s>>>27)+i+c+o+n[r]&4294967295;c=u,u=l,l=4294967295&(a<<30|a>>>2),a=s,s=h}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+l&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}(),w=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=E),void 0===r.error&&(r.error=E),void 0===r.complete&&(r.complete=E);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();function E(){}function S(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+r+" argument "}e.CONSTANTS=i,e.Deferred=h,e.ErrorFactory=m,e.FirebaseError=p,e.Sha1=b,e.assert=o,e.assertionError=s,e.async=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){t.apply(void 0,n)}).catch(function(t){e&&e(t)})}},e.base64=l,e.base64Decode=u,e.base64Encode=function(t){var e=a(t);return l.encodeByteArray(e,!0)},e.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.createSubscribe=function(t,e){var n=new w(t,e);return n.subscribe.bind(n)},e.decode=_,e.deepCopy=function(t){return c(void 0,t)},e.deepExtend=c,e.errorPrefix=S,e.getUA=d,e.isAdmin=function(t){var e=_(t).claims;return"object"==typeof e&&!0===e.admin},e.isBrowser=function(){return"object"==typeof self&&self.self===self},e.isEmpty=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},e.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())},e.isNode=function(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}},e.isNodeSdk=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},e.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},e.isValidFormat=function(t){var e=_(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},e.isValidTimestamp=function(t){var e=_(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},e.issuedAtTime=function(t){var e=_(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},e.jsonEval=v,e.map=function(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r},e.querystring=function(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""},e.querystringDecode=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach(function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}}),e},e.safeGet=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},e.stringToByteArray=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var s=i-55296;o(++r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(s<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},e.stringify=function(t){return JSON.stringify(t)},e.validateArgCount=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},e.validateCallback=function(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(S(t,e,r)+"must be a valid function.")},e.validateContextObject=function(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(S(t,e,r)+"must be a valid context object.")},e.validateNamespace=function(t,e,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(S(t,e,r)+"must be a valid firebase namespace.")}},zn8P:function(t,e){function n(t){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="zn8P"}},[[0,0]]]);